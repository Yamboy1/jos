<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 FINAL//EN">
<HTML>
  <HEAD>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
    <TITLE>JosKernel.Imported @ jos.sf.net</TITLE>
  </HEAD>

<BODY BGCOLOR="#FFFFFF">

<!-- The FORM encloses the entire header, because it renders better that way. !-->
<FORM ACTION="/jump.php"><input type="hidden" name="PHPSESSID" value="a4e56bbbcb0f7abc6fe85cde8eb6f67b" />

<!-- The JOS logo. !-->
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR VALIGN="TOP" ALIGN="LEFT">
	<TD><A HREF="http://cjos.sourceforge.net/archive/"><IMG 
		VSPACE="0" HSPACE="0" ALIGN="MIDDLE" BORDER="0"
		SRC="image/wikiHome.gif"></A></TD>
	<!-- The tab table. !-->
	<TD WIDTH="100%" ALIGN="RIGHT" BGCOLOR="#FFFFFF" VALIGN="BOTTOM"> 
		<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%" ALIGN="RIGHT">
			<TR VALIGN="MIDDLE" ALIGN="LEFT">

<TD BGCOLOR="White" WIDTH="60%">&nbsp;</TD>
<TD BGCOLOR="#FFFFCC"><A HREF="http://cjos.sourceforge.net/archive/">Home</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/info/">Info</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/dev/">DevZone</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFCC66" ALIGN="CENTER"><A
HREF="http://jos.sourceforge.net/">Wiki</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
			</TR>
			<TR>
				<TD BGCOLOR="#FFCC66" ALIGN="RIGHT" COLSPAN="9">
					<A HREF="UsersWebHome.html">UsersWeb</A>
					&nbsp;|&nbsp;
					<A HREF="MainWebHome.html">MainWeb</A>
					&nbsp;|&nbsp;
					<A HREF="InfoWebHome.html">InfoWeb</A>
					&nbsp;|&nbsp;
					<A HREF="DevZoneWebHome.html">DevZoneWeb</A>
					&nbsp;|&nbsp;
					<A HREF="SupportWebHome.html">SupportWeb</A>
				</TD>
			</TR>
		</TABLE>
	</TD>		
</TR>
<!-- The WikiHeader. !-->
<TR><TD COLSPAN="2">
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="CENTER">
		<B>[&nbsp;<! page="">JosKernel</a>&nbsp;]</B>
	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="CENTER">
		<B>[ not logged in ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="CENTER">
		<B>[ Web: <a href="ImportedWebHome.html">Imported</a> ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFCC66" VALIGN="CENTER">
		goto:&nbsp;<INPUT TYPE="TEXT" SIZE="10" NAME="topic"><!--<INPUT TYPE="IMAGE" SRC="/media/go.gif?PHPSESSID=a4e56bbbcb0f7abc6fe85cde8eb6f67b" BORDER="0" VALUE="topic" ALT="goto">!-->&nbsp;<! page=""><FONT SIZE="-1">options</FONT></a>
	</TD>
</TR>
</TABLE>

<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
	<TR>
	<TD ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="TOP">
		[&nbsp;get <! page="">info</a> on or <a href="WebHome.html">edit</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="TOP">
		[&nbsp;<! page="">login</a> or <! page="">new&nbsp;user</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="TOP">
		[&nbsp;list of <a href="Glossary.html">topics</a>, <! page="">hubs&nbsp;&amp;&nbsp;nodes</a>, or <a href="NewArticles2a.html">recent&nbsp;changes</a>&nbsp;]	</TD>
	</TR>
</TABLE>

<!-- From CommonHeader !-->
</TR></TD>
</TABLE>
</FORM>

<!-- start BODY page !-->
<P>
<FONT SIZE="-1"><! page="">ArchitectureDiagram</a></FONT>
<HR SIZE="1" NOSHADOW>
<P><EM>Article contributed by <a href="GilbertHerschberger.html">GilbertHerschberger</a> (3 April 2000).</EM></P>
<H4>Introduction</H4>
<P>The general architecture of a Java-based operating system requires machine code. What should be implemented in machine code? How much of an operating system should be written in C/C++? This article provides a introduction to these issues.</P>
<H4>Diagram 1</H4>
<P>This diagram illustrates the standard libraries for a traditional operating system. Native interface and bytecode are optional.</P>
<TABLE BORDER="1" CELLPADDING="4" BGCOLOR="lightblue">
<TR>
<TD>
<FONT FACE="Arial" SIZE="+1">Machine Code</FONT>
<TABLE BORDER="1" BGCOLOR="khaki">
<TR>
<TD>
<FONT FACE="Arial">Standard machine code library</FONT>
</TD>
</TR>
</TABLE>
</TD>
</TR>
</TABLE>
<H4>Diagram 2</H4>
<P>This diagram illustrates the necessary standard libraries for any Java-based operating system. Unlike a traditional operating system, this operating system always includes a native interface and bytecode layer.</P>
<TABLE BORDER="1" CELLPADDING="4" BGCOLOR="lightblue">
<TR>
<TD>
<FONT FACE="Arial" SIZE="+1">Machine Code</FONT>
<TABLE BORDER="1" BGCOLOR="khaki">
<TR>
<TD>
<FONT FACE="Arial">Standard machine code library</FONT>
</TD>
</TR>
</TABLE>
</TD>
</TR>
<TR>
<TD>
<FONT FACE="Arial" SIZE="+1">Native Interface</FONT>
<TABLE BORDER="1" BGCOLOR="khaki">
<TR>
<TD>
<FONT FACE="Arial">Standard native interface library</FONT>
</TD>
</TR>
</TABLE>
</TD>
</TR>
<TR>
<TD>
<FONT FACE="Arial" SIZE="+1">Bytecode</FONT>
<TABLE BORDER="1" BGCOLOR="khaki">
<TR>
<TD>
<FONT FACE="Arial">Standard bytecode library</FONT>
</TD>
</TR>
</TABLE>
</TD>
</TR>
</TABLE>
<H4>Standard libraries</H4>
<P>The machine code and bytecode layers of the general architecture require their own standard libraries. A "standard" library contains functions available to all programs. The library is standardized for a number of very good reasons.</P>
<UL>
<LI><P><STRONG>A programming language depends on perfect compatibility for translators that implement the language.</STRONG></P>
<P>A programming language is independent of the processor that translated it. A programming language might require a standard library. It is also called "run-time support" libraries.</P>
<P>A language like C has adopted a style of standard language interface. This provides source-level compatibility between hardware platforms. Different implementations of the standard library have exactly the same interface. A program compiled on one operating system can be compiled on another.</P>
<LI><P><STRONG>All programs depend on perfect backward compatibility from each standard library.</STRONG></P>
<P>Perfect compatibility is required for porting from one operating system to another. When a new version of the operating system is released, programs developed on the old version continue to work properly. When a version of the operating system is ported from one processor to another, programs developed on one processor continue to work properly on another. The standard library is often associated with the operating system. An operating system might have a standard library.</P>
<LI><P><STRONG>Standard libraries encourage optimization and competition.</STRONG></P>
<P>A standard library can be optimized for a custom platform. Functions required by the standard can be written with a custom platform in mind.</P>
<P>A standard library encourages competition. Different programmers can attempt to build the smallest, fastest, or most robust version. Competition provices an opportunity to give customers what they want.</P>
</UL>
<P>A Java-based operating system has two kinds of standard libraries: machine code and bytecode. C programmers have come to expect a standard machine code library. Java programmers have come to expect a standard machine code and bytecode library.</P>
<H4>Standard machine code library</H4>
<P>The standard machine code library contains all of the "standard" functions available to all machine code programs. It is also known as the "standard C library" and "standard class library". In addition, there is a "standard template library" for C++ templates.</P>
<P>When optimized, a standard machine code library for JOS is incompatible. It cannot be used on Linux, Windows or any other operating system.</P>
<P>The standard machine code library can be written carefully in C/C++. A function can depend on other functions within the standard machine code library. Functions cannot depend on the standard C library or standard C++ class library.</P>
<H4>Standard native interface library</H4>
<P>The standard native interface library contains all of the functions, structures and classes to translate between bytecode and machine code. Like the <! page="">JavaNativeInterface</a>, additional functions are requires to copy an object in bytecode to a corresponding object in machine code. This library provides methods for interpreting the primative types.</P>
<P>Any kernel module can define a class in bytecode, invoke a static method, create an object in bytecode and invoke a virtual method. Likewise, any bytecode object can invoke "native" methods that are bound to machine code. The native interface is implemented for each hardware platform in a standard native interface library.</P>
<P>This library can be written in C/C++. These functions can depend on other functions within the standard native interface library or standard machine code library.</P>
<H4>Standard bytecode library</H4>
<P>The standard bytecode library contains all of the classes available to all bytecode programs. It is also called the "standard class libraries", or the <CODE>java</CODE> packages.</P>
<P>Unlike a machine code library, a bytecode library can be compatible. Even when optimized, a standard bytecode library for JOS might be used on another bytecode processor.</P>
<UL>
<LI><P><STRONG><CODE>java.lang.Runtime</CODE></STRONG></P>
<P>For example, <CODE>Runtime.getRuntime()</CODE> always returns an instance of a custom class that extends <CODE>java.lang.Runtime</CODE>.</P>
<PRE>
  public void example() {
	 Runtime r = Runtime.getRuntime();
	 String cn = r.getClass().getName();
	 println( "Runtime Class: " + cn );
  }
  public void println( String v ) {
	 System.out.println( v );
  }
</PRE>
<P>For example, the <CODE>decaf.VMRuntime</CODE> class might extend <CODE>java.lang.Runtime</CODE>. <CODE>decaf.VMRuntime.getRuntime()</CODE> might return an instance of <CODE>decaf.VMRuntime()</CODE>. On JOS, <CODE>Runtime.getRuntime()</CODE> might return an instance of <CODE>decaf.VMRuntime</CODE>.</P>
<P>On a foreign virtual machine, <CODE>Runtime.getRuntime()</CODE> would not return an instance of <CODE>decaf.VMRuntime</CODE> but an instance of some other class.</P>
</UL>
<H4>Functions</H4>
<P>Here is a diagram of the kernel interface, from the bottom up:</P>
<TABLE WIDTH="100%" CELLPADDING="4" BORDER="1">
<TR>
<TD>
<P><STRONG>kernel</STRONG></P>
<P>The kernel is written in machine code. It is loaded before any other kernel module.</P>
</TD>
</TR>
<TR>
<TD>
<P><STRONG>kernel interface</STRONG></P>
<P>Some of the kernel is exposed through a kernel interface. A kernel exposes useful functions through an interface. It provide an interface between the kernel and standard machine code libraries.</P>
</TD>
</TR>
<TR>
<TD>
<P><STRONG>machine code library</STRONG></P>
<P>The standard machine code library provide high-level functions for all kernel modules. A standard C library could be written here.</P>
</TD>
</TR>
<TR>
<TD>
<P><STRONG>kernel module</STRONG></P>
<P>A kernel module provides high-level functions for all bytecode. A virtual machine could be written at this layer.</P>
</TD>
</TR>
</TABLE>
<H4>Multiple kernels</H4>
<P>There are multiple kernels because there are multiple hardware platforms. A kernel must be ported to different hardware platforms. This means that there must be more than one version of the kernel. With a standard kernel interface, kernels from different hardware platforms can provide similar functionality to a platform-independent virtual machine.</P><BR><BR></P><!--

<TABLE width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="737b9c">
<TR><TD ALIGN="CENTER">
<! page="">login</a> or <! page="">new&nbsp;user</a><TR><TD>
</TABLE>

!-->
<!-- end BODY page !-->

<HR>

<DIV ALIGN="CENTER">
<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR>
	<TD ALIGN="CENTER" COLSPAN="2">
		Content of these pages are owned and copyrighted by the poster.
	</TD>
</TR>
<TR>
	<TD ALIGN="RIGHT" WIDTH="50%">
		Hosted by:
	</TD>
	<TD ALIGN="LEFT">
		<A HREF="http://sourceforge.net/"><IMG 
			SRC="http://sourceforge.net/sflogo.php?group_id=2376&type=1"
			BORDER=0 HSPACE=0 VSPACE=0></A>
	</TD>
</TR>
</TABLE>
</DIV>
</BODY>
</HTML>

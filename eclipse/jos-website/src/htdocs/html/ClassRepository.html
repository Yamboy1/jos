<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 FINAL//EN">
<HTML>
  <HEAD>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
    <TITLE>ClassRepository.Imported @ jos.sf.net</TITLE>
  </HEAD>

<BODY BGCOLOR="#FFFFFF">

<!-- The FORM encloses the entire header, because it renders better that way. !-->
<FORM ACTION="/jump.php"><input type="hidden" name="PHPSESSID" value="c470b9bc87e5c6da5fb7cfbef14d5976" />

<!-- The JOS logo. !-->
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR VALIGN="TOP" ALIGN="LEFT">
	<TD><A HREF="http://cjos.sourceforge.net/archive/"><IMG 
		VSPACE="0" HSPACE="0" ALIGN="MIDDLE" BORDER="0"
		SRC="image/wikiHome.gif"></A></TD>
	<!-- The tab table. !-->
	<TD WIDTH="100%" ALIGN="RIGHT" BGCOLOR="#FFFFFF" VALIGN="BOTTOM"> 
		<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%" ALIGN="RIGHT">
			<TR VALIGN="MIDDLE" ALIGN="LEFT">

<TD BGCOLOR="White" WIDTH="60%">&nbsp;</TD>
<TD BGCOLOR="#FFFFCC"><A HREF="http://cjos.sourceforge.net/archive/">Home</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/info/">Info</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/dev/">DevZone</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFCC66" ALIGN="CENTER"><A
HREF="http://jos.sourceforge.net/">Wiki</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
			</TR>
			<TR>
				<TD BGCOLOR="#FFCC66" ALIGN="RIGHT" COLSPAN="9">
					<A HREF="UsersWebHome.html">UsersWeb</A>
					&nbsp;|&nbsp;
					<A HREF="MainWebHome.html">MainWeb</A>
					&nbsp;|&nbsp;
					<A HREF="InfoWebHome.html">InfoWeb</A>
					&nbsp;|&nbsp;
					<A HREF="DevZoneWebHome.html">DevZoneWeb</A>
					&nbsp;|&nbsp;
					<A HREF="SupportWebHome.html">SupportWeb</A>
				</TD>
			</TR>
		</TABLE>
	</TD>		
</TR>
<!-- The WikiHeader. !-->
<TR><TD COLSPAN="2">
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="CENTER">
		<B>[&nbsp;<! page="">ClassRepository</a>&nbsp;]</B>
	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="CENTER">
		<B>[ not logged in ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="CENTER">
		<B>[ Web: <a href="ImportedWebHome.html">Imported</a> ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFCC66" VALIGN="CENTER">
		goto:&nbsp;<INPUT TYPE="TEXT" SIZE="10" NAME="topic"><!--<INPUT TYPE="IMAGE" SRC="/media/go.gif?PHPSESSID=c470b9bc87e5c6da5fb7cfbef14d5976" BORDER="0" VALUE="topic" ALT="goto">!-->&nbsp;<! page=""><FONT SIZE="-1">options</FONT></a>
	</TD>
</TR>
</TABLE>

<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
	<TR>
	<TD ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="TOP">
		[&nbsp;get <! page="">info</a> on or <a href="WebHome.html">edit</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="TOP">
		[&nbsp;<! page="">login</a> or <! page="">new&nbsp;user</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="TOP">
		[&nbsp;list of <a href="Glossary.html">topics</a>, <! page="">hubs&nbsp;&amp;&nbsp;nodes</a>, or <a href="NewArticles2a.html">recent&nbsp;changes</a>&nbsp;]	</TD>
	</TR>
</TABLE>

<!-- From CommonHeader !-->
</TR></TD>
</TABLE>
</FORM>

<!-- start BODY page !-->
<P>
<a href="KernelGroup.html">KernelGroup</a> working document.  Edit as you see fit.
<HR>
</P><P>
I have decided to take up the task of doing the Analyses &amp; Design work on the <a href="ClassRepository.html">ClassRepository</a>, since no one else has.  Put simply:  it has to be done before <! page="">JOS</a> will exist.  My beginning point will be the work that has already been done on the requirements in the mailing lists and here, instead of redoing that work as is our custom in this project.  :)
</P><P>
I am not committing yet to the coding, but I will decide on that after these first tasks are complete.  I plan to use <a href="TogetherJ.html">TogetherJ</a>, a 100% Pure Java <! page="">OOAD</a> tool.  If you have further thoughts on the requirements for this piece of <! page="">JOS</a> or want to note required interactions with other parts of JOS, please note them here.
</P><P>
-- <a href="AveryRegier.html">AveryRegier</a>
</P><P>
<HR>
</P><P>
<UL> <LI> <a href="ClassRepository.html">ClassRepository</a> is the only home for class definitions,	  including the bytecode representation (if the class is not interpreted).
<UL> <LI> ??? - The bytecode is interpretted.  Perhaps you mean the JITted code?  - <a href="AveryRegier.html">AveryRegier</a>
</UL> <LI> <a href="ClassRepository.html">ClassRepository</a> will support the <a href="http://java.sun.com/products/jdk/1.2/docs/guide/versioning/index.html">JDK 1.2</a> <a href="Versioning.html">Versioning</a> specification.
<LI> (Package,Version) combination will uniquely identify a particular version of a package.  This combination will be the primary entity in the repository.  Perhaps source might be a third element in this unique package identifier?  Comments?
<UL> <LI> In the <! page="">JDK</a> 1.2 Versioning specification there are two separate versions:  An <a href="API.html">API</a> version number and an implementation version number.  We need to somehow take account of this when uniquely identifying versions of a package. - <a href="AveryRegier.html">AveryRegier</a>
</UL> <LI> The <a href="ClassRepository.html">ClassRepository</a> will be shared by every process and <! page="">ClassLoader</a> in the operating system.
<UL> <LI> Thus the <a href="ClassRepository.html">ClassRepository</a> is a singleton.  Instead of using a Constructor, we should have a <a href="ClassRepository.html">ClassRepository</a>.getClassRepository() static method.  - Avery Regier
</UL> <LI> Since classes are not versioned or managed independently, the classes will belong to a (Package,Version) combination.
<LI> <a href="ClassRepository.html">ClassRepository</a> will have an <a href="API.html">API</a> that can be accessed by a <a href="CLI.html">CLI</a> or <! page="">GUI</a> admin tool.
<LI> Permissions to add/remove/update classes will be created and handled by the security manager.
<LI> <! page="">ClassLoaders</a> will be written to use the <a href="ClassRepository.html">ClassRepository</a> API, therefore security will be handled at the <a href="ClassRepository.html">ClassRepository</a> level.
<LI> <a href="ClassRepository.html">ClassRepository</a> might also hold any optimizations necessary		for proper VM/JIT functioning.
<LI> <a href="ClassRepository.html">ClassRepository</a> can hold bytecodes, sourcecode or both. If sourcecode is provided, then a Compiler or Interpreter object will be required.  This allows scripting programs to be held by the respository as well.  It also allows for other languages to be formally supported.
<LI> When a Class is updated to a new version, a <! page="">ClassMigrator</a> class may also be installed, which will be used (when available) to automatically migrate classes from one version to another. If no <! page="">ClassMigrator</a> is available, then new class versions may only add fields (and converted objects will have these fields initilized to null).  Perhaps optionally, we can make an ovverride for "dropping" fields.  This is a bigger problem, called <! page="">SchemaMigration</a> that needs to be addressed, perhaps seperately.
<LI> <a href="ClassRepository.html">ClassRepository</a> might have replication features for distributed environments to help support Zero workstation adminstration goals.
<LI> <a href="ClassRepository.html">ClassRepository</a> can be updated dynamically by processes with the appropriate permissions.  Perhaps <! page="">ClassMigrations</a> might also be done dynamically... hmmm...
<LI> When a class is stored, additional information needed by the system will be attached.  This information will be configurable through the API.
<UL> <LI> We can do this by serializing a subclass of java.lang.Class which contains this information.  - <a href="AveryRegier.html">AveryRegier</a>
</UL> <LI> The <a href="ClassRepository.html">ClassRepository</a> will be a persistent object. 
<LI> Every once and a while, "unreferenced" classes can be moved out of the <a href="ClassRepository.html">ClassRepository</a> based on some kind of usage / need free space / number of references based on reachability.
</UL> <HR>
I think this is a great start. Sometimes I sink to implementation details. Bear with me &amp; edit them out if they really bug you 8^)
<UL> <LI> <b>The unique identifier for a class in the repository is (Package, Class,Version).</b> I'm not sure this will work. Nothing guarantees Package and Class are unique and I'm not sure how we'd know what version something is. We may need UUIDs here, after all. 
<LI> <b>When a class is stored, additional information needed by the system will be attached.  This information will be configurable through the API.</b> <a href="ClassRepository.html">ClassRepository</a> treats each class as a <a href="MetaObject.html">MetaObject</a>. This could be done by defining a <null>MetaObjectable</null> interface that wrappers serializable for each Class. We'd need to provide one for Object if we want to save non-jos classes.
<LI> <b>The <a href="ClassRepository.html">ClassRepository</a> will be a persistent object.</b>	* The <a href="ClassRepository.html">ClassRepository</a>'s <a href="API.html">API</a> should be the same <a href="API.html">API</a> as the rest of the OOFS. Either the <null>MetaObjectable</null> interface or the <! page="">OOFS</a> API would be the place to define the distributed replication API. 
<LI> <b>Every once and a while, "unreferenced" classes can be moved out of the <a href="ClassRepository.html">ClassRepository</a> based on some kind of usage / need free space / number of references based on reachability.</b> This seems like a bad idea to me. If we bothered to load them, why would we unload them? Who would determine which classes to remove? -- <a href="BillRehm.html">BillRehm</a>
<LI> When loading packages, <a href="ClassRepository.html">ClassRepository</a> should be able to strip static main() code iff it is allowed by package information, e.g. "Strip-Main-At-Installation: yes", or beans in general.  This came up on the apps mailing list. -- <a href="RalfStephan.html">RalfStephan</a>
</UL> <HR>
There are some further requirements for the <a href="ClassRepository.html">ClassRepository</a>:
<UL> <LI> There should be a simple <a href="API.html">API</a> for automagically creating .jar files from classes in the repository.  This would include meta-information about the classes be automatically included in the Manifest file.  For instance, if a Class is registered as a bean in the repository, then an entry in the Manifest is created Java-Bean: true for that particular class.  This needs to be the same for Package information and versioning information.
</UL> 
-- <a href="AveryRegier.html">AveryRegier</a> 03 July 1998<BR><BR></P><!--

<TABLE width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="737b9c">
<TR><TD ALIGN="CENTER">
<! page="">login</a> or <! page="">new&nbsp;user</a><TR><TD>
</TABLE>

!-->
<!-- end BODY page !-->

<HR>

<DIV ALIGN="CENTER">
<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR>
	<TD ALIGN="CENTER" COLSPAN="2">
		Content of these pages are owned and copyrighted by the poster.
	</TD>
</TR>
<TR>
	<TD ALIGN="RIGHT" WIDTH="50%">
		Hosted by:
	</TD>
	<TD ALIGN="LEFT">
		<A HREF="http://sourceforge.net/"><IMG 
			SRC="http://sourceforge.net/sflogo.php?group_id=2376&type=1"
			BORDER=0 HSPACE=0 VSPACE=0></A>
	</TD>
</TR>
</TABLE>
</DIV>
</BODY>
</HTML>

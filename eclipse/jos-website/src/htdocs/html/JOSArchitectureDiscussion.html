<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 FINAL//EN">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <title>JOSArchitectureDiscussion.Imported @ jos.sf.net</title>
  </head>

<body bgcolor="#FFFFFF">

<!-- The FORM encloses the entire header, because it renders better that way. !-->
<form action="/jump.php"><input type="hidden" name="PHPSESSID" value="04676149ad71edf36ced3ec7cedbdf58" />

<!-- The JOS logo. !-->
<table border="0" cellspacing="0" cellpadding="3" width="100%">
<tr valign="TOP" align="LEFT">
	<td><a href="../index.html"><img 
		VSPACE="0" HSPACE="0" ALIGN="MIDDLE" BORDER="0"
		SRC="image/wikiHome.gif"></a></td>
	<!-- The tab table. !-->
	<td width="100%" align="RIGHT" bgcolor="#FFFFFF" valign="BOTTOM"> 
		<table border="0" cellspacing="0" cellpadding="3" width="100%" align="RIGHT">
			<tr valign="MIDDLE" align="LEFT">

<td bgcolor="White" width="60%">&nbsp;</td>
<td bgcolor="#FFFFCC"><a href="../index.html">Home</a></td>
<td bgcolor="White">&nbsp;</td>
<td width="10%" bgcolor="#FFFFCC" align="CENTER"><a href="../info.html">Info</a></td>
<td bgcolor="White">&nbsp;</td>
<td width="10%" bgcolor="#FFFFCC" align="CENTER"><a href="../dev.html">DevZone</a></td>
<td bgcolor="White">&nbsp;</td>
<td width="10%" bgcolor="#FFCC66" align="CENTER"><a
href="../wiki.html">Wiki</a></td>
<td bgcolor="White">&nbsp;</td>
			</tr>
			<tr>
				<td bgcolor="#FFCC66" align="RIGHT" colspan="9">
					<a href="UsersWebHome.html">UsersWeb</a>
					&nbsp;|&nbsp;
					<a href="MainWebHome.html">MainWeb</a>
					&nbsp;|&nbsp;
					<a href="InfoWebHome.html">InfoWeb</a>
					&nbsp;|&nbsp;
					<a href="DevZoneWebHome.html">DevZoneWeb</a>
					&nbsp;|&nbsp;
					<a href="SupportWebHome.html">SupportWeb</a>
				</td>
			</tr>
		</table>
	</td>		
</tr>
<!-- The WikiHeader. !-->
<tr><td colspan="2">
<table border="0" cellspacing="0" cellpadding="3" width="100%">
<tr>
	<td width="25%" align="CENTER" bgcolor="#FFFFCC" valign="CENTER">
		<b>[&nbsp;<! page="">JOSArchitectureDiscussion</a>&nbsp;]</b>
	</td>
	<td width="25%" align="CENTER" bgcolor="#FFEE88" valign="CENTER">
		<b>[ not logged in ]</b>	</td>
	<td width="25%" align="CENTER" bgcolor="#FFDD77" valign="CENTER">
		<b>[ Web: <a href="ImportedWebHome.html">Imported</a> ]</b>	</td>
	<td width="25%" align="CENTER" bgcolor="#FFCC66" valign="CENTER">
		goto:&nbsp;<INPUT TYPE="TEXT" SIZE="10" NAME="topic"><!--<INPUT TYPE="IMAGE" src="/media/go.gif?PHPSESSID=04676149ad71edf36ced3ec7cedbdf58" border="0" VALUE="topic" ALT="goto">!-->&nbsp;<! page=""><FONT SIZE="-1">options</FONT></a>
	</td>
</tr>
</table>

<table border="0" cellspacing="0" cellpadding="3" width="100%">
	<tr>
	<td align="CENTER" bgcolor="#FFFFCC" valign="TOP">
		[&nbsp;get <! page="">info</a> on or <a href="WebHome.html">edit</a>&nbsp;]	</td>
	<td align="CENTER" bgcolor="#FFEE88" valign="TOP">
		[&nbsp;<! page="">login</a> or <! page="">new&nbsp;user</a>&nbsp;]	</td>
	<td align="CENTER" bgcolor="#FFDD77" valign="TOP">
		[&nbsp;list of <a href="Glossary.html">topics</a>, <! page="">hubs&nbsp;&amp;&nbsp;nodes</a>, or <a href="NewArticles2a.html">recent&nbsp;changes</a>&nbsp;]	</td>
	</tr>
</table>

<!-- From CommonHeader !-->
</tr></td>
</table>
</form>

<!-- start BODY page !-->
<p>
<FONT SIZE="-1"> <a href="PlatformAPIPages.html">PlatformAPIPages</a> </FONT>
</p><p>
We need to break up the <! page="">JOS</a> architecture into small slivers to deal out to everyone. Right now, we have a general architectural overview, which needs to be refined and inspected with an electron-scanning microscope.
</p><p>
This will require us to maintain the various architecture subpages to keep them up-to-date with the current design. This means comments can and probably should be cleaned up on occation as they no longer apply.
</p><p>
To start the discussion going, I'm going to quote from <a href="DigiGod.html">DigiGod</a>, a message he posted <a href="http://cjos.sourceforge.net/redist/mail/arch/1999-November/000319.html">18 Nov 1999</a> to JOS and JOSArch mailing groups, then I'll follow up with my web-interpretation of his words. It was a rather long message, but I feel that it's well worth quoting in a more accesible place than the newsgroups:
</p><p>
<blockquote>
<I>In the more recent threads here I have noticed some confusion about the seperation of the elements of JOS, so I am going to attempt to clarify these here.
</p><p>
JOS is not like its predecessors, it is not one large monolithic clump-o'-OS. First we have JOSCore, this is the minimal OS consisting of a JOSBox and a minimal <a href="JOSystem.html">JOSystem</a> and no more. Then we have "<a href="JOSExtensions.html">JOSExtensions</a>" the devices, drivers and services it takes to be able to use JOS for more then the <! page="">RAM</a> equivalent of a paperweight. Running on top of this is the "Application Level" most notably <a href="JADE.html">JADE</a> and its <! page="">PUI</a> (allowing the computer to interact with the user). This is all suspended in the lime Jell-O that is the Java and JOS API's (I think we should discriminate between JOS API's that require JOS and those that don't, I propose that the ones that do not require JOS be reffered to as the JOS Extra API's -- someone give that a better name...).
</p><p>
An Install/Uninstall library is an excellent idea, although it is not part of JOSystem it is a JOS Extra API (I hate to seem like I'm picking on it. I'm not, it's just the first instance I thought of...). Furthermore, JOSystem is -- basically -- just a pure java kernel (it takes on the classic role of the kernel in most senses and buffers between everyone and the real kernel in the other cases) and an appplication runner.
</p><p>
The JOSBox is the computer were writing this OS for, in a sense. It is the virtual hardware the JOSystem "kernel" is running on, if someone made this into real hardware a modified JOSystem would run JOS on it directly. It is the true kernel and the JVM. A JOSBox application could be made sans kernel, this is how you could run JOS on a non-JOS machine; the JOSystem would require extra features the JOSBox supplies to run so just running it on "any old VM" would be painful, a special JOSBox would be the way to go. The main benifit of this I see is not in having a showcase for JOS but in having a multi-process java environment running on ones computer, allowing (with minor modification) to let the OS "launch" Java apps into this environment/quasiOS cutting down on memory and start time (people would get to tour JOS then get to keep a powerful tool like that). I think we should get a kernel/VM JOSBox up then modify it to be an "emulator" JOSBox later on, just my opinion though.
</p><p>
<! page="">JVM</a> incompatabilities might be solved with the exokernel design. Exokernel is basically a blank slate of a kernel that allows libraries to be plugged into it to provide optimal hardware use (and, of course, having a default library for legacy apps). Whats this have to do with JVM's!? Good question, say we have most of the stuff that makes a <! page="">JVM</a> and then have little libraries filling the rest in, in a release compatiable manner. That is, we have <! page="">XVM</a> (exo-VM) with a <! page="">JDK</a> 1.0 library, a 1.1 lib and a 1.2 lib. I don't know how well that would work, but its worth a thought.
</p><p>
--DigiGod
</I>
</blockquote>
</p><p>
To me, the architecture becomes (from bottom to top):
</p><p>
<!-- If you know a better way to do this table, go for it! -->
<table align="CENTER" width="80%" border="1" bgcolor="#008080">
  <tr align="CENTER">
	 <td> <a href="JOSCore.html">JOSCore</a>
		<table align="CENTER" width="70%" border="1" bgcolor="#8080FF">
		<tr align="CENTER">
		  <td> <a href="JOSBox.html">JOSBox</a>
			  <table align="CENTER" width="50%" border="1" bgcolor="#808000">
				 <tr align="CENTER">
					<td> Kernel (native) </td>
				 </tr>
				 <tr align="CENTER">
					<td> <! page="">JVM</a> (native) </td>
				 </tr>
			  </table>
		  </td>
		</tr>
		<tr align="CENTER">
		  <td> <a href="JOSystem.html">JOSystem</a> </td>
		</tr>
	 </table></td>
  </tr>
  <tr align="CENTER">
	 <td> <a href="JOSExtensions.html">JOSExtensions</a> </td>
  </tr>
  <tr align="CENTER">
	 <td> <! page="">ApplicationLevel</a> </td>
  </tr>
</table>
</p><p>
Where:
<ul> <li> <a href="JOSCore.html">JOSCore</a> - the minimal OS, consisting of:
<ul> <li> <a href="JOSBox.html">JOSBox</a> - The "virtual computer" <a href="JOSystem.html">JOSystem</a> is running on.
<li> <a href="JOSystem.html">JOSystem</a> - The bare minimal 
<li> No more
</ul> <li> <a href="JOSExtensions.html">JOSExtensions</a> - the devices, drivers and services it takes to be able to use <! page="">JOS</a> for more then the <! page="">RAM</a> equivalent of a paperweight
<li> <! page="">ApplicationLevel</a> - most notably <a href="JADE.html">JADE</a> and its <! page="">PUI</a> (allowing the computer to interact with the user)
</ul> 
-- <a href="MattAlbrecht.html">MattAlbrecht</a> - 18 Nov 1999 
</p><p>
</p><p>
See also [ <a href="JOSystem.html">JOSystem</a> ] [ <a href="JOSBox.html">JOSBox</a> ] [ <a href="PlatformAPIPages.html">PlatformAPIPages</a> ] [ <a href="JOSCore.html">JOSCore</a> ]
</p><p>
<hr>
<p>The general architecture of <! page="">JOS</a> should explain how the major pieces of the operating system fit together. It is the mission of these pages to search for that architecture and explain it. As soon as we figure out how these thing work, we can implement the architecture in code.</p>
<p>As you can see, the kernel and a virtual machine are two separate pieces. There might be more than one virtual machine that runs on a given kernel. For Java programmers, the relationship and responsibilities of these pieces might be explained in Java-like pseudo code. See also <a href="JOSArchitectureInJava.html">JOSArchitectureInJava</a>.</p>
<p>How do we get there? We build a kernel. We build a JVM. We build another JVM. Then, we can figure out how you might build more than one <! page="">JVM</a> for a kernel. A interface between a <! page="">JVM</a> and its kernel is difficult to anticipate. It will mature as we go. -- <a href="GilbertHerschberger.html">GilbertHerschberger</a> (19 November 1999).</p>
</p><p>
<hr>
</p><p>
Based on the discussions about <a href="JOSBoxModule.html">JOSBoxModule</a> and <a href="JOSKernelModule.html">JOSKernelModule</a>, the above (rather large and unsightly) table/model needs to be updated.
</p><p>
Here's my latest go at it.  I've tried to separate the levels, so that all native code is in one area, and all bytecodes are in the next level:
</p><p>
<table border="1">
  <tr bgcolor="#8080FF">
	 <td colspan="2">Native</td>
  </tr>
	 <td>
<ul> <li> <a href="JOSCore.html">JOSCore</a>
<ul> <li> <a href="JOSBox.html">JOSBox</a>
<ul> <li> Kernel
<li> Module Interface
</ul> </ul> </ul> 	 </td>
	 <td>
<ul> <li> <a href="JOSKernelModule.html">JOSKernelModule</a>
<li> <a href="JOSKernelModule.html">JOSKernelModule</a>
<li> ...
</ul> 	 </td>
  </tr>
  <tr bgcolor="#8080FF">
	 <td colspan="2">Bytecode</td>
  </tr>
  <tr>
	 <td colspan="2">
<ul> <li> <a href="JOSystem.html">JOSystem</a>
<li> <a href="JOSExtensions.html">JOSExtensions</a>
<li> <! page="">ApplicationLevel</a>
</ul> 	 </td>
  </tr>
</table>
</p><p>
In this way, the <a href="JOSKernelModule.html">JOSKernelModule</a>s are separate from the Core, yet are between the Extentions and the Core.  The modules are still native, but are not used by 
</p><p>
</p><p>
-- <a href="MattAlbrecht.html">MattAlbrecht</a> - 06 Dec 1999
<hr>
<p>Matt, your diagram clearly illustrates the machine code vs. bytecode. I like that. From your diagram and a diagram in <a href="JosPlatform.html">JosPlatform</a>, I put together the most comprehensive (for me) diagram I can think of. This diagram illustrates machine code vs. native interface vs. bytecode.</p>
<p>Here is yet another diagram of the JOS platform, based on the above diagram and other platform API pages.</p>
<div align="right">
<table border="2" BORDERCOLOR="black" bgcolor="lightblue" ROWS="2">
<tr bgcolor="lightblue">
<td colspan="2" align="CENTER">
  <FONT FACE="Arial" SIZE="+1">Machine Code</code></FONT>
</td>
</tr>
<tr>
<td colspan="2" align="CENTER">
  <table COLS="2" BORDERCOLOR="black" border="2">
  <tr>
  <td align="CENTER">
  <FONT FACE="Arial" SIZE="+1" COLOR="darkpurple">%JOSBox</link</FONT>
	 <table bgcolor="khaki" border="1">
	 <tr>
	 <td valign="TOP">Kernel</td>
	 <td><a href="JOSKernelModule.html">JOSKernelModule</a>...
	 <ul>
	 <li><a href="VirtualMachine.html">VirtualMachine</a><SUP>2</SUP>...
	 <li>ATAPI
	 <li>SCSI
	 <li>network
	 </ul>
	 </td>
	 </tr>
	 <tr>
	 <td><a href="VirtualMachine.html">VirtualMachine</a><SUP>1</SUP></td>
	 </tr>
	 </table>
	 </td>
  </tr>
  </table>
</td>
</tr>
<tr bgcolor="lightblue">
<td colspan="2" align="CENTER">
  <FONT FACE="Arial" SIZE="+1">Native Interface</FONT>
</td>
</tr>
<tr bgcolor="lightblue">
<td colspan="2" align="CENTER">
  <table border="1" BORDERCOLOR="black" bgcolor="khaki">
  <tr>
  <td>decaf Native Interface</td>
  </tr>
  <tr>
  <td><! page="">JavaNativeInterface</a></td>
  </tr>
  </table>
</td>
</tr>
<tr bgcolor="lightblue">
<td colspan="2" align="CENTER">
  <FONT FACE="Arial" SIZE="+1">Bytecode</code></FONT>
</td>
</tr>
<tr>
<td align="CENTER" valign="TOP">
  <FONT FACE="Arial" SIZE="+1" COLOR="darkpurple"><a href="JOSystem.html">JOSystem</a></FONT>
	 <table border="1" bgcolor="khaki" BORDERCOLOR="black">
	 <tr>
	 <td><! page="">BytecodeNativeInterface</a></td>
	 </tr>
	 <tr>
	 <td><! page="">JVMSpecificClasses</a></td>
	 </tr>
	 </table>
</td>
<td>
  <table border="1">
  <tr bgcolor="yellow">
  <td colspan="4" align="CENTER">
  <FONT FACE="Arial" SIZE="+1">Java Class Libraries <code>java.<STRONG></code>, <code>javax.</STRONG></code></FONT>
  </td>
  </tr>
  <tr bgcolor="lightblue">
  <td valign="TOP">
  Java 0 Platform
	 <table border="1" BORDERCOLOR="black" bgcolor="khaki">
	 <tr>
	 <td>Applets</td>
	 </tr>
	 <tr>
	 <td>Applications</td>
	 </tr>
	 <tr>
	 <td>AWT</td>
	 </tr>
	 </table>
  </td>
  <td valign="TOP">
  Java 1 Platform
	 <table border="1" BORDERCOLOR="black" bgcolor="khaki">
	 <tr>
	 <td>Applets</td>
	 </tr>
	 <tr>
	 <td>Applications</td>
	 </tr>
	 <tr>
	 <td>AWT</td>
	 </tr>
	 <tr>
	 <td>Servlets</td>
	 </tr>
	 <tr>
	 <td>Swing</td>
	 </tr>
	 </table>
  </td>
  <td valign="TOP">
  Java 2 Platform
	 <table border="1" BORDERCOLOR="black" bgcolor="khaki">
	 <tr>
	 <td>Applets</td>
	 </tr>
	 <tr>
	 <td>Applications</td>
	 </tr>
	 <tr>
	 <td>AWT</td>
	 </tr>
	 <tr>
	 <td>Servlets</td>
	 </tr>
	 <tr>
	 <td>Swing</td>
	 </tr>
	 </table>
  </td>
  <td valign="TOP">
  Java 3 Platform
	 <table border="1" BORDERCOLOR="black" bgcolor="khaki">
	 <tr>
	 <td>Applets</td>
	 </tr>
	 <tr>
	 <td>Applications</td>
	 </tr>
	 <tr>
	 <td>AWT</td>
	 </tr>
	 <tr>
	 <td>Servlets</td>
	 </tr>
	 <tr>
	 <td>Swing</td>
	 </tr>
	 </table>
  </td>
  </tr>
  <tr bgcolor="yellow">
  <td colspan="4" align="CENTER">
  <FONT FACE="Arial" SIZE="+1">Custom Class Libraries</FONT>
  </td>
  </tr>
  <tr>
  <td colspan="4" align="CENTER">
	 <table border="1" BORDERCOLOR="black" bgcolor="khaki">
	 <tr>
	 <td>
	 <ul>
	 <li>drivers...
	 <li>file subsystems...
	 <li>services...
	 <li>tools...
	 <li><a href="JADE.html">JADE</a>
	 <li><a href="Registry.html">Registry</a>
	 <li><! page="">SmartAPI</a>
	 <li><a href="TCPIPStack.html">TCPIPStack</a>
	 </ul>
	 </td>
	 </tr>
	 </table>
  </td>
  </tr>
  <tr bgcolor="yellow">
  <td colspan="4" align="CENTER">
  <FONT FACE="Arial" SIZE="+1">User Applications</FONT>
  </td>
  </tr>
  <tr>
  <td colspan="4" align="CENTER">
	 <table border="1" BORDERCOLOR="black" bgcolor="khaki">
	 <tr>
	 <td>
	 <ul>
	 <li><a href="Jext.html">Jext</a>
	 </ul>
	 </td>
	 </tr>
	 </table>
  </td>
  </tr>
  </table>
</td>
</tr>
</table>
</div>
<p>This is only a dependency diagram. <a href="JOSCore.html">JOSCore</a> and <a href="JOSExtensions.html">JOSExtensions</a> are missing because they are related to distribution, not dependency.</p>
<p>This diagram illustrates an architecture with a place for everything I can imagine. It has strong support for bytecode from past, present and future Java Platforms. It enables us to create a mostly bytecode operating system. It includes a place for custom machine code when its absolutely necessary.</p>
<p>This diagram shows that custom class libraries are written in pure bytecode. When a custom class library needs additional machine code support, it must use a native interface to invoke machine code written in a kernel module. -- <a href="GilbertHerschberger.html">GilbertHerschberger</a> (8 December 1999).</p>
<hr>
<p>Not only are there many virtual machines for one kernel, there are many kernels for a virtual machine. The decaf virtual machine is designed to work with any "kernel", any object that extends the <code>kernel</code> class. When it is written to usea platform-independent kernel class, decaf runs unchanged on <EM>host</EM> and <EM>i386</EM> builds of the <a href="JJOS.html">JJOS</a> kernel.</p>
<p>When writing a custom C/C++ program to test a kernel function, your test program must implement a decaf-like interface. Strictly speaking of course, a kernel is not required to run a virtual machine. -- <a href="GilbertHerschberger.html">GilbertHerschberger</a> (7 March 2000).</p><br><br></p><!--

<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="737b9c">
<tr><td align="CENTER">
<! page="">login</a> or <! page="">new&nbsp;user</a><tr><td>
</table>

!-->
<!-- end BODY page !-->

<hr>

<div align="CENTER">
<table border="0" cellpadding="3" cellspacing="0" width="100%">
<tr>
	<td align="CENTER" colspan="2">
		Content of these pages are owned and copyrighted by the poster.
	</td>
</tr>
<tr>
	<td align="RIGHT" width="50%">
		Hosted by:
	</td>
	<td align="LEFT">
		<a href="http://sourceforge.net/"><img 
			SRC="http://sourceforge.net/sflogo.php?group_id=2376&type=1"
			BORDER=0 HSPACE=0 VSPACE=0></a>
	</td>
</tr>
</table>
</div>
</body>
</html>

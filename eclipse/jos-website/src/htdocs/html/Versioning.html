<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 FINAL//EN">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <title>Versioning.Imported @ jos.sf.net</title>
  </head>

<body bgcolor="#FFFFFF">

<!-- The FORM encloses the entire header, because it renders better that way. !-->
<form action="/jump.php"><input type="hidden" name="PHPSESSID" value="17af5d91e073788f1be93301296c9ba9" />

<!-- The JOS logo. !-->
<table border="0" cellspacing="0" cellpadding="3" width="100%">
<tr valign="TOP" align="LEFT">
	<td><a href="../index.html"><img 
		VSPACE="0" HSPACE="0" ALIGN="MIDDLE" BORDER="0"
		SRC="image/wikiHome.gif"></a></td>
	<!-- The tab table. !-->
	<td width="100%" align="RIGHT" bgcolor="#FFFFFF" valign="BOTTOM"> 
		<table border="0" cellspacing="0" cellpadding="3" width="100%" align="RIGHT">
			<tr valign="MIDDLE" align="LEFT">

<td bgcolor="White" width="60%">&nbsp;</td>
<td bgcolor="#FFFFCC"><a href="../index.html">Home</a></td>
<td bgcolor="White">&nbsp;</td>
<td width="10%" bgcolor="#FFFFCC" align="CENTER"><a href="../info.html">Info</a></td>
<td bgcolor="White">&nbsp;</td>
<td width="10%" bgcolor="#FFFFCC" align="CENTER"><a href="../dev.html">DevZone</a></td>
<td bgcolor="White">&nbsp;</td>
<td width="10%" bgcolor="#FFCC66" align="CENTER"><a
href="../wiki.html">Wiki</a></td>
<td bgcolor="White">&nbsp;</td>
			</tr>
			<tr>
				<td bgcolor="#FFCC66" align="RIGHT" colspan="9">
					<a href="UsersWebHome.html">UsersWeb</a>
					&nbsp;|&nbsp;
					<a href="MainWebHome.html">MainWeb</a>
					&nbsp;|&nbsp;
					<a href="InfoWebHome.html">InfoWeb</a>
					&nbsp;|&nbsp;
					<a href="DevZoneWebHome.html">DevZoneWeb</a>
					&nbsp;|&nbsp;
					<a href="SupportWebHome.html">SupportWeb</a>
				</td>
			</tr>
		</table>
	</td>		
</tr>
<!-- The WikiHeader. !-->
<tr><td colspan="2">
<table border="0" cellspacing="0" cellpadding="3" width="100%">
<tr>
	<td width="25%" align="CENTER" bgcolor="#FFFFCC" valign="CENTER">
		<b>[&nbsp;<! page="">Versioning</a>&nbsp;]</b>
	</td>
	<td width="25%" align="CENTER" bgcolor="#FFEE88" valign="CENTER">
		<b>[ not logged in ]</b>	</td>
	<td width="25%" align="CENTER" bgcolor="#FFDD77" valign="CENTER">
		<b>[ Web: <a href="ImportedWebHome.html">Imported</a> ]</b>	</td>
	<td width="25%" align="CENTER" bgcolor="#FFCC66" valign="CENTER">
		goto:&nbsp;<INPUT TYPE="TEXT" SIZE="10" NAME="topic"><!--<INPUT TYPE="IMAGE" src="/media/go.gif?PHPSESSID=17af5d91e073788f1be93301296c9ba9" border="0" VALUE="topic" ALT="goto">!-->&nbsp;<! page=""><FONT SIZE="-1">options</FONT></a>
	</td>
</tr>
</table>

<table border="0" cellspacing="0" cellpadding="3" width="100%">
	<tr>
	<td align="CENTER" bgcolor="#FFFFCC" valign="TOP">
		[&nbsp;get <! page="">info</a> on or <a href="WebHome.html">edit</a>&nbsp;]	</td>
	<td align="CENTER" bgcolor="#FFEE88" valign="TOP">
		[&nbsp;<! page="">login</a> or <! page="">new&nbsp;user</a>&nbsp;]	</td>
	<td align="CENTER" bgcolor="#FFDD77" valign="TOP">
		[&nbsp;list of <a href="Glossary.html">topics</a>, <! page="">hubs&nbsp;&amp;&nbsp;nodes</a>, or <a href="NewArticles2a.html">recent&nbsp;changes</a>&nbsp;]	</td>
	</tr>
</table>

<!-- From CommonHeader !-->
</tr></td>
</table>
</form>

<!-- start BODY page !-->
<p>
<h1>Versioning for JOS</h1>
</p><p>
</p><p>
<pre>&lt;B&gt;Prepared by Chris Bergstresser ( &lt;external mailto:chris@subtlety.com&gt;mailto:chris@subtlety.com&lt;/external&gt; )
Version 0.1
28 Oct 1997</b></pre>
</p><p>
</p><p>
<p>In the design and deployment of object-oriented systems, versioning
is a critical requirement. This document attempts to briefly describe
the problems associated with versioning for Java, explain what API's Sun
is creating to help solve the problem, and propose a workable system for
JOS.</p>
</p><p>
</p><p>
<h2>The Problem</h2>
</p><p>
</p><p>
<p>There are a number of problems associated with deploying programs
which rely on a set of heterogeneous components external to the program.
These include:</p>
</p><p>
</p><p>
<h3>Distribution of incompatible versions</h3>
<p>A new version of a class may be <! page="">Incompatible</a> with previous versions. Software designed to run with one class may behave erratically when used with a later version.</p>
</p><p>
</p><p>
<h3>Update of old versions</h3>
<p>Newer systems may rely on a set of classes which are outdated on the
target system. Thus, the installation of a single component may require
the updating of any number of other components.</p>
</p><p>
</p><p>
<h3>Synchronizing of existing distributions</h3>
<p>In a distributed environment, it is possible that some systems may be
using old versions of a class, and may continue to use the old version
while interacting with newer versions on other computers. Indeed, it is
possible (in fact, likely) that within the same system a given program
may have some classes loaded in a classloader or serialized to disk
while the source for the class is changed.</p>
</p><p>
</p><p>
<p><b>A more detailed examination of the problem, as well as Sun's
pre-release specification, can be found at <a href="http://java.sun.com/products/jdk/1.2/docs/guide/versioning/spec/VersioningTOC.doc.html">http://java.sun.com/products/jdk/1.2/docs/guide/versioning/spec/VersioningTOC.doc.html</a> </b></p>
</p><p>
</p><p>
<h2>Upcoming APIs</h2>
</p><p>
</p><p>
<p>Sun has recognized the problems with distributed systems, and is
publishing a versioning specification for inclusion with a later version
of Java. </p>
</p><p>
</p><p>
<h3>Package-level distribution</h3>
<p>The basic unit of distribution for Sun is the package. All the
classes in a given package are distributed in bulk. There is no
provision made for updating individual classes within a package.</p>
</p><p>
</p><p>
<h3>Archive support for versioning</h3>
<p>Packages distributed in an archive must report their versioning
information through the manifest file. This file contains information
about the Title, Version Number, and Vendor for both the implementation
which is being distributed as well as the specification which the
implementation adheres to.</p>
</p><p>
</p><p>
<h3>Classloader changes</h3>
<p>The classloader is responsible for tracking the versions of packages
currently loaded, for use in debugging.</p>
</p><p>
</p><p>
<h3>Compatibility issues</h3>
<p>Sun's versioning <a href="API.html">API</a> makes the assumption that all changes to a
specification are backwardly compatible. All serializable classes must
insure they can deserialize and be deserialized by older versions. 
Interfaces are not permitted to add, change, or remove methods. Classes
are not permitted to remove or alter existing methods. Sun's versioning
specification provides no way to indicate that a given package is
incompatible with a previous one.</p>
</p><p>
</p><p>
<h2>Implications for JOS</h2>
</p><p>
</p><p>
<h3>Package-level upgrading</h3>
<p>JOS should use Sun's definition of a package as the minimal unit of
distribution. Exceptions will be made for "packageless" classes --
factory objects, small utility classes, and drivers which do not make
sense as a part of a larger distribution. The classloader should track
these pieces individually.</p>
</p><p>
</p><p>
<h3>Dynamic upgrading of a package</h3>
<p>When a set of classes is upgraded, the new classes will be copied to
the local system. The old classes, which are to be replaced, are not
removed. Instead, packages already loaded in classloaders will still
exist, and will continue to do so for as long as a class remains loaded
in memory. Once all of the classes in an upgraded package has been
unloaded, the next loading of a class from the package will use the new
version. The system is free to erase the previous package. If the
package in question is a system-wide package, replacement will require a
reboot. For packages loaded locally to a process, this can be an
incremental process; new processes can use the new classes, while old
processes can continue using the old. As long as Sun's compatibility
rules are followed, there should be no problems with this model.</p>
</p><p>
</p><p>
<h3>Incompatible versions</h3>
<p>It may be desirible to install two different versions of the same
package on the system. This can be accomplished by having the
classloaders for different processes refer to the different versions,
thus preventing them from being loaded into the same space. This causes
a problem from two points-of-view. First, it requires a knowledgeable
administrator to actively track down the incompatibilities and specify
which processes should use which versions. Second, this will not work
for system-level packages, since they must be shared among all processes
(and as such, cannot use different versions).</p>
</p><p>
</p><p>
<h2>Open questions</h2>
</p><p>
</p><p>
<h3>Recovery of previous versions</h3>
<p>There should probably be a mechanism in place where, once a given
package is upgraded, the previous version can be recovered and
reinstalled if the new one turns out to be unworkable. Suggestions?</p>
</p><p>
</p><p>
<h3>Definition of system packages</h3>
<p>System packages are defined as those packages which are shared among
all classloaders. Obviously (or not?), the jos.* packages would fit
into this catagory. Individual user's classes would not (or would
they?). The question is mostly whether the java.* packages should be,
or should not be, or whether this should be user-configurable or not. 
This has an effect on other portions of <! page="">JOS</a> -- for every package that is
not shared, a separate copy must be kept in memory for each classloader
that references it.</p>
<p>It might be possible to define an intermediate level of sharing -- a
class is shared among all the user's processes, but not system wide. 
This would cut down on memory use, but greatly increases the difficulty
managing upgrades.</p>
</p><p>
</p><p>
<h3>Discussion of incompatible versions</h3>
<p>How much faith do we give Sun's versioning spec? How likely is it
that incompatible versions will surface, and (more to-the-point) that we
will need to run incompatible versions of packages side-by-side in the
same system? The answer to this question determines how much effort we
need to put into the above. Obviously, if there is no need to run
incompatible versions in JOS, things become much easier.</p>
<ul>
<li>If I may say so, Sun's versioning spec doesn't solve Sun's own problems with three versions of Java (1.0.2, 1.1 and 2.0). It is woefully inadequate and, as history may show, could be Sun's fatal flaw. Sun may lose control of Java because they failed to keep their promise of Write Once. From our 10+ years experience with extreme distributed computing, Sun's whole versioning premise is misguided. Such a shame, too. With three versions of Java and all of the trouble they have caused their customers, Sun wonders <EM>if</EM> they are in trouble; but, their versioning solution is a dead end. The correct answer is so simple it is often overlooked and it is <b>namespace</b>.
<ol>
<li>Sun named Java 1.0.2 as <code>java.*</code>;
<li>Sun mistakenly named Java 1.1 <code>java.<STRONG></code>, too; and should have named it <code>java.11.</STRONG></code>.
<li>Sun mistakenly named Java 1.2 <code>java.<STRONG></code>, too; and should have named it <code>java.12.</STRONG></code>;
</ol>
Architecture is supposed to solve entire worlds of problems. If Sun would have named new and incompatible packages thus, versioning would have been a non-issue. Looking ahead, <! page="">JOS</a> should be expected to have different versions, too.
<ol>
<li>JOS 1.0.x could be named <code>jos.10.*</code>
<li>JOS 2.0.x could be named <code>jos.20.*</code>
<li>JOS 5.3.x could be named <code>jos.53.*</code>
</ol>
The trouble with versioning doesn't immerge until you start the second version. Look to Sun for advice on versioning if you think they have a perfect track record on it. - <a href="GilbertHerschberger.html">GilbertHerschberger</a>
<li>Finding the simplest versioning approach is the goal. After working with versions in Java for a while, the simplest approach seems to be the following:
  <ul>
  <li>Everything related to <! page="">JOS</a> could be named <code>org.jos</code>.
  <li>Releases of the <! page="">JOS</a> core could be named <code>org.jos.core1a</code>, <code>org.jos.core1b</code>, and <code>org.jos.core1c</code>;
  <li>Releases of the <! page="">JOS</a> I/O subsystem could be named <code>org.jos.io1a</code>, <code>org.jos.io1b</code>, and <code>org.jos.io1c</code>;
  <li>Releases of the <! page="">JOS</a> application framework could be named <code>org.jos.app1a</code>, <code>org.jos.app1b</code>, and <code>org.jos.app1c</code>; and
  <li>Releases of the <! page="">JOS</a> Abstract Windowing Toolkit could be named <code>org.jos.awt1a</code>, <code>org.jos.awt1b</code>, and <code>org.jos.awt1c</code>.
  </ul>
In practice, every package should be independently released. There is no version 2 of <! page="">JOS</a> as a whole. There are only second and third releases of some packages within JOS. - <a href="GilbertHerschberger.html">GilbertHerschberger</a>
</ul>
</p><p>
</p><p><br><br></p><!--

<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="737b9c">
<tr><td align="CENTER">
<! page="">login</a> or <! page="">new&nbsp;user</a><tr><td>
</table>

!-->
<!-- end BODY page !-->

<hr>

<div align="CENTER">
<table border="0" cellpadding="3" cellspacing="0" width="100%">
<tr>
	<td align="CENTER" colspan="2">
		Content of these pages are owned and copyrighted by the poster.
	</td>
</tr>
<tr>
	<td align="RIGHT" width="50%">
		Hosted by:
	</td>
	<td align="LEFT">
		<a href="http://sourceforge.net/"><img 
			SRC="http://sourceforge.net/sflogo.php?group_id=2376&type=1"
			BORDER=0 HSPACE=0 VSPACE=0></a>
	</td>
</tr>
</table>
</div>
</body>
</html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [JOS-Arch] rheise.os questions</TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:tmiller%40haverford.edu">
   <LINK REL="Previous"  HREF="000494.html">
   <LINK REL="Next" HREF="000477.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[JOS-Arch] rheise.os questions</H1>
    <B>Todd L. Miller</B> 
    <A HREF="mailto:tmiller%40haverford.edu"
       TITLE="[JOS-Arch] rheise.os questions">tmiller@haverford.edu</A><BR>
    <I>Thu, 20 Apr 2000 23:47:21 -0400 (EDT)</I>
    <P><UL>
        <LI> Previous message: <A HREF="000494.html">[JOS-Arch] rheise.os questions</A></li>
        <LI> Next message: <A HREF="000477.html">[JOS-Arch] Java Processes: Final Summary?</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#495">[ date ]</a>
              <a href="thread.html#495">[ thread ]</a>
              <a href="subject.html#495">[ subject ]</a>
              <a href="author.html#495">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> Yes, but often not to initialise it. Objects have constructors partly
</I>&gt;<i> because it enables internals to be set in a way that is impossible after
</I>&gt;<i> the object is constructed. A similar effect can be achieved for static
</I>&gt;<i> classes.
</I>
	OK, I understand your point.  Things like this will get hammered
by out by doing the implementation.

&gt;<i> &gt; 	Architecturally, I think it would work better to have the
</I>&gt;<i> &gt; primordial class loader check the kernel's class definition cache
</I>&gt;<i> &gt; first.  (I'm not sure we want system-wide statics, but I'm open to being
</I>&gt;<i> &gt; convinced.)
</I>&gt;<i> 
</I>&gt;<i> In rheise.os, the primordial class loader of a process is called a
</I>&gt;<i> ProcessClassLoader. Does that mean we agree?
</I>
	If and only if we guarantee that ProcessClassLoader is one of
those classes which are consistent system-wide.  I think I assume/imply
later on that the PCL generated by decaf for a JavaProcess is entirely
native, which makes PCL an interface.  This isn't necessary, and perhaps
is not desirous; my intent was to minimize the overall number of native
calls, since they'll probably incur a performance penalty.

&gt;<i> Are you implying that each ProcessClassLoader has its own class
</I>&gt;<i> definition cache? Can you explain how this works?
</I>
	Every classloader must cache its classes -- otherwise, static
references wouldn't work.  Because we can split the definition and the
statics, what the classloaders will actually point to is a class
definition pointer and static variable pointer pair.  The class definition
pointer may point at a shared copy (a cache.)  The static variable pointer
must not be shared, for obvious reasons.  What I meant by 'insert before
returning' is that /this/ cache/table could have entries in it with shared
class definitions and unique statics /before/ the Java code has a chance
to load a differing definition.  Any attempt to define bytecode for a
class already loaded is rejected according to the spec, so the JavaProcess
class definition, for instance, remains consisten across all processes.

	Furthermore, I wrote the 'final summary' in such a fashion that it
does not require a system-wide cache, though the transitive closure of the
pair-sharing it does define could very well be the whole system; as I
mentioned elsewhere, I'm not totally convinced the cache /must/ be
system-wide, though there are obviously specific classes which ought to be
system-wide.  That is, does the set of system-wide-by-design classes
exactly correspond to the set of classes which will be
system-wide-by-caching?  I /think/ the answer is yes, but I'm not sure.  
That is, any class definition differing between two processes is not
shared, so it /shouldn't/ be a problem to share the common class
definitions among every process which uses them.  I just can't shake the
feeling that I'm missing/forgetting something...

&gt;<i> Ok. I'd still like to maintain the Java implementation in case it proves
</I>&gt;<i> to be useful in the end.
</I>
	It probably will.  We'll see during implementation :)

-_Quinn



</pre>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000494.html">[JOS-Arch] rheise.os questions</A></li>
	<LI> Next message: <A HREF="000477.html">[JOS-Arch] Java Processes: Final Summary?</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#495">[ date ]</a>
              <a href="thread.html#495">[ thread ]</a>
              <a href="subject.html#495">[ subject ]</a>
              <a href="author.html#495">[ author ]</a>
         </LI>
       </UL>
</body></html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [JOS-Admin] SWAT Team</TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:RegierAveryJ%40JDCORP.deere.com">
   <LINK REL="Previous"  HREF="000134.html">
   <LINK REL="Next" HREF="000137.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[JOS-Admin] SWAT Team</H1>
    <B>Regier Avery J</B> 
    <A HREF="mailto:RegierAveryJ%40JDCORP.deere.com"
       TITLE="[JOS-Admin] SWAT Team">RegierAveryJ@JDCORP.deere.com</A><BR>
    <I>Tue, 10 Aug 1999 13:29:23 -0500</I>
    <P><UL>
        <LI> Previous message: <A HREF="000134.html">[JOS-Admin] SWAT Team</A></li>
        <LI> Next message: <A HREF="000137.html">[JOS-Admin] wiki.jos.org &amp; some thoughts.</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#136">[ date ]</a>
              <a href="thread.html#136">[ thread ]</a>
              <a href="subject.html#136">[ subject ]</a>
              <a href="author.html#136">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Helmut wrote:
	Hi Ian
	I am not familiar with the Wiki at all, but if it was set up so that
a web
	bot that is simply reading some of the ASCII parts of each file,
triggers
	executables, then that would have happened millions of times before,
and
	not suddenly started that day. I think you have to look a bit
further.

The search script was only added in the last month or two.  This just
happens to be the first webbot to travel the www.jos.org site since then.

	I know, a good shoemaker goes barefoot, and we never have time for
our own
	tools until they break. However, something broke and just moving it
to
	another machine won't fix it.

Yes, something is broke, and we know exactly what it is.  The 'search'
script uses a brain-dead algorithm.  Even one search will search each and
every wiki file for every request.  This uses a fair amount of resources.
It takes 40 seconds to complete.  When a new search is done every 11
seconds, this will drive any server to its knees.  For now, we are
suggesting leaving this script turned off, while turning the safe scripts
back on.  We don't *need* to move them to another machine unless you refuse
to turn the safe scripts back on.

	Personally I think even replacing that old Perl search with a
modern,
	compiled searcher won't be a cure-all. That old search HAS worked OK
until
	the voting stuff was added. THAT''s the place where I would look for
	missing brackets. 

	What are the voting related scripts doing? Are they using the Wiki
search
	and leaving something open ? 

What we are talking about is eventually replacing the search with one that
does not parse every wiki page for every search, but rather does a simple
database call.  It has nothing to do with compilation.  It has *nothing* to
do with voting.  There are *no* voting scripts. period.  The only thing to
do with voting on the site are a few normal wiki pages and a mailing list,
which is working fine, just like all of the other mailing lists, and has
been working for several months.

	You have to look at what was new on that day. The web bots have
cruised the
	site hundreds of times every day since long before Wiki was added.
There
	was no change in that. If they WERE involved in the meltdown, then
you have
	to look at what could have suddenly, and for the first time on that
day,
	mis-interpreted their cataloguing as something else.

Yes, webbots have cruised the site before.  They did not have handy links to
the 'search' script before at the bottom of every wiki page.  Please re-read
my post from yesterday with my analyses of the problem.

	Re moving Wiki onto a different machine, I think that is either in
progress
	or has been completed. Clark would know the details about that.

Iain and I are the ones who are trying to find time to move the wiki.  Iain
is on vacation in Hawaii, and I have been spending my available time
analyzing what happenned so that we don't have to move the wiki, just like
you suggested.  My analyses says that the problem is that the search script
is brain-dead.  My suggestion is that you leave that script un-executable,
and make the rest of the scripts executable again so that we can continue
our collaboration.  There is no longer any reason to leave the wiki
unoperational.

Thanks,
Avery J. Regier



&gt;<i> -----Original Message-----
</I>&gt;<i> From:	Dear Webby [SMTP:<A HREF="mailto:DearWebby@webby.com">DearWebby@webby.com</A>]
</I>&gt;<i> Sent:	Tuesday, August 10, 1999 1:36 PM
</I>&gt;<i> To:	<A HREF="mailto:admin@jos.org">admin@jos.org</A>
</I>&gt;<i> Cc:	Iain Shigeoka
</I>&gt;<i> Subject:	RE: [JOS-Admin] SWAT Team
</I>&gt;<i> 
</I>&gt;<i> Hi Ian
</I>&gt;<i> I am not familiar with the Wiki at all, but if it was set up so that a web
</I>&gt;<i> bot that is simply reading some of the ASCII parts of each file, triggers
</I>&gt;<i> executables, then that would have happened millions of times before, and
</I>&gt;<i> not suddenly started that day. I think you have to look a bit further.
</I>&gt;<i> 
</I>&gt;<i> I know, a good shoemaker goes barefoot, and we never have time for our own
</I>&gt;<i> tools until they break. However, something broke and just moving it to
</I>&gt;<i> another machine won't fix it.
</I>&gt;<i> 
</I>&gt;<i> Personally I think even replacing that old Perl search with a modern,
</I>&gt;<i> compiled searcher won't be a cure-all. That old search HAS worked OK until
</I>&gt;<i> the voting stuff was added. THAT''s the place where I would look for
</I>&gt;<i> missing brackets. 
</I>&gt;<i> 
</I>&gt;<i> What are the voting related scripts doing? Are they using the Wiki search
</I>&gt;<i> and leaving something open ? 
</I>&gt;<i> 
</I>&gt;<i> The only other times that I remember recurrent noticeable loads from JOS
</I>&gt;<i> they were Python related. They were not dangerously high, just nuisance
</I>&gt;<i> level. However, since that is definitely a weak spot, possibly a
</I>&gt;<i> combination of your voting scripts and whatever you do with Python drove
</I>&gt;<i> the quaint old searcher nuts. 
</I>&gt;<i> 
</I>&gt;<i> You have to look at what was new on that day. The web bots have cruised
</I>&gt;<i> the
</I>&gt;<i> site hundreds of times every day since long before Wiki was added. There
</I>&gt;<i> was no change in that. If they WERE involved in the meltdown, then you
</I>&gt;<i> have
</I>&gt;<i> to look at what could have suddenly, and for the first time on that day,
</I>&gt;<i> mis-interpreted their cataloguing as something else.
</I>&gt;<i> 
</I>&gt;<i> Re moving Wiki onto a different machine, I think that is either in
</I>&gt;<i> progress
</I>&gt;<i> or has been completed. Clark would know the details about that.
</I>&gt;<i> 
</I>&gt;<i> Helmut
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> At 03:22 AM 8/10/99 Tuesday , you wrote:
</I>&gt;<i> &gt;Hello,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;A breif accusation of myself as being the one at fault for the wiki
</I>&gt;<i> &gt;meltdown, an apology to helmut, and a whimpering defense of the wiki
</I>&gt;<i> &gt;itself...
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;--- Dear Webby &lt;<A HREF="mailto:DearWebby@webby.com">DearWebby@webby.com</A>&gt; wrote:
</I>&gt;<i> &gt;&gt; Hi Clark
</I>&gt;<i> &gt;&gt; At 10:00 AM 8/9/99 Monday , you wrote:
</I>&gt;<i> &gt;&gt; &gt;On Thu, 5 Aug 1999, Gilbert Carl Herschberger II
</I>&gt;<i> &gt;&gt; wrote:
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; At 07:43 AM 8/5/99 -0500, you wrote:
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;Helmut,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; No. A web-bot can not make cgi calls. A web bot only
</I>&gt;<i> 
</I>&gt;<i> &gt;&gt; READS.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;Actually the way some of the wiki scripts are setup, a web-bot can make
</I>&gt;<i> &gt;cgi calls and not know it...  And the scripts will continue to work...
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; Has anyone checked to make certain that
</I>&gt;<i> &gt;&gt; robots.txt is up-to-date? It should
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;It is not up to date.  This is my fault.  I added the search script and
</I>&gt;<i> &gt;forgot to update the robots.txt file. Doh.  So its more than possible
</I>&gt;<i> &gt;that the entire meltdown was due to this, and it was completely my
</I>&gt;<i> &gt;forgetfulness at fault.  My apologies, esp. to Helmut for bringing down
</I>&gt;<i> &gt;your server.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; 300 per hour ?????????????
</I>&gt;<i> &gt;&gt; Forget it. You can do that on your PC.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;Yup.  And with the brain dead search being used by wiki right now, this
</I>&gt;<i> &gt;would be more than enough to bring the server to its knees.  I knew
</I>&gt;<i> &gt;that the search was an extremely dangerous feature to add because it
</I>&gt;<i> &gt;was such an enourmous hog but hoped that the benefits would outweigh
</I>&gt;<i> &gt;the costs and I'd have time to fix it before it became a problem. 
</I>&gt;<i> &gt;Looks like I was wrong.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;Please do not blame Peter Thoeny.  Search was a feature I added with
</I>&gt;<i> &gt;the full knowledge that it could cause damage.  On his much smaller
</I>&gt;<i> &gt;wiki the solution is acceptable.  On ours, it is a weakness that I was
</I>&gt;<i> &gt;hoping we could live with until it could be patched.  I was wrong.  He
</I>&gt;<i> &gt;made sure I knew the risks so its all my fault.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; ...........  then maybe it is time you guys used
</I>&gt;<i> &gt;&gt; this occasion to do a
</I>&gt;<i> &gt;&gt; major overhaul on yours. 
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;Yes.  I'd would like to and the site needs it.  Unfortunately, I just
</I>&gt;<i> &gt;don't have the time to do it all at once.  So its patches here and
</I>&gt;<i> &gt;there as I have the time and energy.  Sorry but that's just the way it
</I>&gt;<i> &gt;is.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;Helmut, please accept my apologies for causing you problems.  Is there
</I>&gt;<i> &gt;any way you can put our site on a box all by ourselves so that if our
</I>&gt;<i> &gt;site bogs down, it won't take anyone else with us?  Otherwise, I cannot
</I>&gt;<i> &gt;guarantee that wiki won't do this again to you (in its present or
</I>&gt;<i> &gt;future forms).  
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;If you can't (which is very understandable), since we are highly
</I>&gt;<i> &gt;reliant on wiki, it will probably be in everyone's best interest if we
</I>&gt;<i> &gt;moved our site to an isolated box somewhere if we can find one.  
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;If you can, or if you're willing to trust us, please turn on all the
</I>&gt;<i> &gt;scripts except for the wiki search script.  I believe that the search
</I>&gt;<i> &gt;script is the culprit and disabling it, should eliminate similar future
</I>&gt;<i> &gt;problems.  The other scripts should not be causing a problem and are
</I>&gt;<i> &gt;vital to the operation of our site.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;In either case, please post your reply to the <A HREF="mailto:admin@jos.org">admin@jos.org</A> list so we
</I>&gt;<i> &gt;know your position. 
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;Thank you.
</I>&gt;<i> 
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;-iain shigeoka
</I>&gt;<i> &gt;_____________________________________________________________
</I>&gt;<i> &gt;Do You Yahoo!?
</I>&gt;<i> &gt;Bid and sell for free at <A HREF="http://auctions.yahoo.com">http://auctions.yahoo.com</A>
</I>&gt;<i> &gt; 
</I>&gt;<i> DearWebby
</I>&gt;<i> (Helmut)
</I>&gt;<i> 
</I>&gt;<i> The Cardmaster's MidSummer Madness World Championship is under way
</I>&gt;<i> You can now vote at
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://cards.webby.com">http://cards.webby.com</A>
</I>&gt;<i> --------------------------------------------------------------------------
</I>&gt;<i> --
</I>&gt;<i> ------
</I>&gt;<i> Webby, Inc  Web Marketing and high traffic web hosting
</I>&gt;<i> Internet postcards and other effective marketing software
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Admin maillist  -  <A HREF="mailto:Admin@jos.org">Admin@jos.org</A>
</I>&gt;<i> <A HREF="http://jos.org/mailman/listinfo/admin">http://jos.org/mailman/listinfo/admin</A>
</I>
</pre>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000134.html">[JOS-Admin] SWAT Team</A></li>
	<LI> Next message: <A HREF="000137.html">[JOS-Admin] wiki.jos.org &amp; some thoughts.</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#136">[ date ]</a>
              <a href="thread.html#136">[ thread ]</a>
              <a href="subject.html#136">[ subject ]</a>
              <a href="author.html#136">[ author ]</a>
         </LI>
       </UL>
</body></html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 FINAL//EN">
<HTML>
  <HEAD>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
    <TITLE>RegistryIteratorAndURL.Imported @ jos.sf.net</TITLE>
  </HEAD>

<BODY BGCOLOR="#FFFFFF">

<!-- The FORM encloses the entire header, because it renders better that way. !-->
<FORM ACTION="/jump.php"><input type="hidden" name="PHPSESSID" value="dc2723de36aa3494f3147a35f16efd88" />

<!-- The JOS logo. !-->
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR VALIGN="TOP" ALIGN="LEFT">
	<TD><A HREF="http://cjos.sourceforge.net/archive/"><IMG 
		VSPACE="0" HSPACE="0" ALIGN="MIDDLE" BORDER="0"
		SRC="http://cjos.sourceforge.net/archive/media/jos_logo_mini.gif"></A></TD>
	<!-- The tab table. !-->
	<TD WIDTH="100%" ALIGN="RIGHT" BGCOLOR="#FFFFFF" VALIGN="BOTTOM"> 
		<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%" ALIGN="RIGHT">
			<TR VALIGN="MIDDLE" ALIGN="LEFT">

<TD BGCOLOR="White" WIDTH="60%">&nbsp;</TD>
<TD BGCOLOR="#FFFFCC"><A HREF="http://cjos.sourceforge.net/archive/">Home</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/info/">Info</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/dev/">DevZone</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFCC66" ALIGN="CENTER"><A
HREF="http://jos.sourceforge.net/">Wiki</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
			</TR>
			<TR>
				<TD BGCOLOR="#FFCC66" ALIGN="RIGHT" COLSPAN="9">
					<A HREF="/view/Users/?PHPSESSID=dc2723de36aa3494f3147a35f16efd88">UsersWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Main/?PHPSESSID=dc2723de36aa3494f3147a35f16efd88">MainWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Info/?PHPSESSID=dc2723de36aa3494f3147a35f16efd88">InfoWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/DevZone/?PHPSESSID=dc2723de36aa3494f3147a35f16efd88">DevZoneWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Support/?PHPSESSID=dc2723de36aa3494f3147a35f16efd88">SupportWeb</A>
				</TD>
			</TR>
		</TABLE>
	</TD>		
</TR>
<!-- The WikiHeader. !-->
<TR><TD COLSPAN="2">
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="CENTER">
		<B>[&nbsp;<a href="/info//RegistryIteratorAndURL?PHPSESSID=dc2723de36aa3494f3147a35f16efd88">RegistryIteratorAndURL</a>&nbsp;]</B>
	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="CENTER">
		<B>[ not logged in ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="CENTER">
		<B>[ Web: <a href="/view/Imported/?PHPSESSID=dc2723de36aa3494f3147a35f16efd88">Imported</a> ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFCC66" VALIGN="CENTER">
		goto:&nbsp;<INPUT TYPE="TEXT" SIZE="10" NAME="topic"><!--<INPUT TYPE="IMAGE" SRC="/media/go.gif?PHPSESSID=dc2723de36aa3494f3147a35f16efd88" BORDER="0" VALUE="topic" ALT="goto">!-->&nbsp;<a href="/search.php?PHPSESSID=dc2723de36aa3494f3147a35f16efd88"><FONT SIZE="-1">options</FONT></a>
	</TD>
</TR>
</TABLE>

<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
	<TR>
	<TD ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="TOP">
		[&nbsp;get <a href="/info/Imported/RegistryIteratorAndURL?PHPSESSID=dc2723de36aa3494f3147a35f16efd88">info</a> on or <a href="/edit/Imported/RegistryIteratorAndURL?PHPSESSID=dc2723de36aa3494f3147a35f16efd88">edit</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="TOP">
		[&nbsp;<a href="/user.php?op=login&redirect=%2Fview%2F%2FRegistryIteratorAndURL&PHPSESSID=dc2723de36aa3494f3147a35f16efd88">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FRegistryIteratorAndURL&PHPSESSID=dc2723de36aa3494f3147a35f16efd88">new&nbsp;user</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="TOP">
		[&nbsp;list of <a href="/topics/Imported/?PHPSESSID=dc2723de36aa3494f3147a35f16efd88">topics</a>, <a href="/hubsnodes/Imported/?PHPSESSID=dc2723de36aa3494f3147a35f16efd88">hubs&nbsp;&amp;&nbsp;nodes</a>, or <a href="/changes/Imported/?PHPSESSID=dc2723de36aa3494f3147a35f16efd88">recent&nbsp;changes</a>&nbsp;]	</TD>
	</TR>
</TABLE>

<!-- From CommonHeader !-->
</TR></TD>
</TABLE>
</FORM>

<!-- start BODY page !-->
<P>
<FONT SIZE=-1><a href="/view.php?topic=RegistryPages&PHPSESSID=dc2723de36aa3494f3147a35f16efd88">RegistryPages</a><wikitopic RegistryPages /wikitopic></FONT>
<HR SIZE="1" NOSHADOW>
<EM>Article contributed by <a href="/view.php?topic=GilbertHerschberger&PHPSESSID=dc2723de36aa3494f3147a35f16efd88">GilbertHerschberger</a><wikitopic GilbertHerschberger /wikitopic> (7 July 1999).</EM>
<H4>Introduction</H4>
<P>I am beginning to see the light. There is a positive interaction between the <a href="/view.php?topic=RegistryIterator&PHPSESSID=dc2723de36aa3494f3147a35f16efd88">RegistryIterator</a><wikitopic RegistryIterator /wikitopic> and the <a href="/view.php?topic=RegistryURL&PHPSESSID=dc2723de36aa3494f3147a35f16efd88">RegistryURL</a><wikitopic RegistryURL /wikitopic>. How is this? And what does it mean?</P>
<H4>Example</H4>
<P>The registry iterator provides a way to select the "current" registry using a full registry URL. The registry <a href="/view.php?topic=URL&web=Imported&PHPSESSID=dc2723de36aa3494f3147a35f16efd88">URL</a> <wikitopic URL /wikitopic>recognises the pound sign (#) as separator between a resource identifier and content identifier. Consider the following <a href="/view.php?topic=URL&web=Imported&PHPSESSID=dc2723de36aa3494f3147a35f16efd88">URL</a> <wikitopic URL /wikitopic>and how it is resolve-able by a registry iterator:</P>
<PRE>
x-registry:file:/usr/local/example.xml#users/user/joe
</PRE>
<H4>Step One - Load a registry</H4>
<P>The registry iterator loads the top-level registry using all of the characters in a registry <a href="/view.php?topic=URL&web=Imported&PHPSESSID=dc2723de36aa3494f3147a35f16efd88">URL</a> <wikitopic URL /wikitopic>before the pound sign (#):
<PRE>
x-registry:file:/usr/local/example.xml
</PRE>
<P>The registry iterator saves the top-level registry as <CODE>ptop</CODE>.
<H4>Step Two - Traverse registry tree</H4>
<P>The registry iterator uses the content identifier to set the "current" registry, using resolveCurrent().
<PRE>
users/user/joe
</PRE>
<H4>Source</H4>
<P>The source code for the registry iterator constructor is something like this:
<PRE>
public class ExampleRegistryIterator {
  public ExampleRegistryIterator( String url ) {
	 int pos = url.indexOf( "#" );
	 if ( pos &lt; 0 ) {
		path = "";
	 else {
		path = url.substring( pos + 1 );
		url = url.substring( 0, pos );
	 }
	 ptop = RegistryFactory.getFactory().getRegistry( url );
	 resolveCurrent();
  }
:
  public void goto( String v ) {
	 if ( v.startsWith( "/" ) ) {
		path = v;
	 }
	 else {
		path = path + v;
	 }
	 resolveCurrent();
  }
  protected void resolveCurrent() {
	 String p = path;
	 pcurr = ptop;
	 if ( p.equals( "" ) ) {
		pcurr = ptop;
		return;
	 }
	 for (;;) {
		int pos = p.indexOf( "/" );
		if ( pos &lt; 0 ) {
		  pcurr = resolveName( p );
		  return;
		}
		pcurr = resolveName( p.substring( 0, pos ) );
		p = p.substring( pos + 1 );
	 }
  }
  private Registry resolveName( String n ) {
	 int pos = n.indexOf( "[" );
	 if ( pos &lt; 0 ) {
		return pcurr.getRegistry( n );
	 }

	 if ( !n.endsWith( "]" ) ) {
		// uh oh.
		return null;
	 }

	 String t = n.substring( pos + 1, n.length() - 1 );
	 n = n.substring( 0, pos );
	 int index;
	 try {		 
		index = Integer.parseInt( t.trim() );
	 }
	 catch( NumberFormatException e ) {
		// uh-oh.
		return null;
	 }

	 Registry[] list = pcurr.getRegistryArray( n );
	 return list[ index ];
  }
  private String path;
  private Registry ptop;
  private Registry pcurr;
}
</PRE>
<H4>What does it mean?</H4>
<P>It means that an application program doesn't have to keep track of the variables for intermediate registries; a registry iterator keeps track of the registry for you. An application program can go to any registry, by name, using just the registry iterator.</P>
<PRE>
  public void example() {
	 String url = "x-registry:set:file:/usr/local/example";
	 RegistryIterator r = new RegistryIterator( url );
	 r.goto( "users/user/joe" );
	 String v1 = r.getEntry( "browser" );
	 r.goto( "users/user/mike" );
	 String v2 = r.getEntry( "browser" );
	 System.out.println( v1.equals( v2 ) ? "same" : "different" );
  }
</PRE>
<H4>Singleton</H4>
<P>With a separate iterator object, it is possible for many iterators to have a different "current" position within a single registry. Multiple calls to <CODE>RegistryFactory.getRegistry()</CODE> for the same resource should return the same object.</P>
<H4>Easy</H4>
<P>With the registry iterator, it is easier to work with a registry as a document. A registry editor would benefit from the iterator design because it could use the iterator to go to any registry based on the full registry URL.</P>
<H4>Namespace</H4>
<P>Within a single registry, there is only one namespace. Both registry entries and registry nodes are part of one list. The following example illustrates how a registry entry would overwrite a registry node because entries and nodes occupy one namespace.
<PRE>
  public void example() {
	 Registry r = new BasicRegistry();
[1] r.setObject( "name", new BasicRegistry() );
[2] r.setObject( "name", "value" );
  }
</PRE>
<P>In the end, there is only one object called "name" within a registry. Statement 1 stores a registry. Statement 2 overwrites a registry with a string.</P>
<H4>Set?</H4>
<P>Where can I find the Set class? I looked in both <CODE>jos</CODE> and <CODE>org.jos</CODE> packages.</P>
<H4>Nodes vs. entries</CODE></H4>
<P>A registry node is a kind of registry entry. A registry node is an entry that's another registry. Nodes and entries are mutually exclusive. A key goes either with a registry, or not. For these enumerations, a key cannot be both a node and an entry. While <CODE>getChildNodes()</CODE> returns all keys for registry-type objects, <CODE>getChildEntries()</CODE> returns all keys for non-registry-type objects.</P>
<H4>Go to node</H4>
<P>Up until today, the registry iterator can only "go" to a registry node. When a registry array is fully supported, a registry iterator can "go" to a regisry within a registry array:
<PRE>
  public void example() {
	 Registry[] list = new Registry[ 3 ];
	 list[ 0 ] = new BasicRegistry();
	 list[ 1 ] = new BasicRegistry();
	 list[ 2 ] = new BasicRegistry();

	 String url = "x-registry:new:";
	 RegistryIterator r = new RegistryIterator( url );
	 r.setObject( "name", list );
	 r.goto( "name[2]" );
  }
</PRE>
<P>Why is it important to support both String[] and Registry[]? The order of items in an array are preserved. Because sometimes order is important and the registry doesn't support any kind of order. Keys, enumerated with <CODE>getKeys()</CODE>, are in no particular order.</P>
<H4>Order</H4>
<P>While registry entries participate in a single namespace, there is no support from a registry to keep registry entries in order. A name exists or not. No registry entry is <EM>before</EM> or <EM>after</EM> another. It is up to the implementation of the registry interface to decide how to keep the namespace unique. The order of keys returned in <CODE>getKeys()</CODE> may be completely different than the order in which objects are added to a registry.</P>
<P>For re-writing a registry to a file, keys are not going to be written in the order in which they are read.</P><BR><BR></P><!--

<TABLE width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="737b9c">
<TR><TD ALIGN="CENTER">
<a href="/user.php?op=login&redirect=%2Fview%2F%2FRegistryIteratorAndURL&PHPSESSID=dc2723de36aa3494f3147a35f16efd88">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FRegistryIteratorAndURL&PHPSESSID=dc2723de36aa3494f3147a35f16efd88">new&nbsp;user</a><TR><TD>
</TABLE>

!-->
<!-- end BODY page !-->

<HR>

<DIV ALIGN="CENTER">
<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR>
	<TD ALIGN="CENTER" COLSPAN="2">
		Content of these pages are owned and copyrighted by the poster.
	</TD>
</TR>
<TR>
	<TD ALIGN="RIGHT" WIDTH="50%">
		Hosted by:
	</TD>
	<TD ALIGN="LEFT">
		<A HREF="http://sourceforge.net/"><IMG 
			SRC="http://sourceforge.net/sflogo.php?group_id=2376&type=1"
			BORDER=0 HSPACE=0 VSPACE=0></A>
	</TD>
</TR>
</TABLE>
</DIV>
</BODY>
</HTML>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 FINAL//EN">
<HTML>
  <HEAD>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
    <TITLE>RegistryAlt.Imported @ jos.sf.net</TITLE>
  </HEAD>

<BODY BGCOLOR="#FFFFFF">

<!-- The FORM encloses the entire header, because it renders better that way. !-->
<FORM ACTION="/jump.php"><input type="hidden" name="PHPSESSID" value="dde9b581bb50dffa2e1383bcfdde618e" />

<!-- The JOS logo. !-->
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR VALIGN="TOP" ALIGN="LEFT">
	<TD><A HREF="http://cjos.sourceforge.net/archive/"><IMG 
		VSPACE="0" HSPACE="0" ALIGN="MIDDLE" BORDER="0"
		SRC="http://cjos.sourceforge.net/archive/media/jos_logo_mini.gif"></A></TD>
	<!-- The tab table. !-->
	<TD WIDTH="100%" ALIGN="RIGHT" BGCOLOR="#FFFFFF" VALIGN="BOTTOM"> 
		<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%" ALIGN="RIGHT">
			<TR VALIGN="MIDDLE" ALIGN="LEFT">

<TD BGCOLOR="White" WIDTH="60%">&nbsp;</TD>
<TD BGCOLOR="#FFFFCC"><A HREF="http://cjos.sourceforge.net/archive/">Home</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/info/">Info</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/dev/">DevZone</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFCC66" ALIGN="CENTER"><A
HREF="http://jos.sourceforge.net/">Wiki</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
			</TR>
			<TR>
				<TD BGCOLOR="#FFCC66" ALIGN="RIGHT" COLSPAN="9">
					<A HREF="/view/Users/?PHPSESSID=dde9b581bb50dffa2e1383bcfdde618e">UsersWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Main/?PHPSESSID=dde9b581bb50dffa2e1383bcfdde618e">MainWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Info/?PHPSESSID=dde9b581bb50dffa2e1383bcfdde618e">InfoWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/DevZone/?PHPSESSID=dde9b581bb50dffa2e1383bcfdde618e">DevZoneWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Support/?PHPSESSID=dde9b581bb50dffa2e1383bcfdde618e">SupportWeb</A>
				</TD>
			</TR>
		</TABLE>
	</TD>		
</TR>
<!-- The WikiHeader. !-->
<TR><TD COLSPAN="2">
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="CENTER">
		<B>[&nbsp;<a href="/info//RegistryAlt?PHPSESSID=dde9b581bb50dffa2e1383bcfdde618e">RegistryAlt</a>&nbsp;]</B>
	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="CENTER">
		<B>[ not logged in ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="CENTER">
		<B>[ Web: <a href="/view/Imported/?PHPSESSID=dde9b581bb50dffa2e1383bcfdde618e">Imported</a> ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFCC66" VALIGN="CENTER">
		goto:&nbsp;<INPUT TYPE="TEXT" SIZE="10" NAME="topic"><!--<INPUT TYPE="IMAGE" SRC="/media/go.gif?PHPSESSID=dde9b581bb50dffa2e1383bcfdde618e" BORDER="0" VALUE="topic" ALT="goto">!-->&nbsp;<a href="/search.php?PHPSESSID=dde9b581bb50dffa2e1383bcfdde618e"><FONT SIZE="-1">options</FONT></a>
	</TD>
</TR>
</TABLE>

<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
	<TR>
	<TD ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="TOP">
		[&nbsp;get <a href="/info/Imported/RegistryAlt?PHPSESSID=dde9b581bb50dffa2e1383bcfdde618e">info</a> on or <a href="/edit/Imported/RegistryAlt?PHPSESSID=dde9b581bb50dffa2e1383bcfdde618e">edit</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="TOP">
		[&nbsp;<a href="/user.php?op=login&redirect=%2Fview%2F%2FRegistryAlt&PHPSESSID=dde9b581bb50dffa2e1383bcfdde618e">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FRegistryAlt&PHPSESSID=dde9b581bb50dffa2e1383bcfdde618e">new&nbsp;user</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="TOP">
		[&nbsp;list of <a href="/topics/Imported/?PHPSESSID=dde9b581bb50dffa2e1383bcfdde618e">topics</a>, <a href="/hubsnodes/Imported/?PHPSESSID=dde9b581bb50dffa2e1383bcfdde618e">hubs&nbsp;&amp;&nbsp;nodes</a>, or <a href="/changes/Imported/?PHPSESSID=dde9b581bb50dffa2e1383bcfdde618e">recent&nbsp;changes</a>&nbsp;]	</TD>
	</TR>
</TABLE>

<!-- From CommonHeader !-->
</TR></TD>
</TABLE>
</FORM>

<!-- start BODY page !-->
<P>
<FONT SIZE=-1><a href="/view.php?topic=RegistryPages&PHPSESSID=dde9b581bb50dffa2e1383bcfdde618e">RegistryPages</a><wikitopic RegistryPages /wikitopic></FONT>
<HR SIZE=-1 NOSHADOW>
<EM>Article contributed by <a href="/view.php?topic=GilbertHerschberger&PHPSESSID=dde9b581bb50dffa2e1383bcfdde618e">GilbertHerschberger</a><wikitopic GilbertHerschberger /wikitopic> (6 July 1999).</EM>
<H4>Introduction</H4>
<P>After working with four registry <nolink>APIs, I have found that many registry implementations are possible. Here are a few of the more sophisticated registry implmentations that we should demonstrate.
<H4>Mostly string-based registry</H4>
<P>This registry might be the easiest. A full-blown generic registry seems possible. Along the lines of <a href="/view.php?topic=RegistryFromText&PHPSESSID=dde9b581bb50dffa2e1383bcfdde618e">RegistryFromText</a><wikitopic RegistryFromText /wikitopic>, it is possible to store most Java primatives as strings in a <nolink>Hashtable. I have already created a sample implementation of a registry called <nolink>StringRegistry.</P>
<TABLE WIDTH="100%" BORDER="1" CELLPADDING="6" BGCOLOR="#EFEFEF">
<TR>
<TD><STRONG>Java primative</STRONG></TD>
<TD><STRONG>Registry Storage</STRONG></TD>
</TR>
<TR>
<TD VALIGN="TOP">
<CODE>java.lang.String</CODE>
</TD>
<TD VALIGN="TOP">
<CODE>java.lang.String</CODE>
</TD>
</TR>
<TR>
<TD VALIGN="TOP">
<PRE>
boolean
byte
char
short
int
long
float
double
</PRE>
</TD>
<TD VALIGN="TOP">
<CODE>java.lang.String</CODE>
</TD>
</TR>
<TR>
<TD VALIGN="TOP">
<PRE>
boolean[]
byte[]
char[]
short[]
int[]
long[]
float[]
double[]
</PRE>
</TD>
<TD VALIGN="TOP">
<CODE>java.lang.String</CODE>
</TD>
</TR>
<TR>
<TD>
<CODE>registry.Registry</CODE>
</TD>
<TD>
<CODE>registry.Registry</CODE>
</TD>
</TR>
<TR>
<TD>
<CODE>java.lang.String[]</CODE>
</TD>
<TD>
<CODE>java.lang.String[]</CODE>
</TD>
</TR>
<TR>
<TD>
<CODE>registry.Registry[]</CODE>
</TD>
<TD>
<CODE>registry.Registry[]</CODE>
</TD>
</TR>
</TABLE>
<P>Since items are converted to strings as they are stored, the string-based registry doesn't preserve the original data type of many items. Items are converted to strings as they are stored; converted from strings as they are retrieved.</P>
<P>Future: If a string-based registry were combined with a "registry entry" object, the original data type could be preserved:
<PRE>
class RegistryEntry {
  RegistryEntry( String t, String v ) {
	 type = t;
	 value = v;
  }
  String getType() {
	 return type;
  }
  String getValue() {
	 return value;
  }
  private String type;
  private String value;
}
</PRE>
<H4>Generic registry</H4>
<P>A full-blown generic registry would not depend on a hash table; it would maintain its own custom entries like a hash table. The only kind of data stored in a registry hash table would be pairs of strings:
<PRE>
public class RegistryHashtable {
  RegistryHashtable() {
  }
  public String getValue( String key ) {
	 RegistryHashEntry e = getHashEntry( key );
	 return e.getValue();
  }
  public String getType( String key ) {
	 RegistryHashEntry e = getHashEntry( key );
	 return e.getType();
  }
  public void put( String key, String type, String value ) {
	 add( new RegistryHashEntry( key, type, value ) );
  }
  RegistryHashEntry[] list;
}
</PRE>
<P>Otherwise, <CODE>java.util.Hashtable</CODE> provides storage perfectly suited to the generic registry. It can store objects other than strings.</P>
<H4>Conversion</H4>
<P>A full-blown registry should provide automatic conversion from any type that is stored inside a registry to a specific type requested. There are rules for conversion. Some items cannot be converted; an accessor exception should be thrown.</P>
<P>In order to support conversion, a registry entry class could be created for each Java primative. This class would be specialized to convert from a specific type to any type requested.</P>
<P>Conversion also give us reason to use a registry entry object. All of the conversion classes would extend a registry entry super class. Only the methods of a super class are known to a registry. This provides all of the data just as a requestor wants it.</P>
<P>This is similar to the way the <CODE>java.sql.ResultSet</CODE> provides data from a record just as a requestor wants it.</P>
<H4>Copy data</H4>
<P>At critical points in a registry implementation, data should be copied. For example, these methods must make a copy of the given data:
<UL>
<LI><CODE>Registry.setRegistry()</CODE>,
<LI><CODE>Registry.setObject()</CODE>,
<LI><CODE>Registry.setBooleanArray()</CODE>,
<LI><CODE>Registry.setByteArray()</CODE>,
<LI><CODE>Registry.setCharArray()</CODE>,
<LI><CODE>Registry.setShortArray()</CODE>,
<LI><CODE>Registry.setIntArray()</CODE>,
<LI><CODE>Registry.setLongArray()</CODE>,
<LI><CODE>Registry.setFloatArray()</CODE>,
<LI><CODE>Registry.setDoubleArray()</CODE>,
<LI><CODE>Registry.setStringArray()</CODE>, and
<LI><CODE>Registry.setRegistryArray()</CODE>.
</UL>
<P>For <CODE>Registry.setRegistryArray()</CODE>, both the array and each registry in the array must be copied.</P>
<H4>Persistent registry</H4>
<P>In order for some implementations of a registry to support automatic saving when a registry has been modified, the registry change listener interface should be created:
<PRE>
public interface RegistryChangeListener {
  public void onRegistryChange( Registry v );
}
</PRE>
<P>When a parent registry wants to be notified when a child registry has changed, the parent creates a new child registry like this:
<PRE>
public class CustomRegistry
	 extends BaseRegistry
	 implements RegistryChangeListener {
  public CustomRegistry( String v ) {
	 url = v;
	 Registry r = 
		  RegistryFactory.getFactory().getRegistry( url );
	 if ( r != null ) {
		r.copyTo( this );
	 }
  }
  protected CustomRegistry( CustomRegistry p ) {
	 parent = p;
  }
  protected Registry createChildRegistry() {
	 return new CustomRegistry( this );
  }
  public void onRegistryChange( Registry v ) {
	 if ( v == null ) {
		return;
	 }
	 if ( parent != null ) {
		parent.onRegistryChange( this );
		return;
	 }
	 saveAs( url );
  }
  public void save() {
	 if ( parent != null ) {
		parent.onRegistryChange( this );
	 }
  }
  private String url = null;
  private CustomRegistry parent = null;
}
</PRE>
<P>When inside <CODE>onRegistryChange()</CODE>, a parent can verify that a registry object is still attached to its parent.</P>
<P>Every modifier method (setXXX()) must call the save() method to automatically save changes.</P>
<H4>Just the beginning...</H4>
<P>I can imagine there should be implementations of the registry <nolink>API which support Java serialization for all kinds of objects, distributed computing, and delayed-write persistence.</P>
<P>The strength of an <nolink>API is found in its ability to support all kinds of registry implementations. There are a couple of things that need to be refined.</P>
<UL>
<LI>The Type1RegistryHelper implements the getObject() and setObject() methods for a generic registry.
<LI>The Type2RegistryHelper implements the other getXXX() and setXXX() methods using the getObject() and setObject() methods.
<LI>The Type3RegistryHelper implements conversion methods for a string-based registry.
</UL>
<P>It might be better for some implementations of the registry to expose the registry entry as a standard interface. This would support full conversion to any requested type (if conversion is possible).</P>
<P>It might be better to pass a class name to the getObject() method, to request an object of a specific type.</P>
<P>The registry factory should have a default configuration. A default configuration would be used if no registry factory configuration is found. The default should be (as soon as possible) to load a set:, ini:, conf: and xml: registry controllers automatically.</P>
<P>The <nolink>StreamFactory deserves a package of its own.</P><BR><BR></P><!--

<TABLE width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="737b9c">
<TR><TD ALIGN="CENTER">
<a href="/user.php?op=login&redirect=%2Fview%2F%2FRegistryAlt&PHPSESSID=dde9b581bb50dffa2e1383bcfdde618e">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FRegistryAlt&PHPSESSID=dde9b581bb50dffa2e1383bcfdde618e">new&nbsp;user</a><TR><TD>
</TABLE>

!-->
<!-- end BODY page !-->

<HR>

<DIV ALIGN="CENTER">
<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR>
	<TD ALIGN="CENTER" COLSPAN="2">
		Content of these pages are owned and copyrighted by the poster.
	</TD>
</TR>
<TR>
	<TD ALIGN="RIGHT" WIDTH="50%">
		Hosted by:
	</TD>
	<TD ALIGN="LEFT">
		<A HREF="http://sourceforge.net/"><IMG 
			SRC="http://sourceforge.net/sflogo.php?group_id=2376&type=1"
			BORDER=0 HSPACE=0 VSPACE=0></A>
	</TD>
</TR>
</TABLE>
</DIV>
</BODY>
</HTML>

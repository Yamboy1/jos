<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 FINAL//EN">
<HTML>
  <HEAD>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
    <TITLE>RegistryCDROMExample.Imported @ jos.sf.net</TITLE>
  </HEAD>

<BODY BGCOLOR="#FFFFFF">

<!-- The FORM encloses the entire header, because it renders better that way. !-->
<FORM ACTION="/jump.php"><input type="hidden" name="PHPSESSID" value="abba588ff97df83c5cb752a83f68bcb1" />

<!-- The JOS logo. !-->
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR VALIGN="TOP" ALIGN="LEFT">
	<TD><A HREF="http://cjos.sourceforge.net/archive/"><IMG 
		VSPACE="0" HSPACE="0" ALIGN="MIDDLE" BORDER="0"
		SRC="http://cjos.sourceforge.net/archive/media/jos_logo_mini.gif"></A></TD>
	<!-- The tab table. !-->
	<TD WIDTH="100%" ALIGN="RIGHT" BGCOLOR="#FFFFFF" VALIGN="BOTTOM"> 
		<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%" ALIGN="RIGHT">
			<TR VALIGN="MIDDLE" ALIGN="LEFT">

<TD BGCOLOR="White" WIDTH="60%">&nbsp;</TD>
<TD BGCOLOR="#FFFFCC"><A HREF="http://cjos.sourceforge.net/archive/">Home</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/info/">Info</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/dev/">DevZone</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFCC66" ALIGN="CENTER"><A
HREF="http://jos.sourceforge.net/">Wiki</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
			</TR>
			<TR>
				<TD BGCOLOR="#FFCC66" ALIGN="RIGHT" COLSPAN="9">
					<A HREF="/view/Users/?PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">UsersWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Main/?PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">MainWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Info/?PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">InfoWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/DevZone/?PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">DevZoneWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Support/?PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">SupportWeb</A>
				</TD>
			</TR>
		</TABLE>
	</TD>		
</TR>
<!-- The WikiHeader. !-->
<TR><TD COLSPAN="2">
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="CENTER">
		<B>[&nbsp;<a href="/info//RegistryCDROMExample?PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">RegistryCDROMExample</a>&nbsp;]</B>
	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="CENTER">
		<B>[ not logged in ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="CENTER">
		<B>[ Web: <a href="/view/Imported/?PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">Imported</a> ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFCC66" VALIGN="CENTER">
		goto:&nbsp;<INPUT TYPE="TEXT" SIZE="10" NAME="topic"><!--<INPUT TYPE="IMAGE" SRC="/media/go.gif?PHPSESSID=abba588ff97df83c5cb752a83f68bcb1" BORDER="0" VALUE="topic" ALT="goto">!-->&nbsp;<a href="/search.php?PHPSESSID=abba588ff97df83c5cb752a83f68bcb1"><FONT SIZE="-1">options</FONT></a>
	</TD>
</TR>
</TABLE>

<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
	<TR>
	<TD ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="TOP">
		[&nbsp;get <a href="/info/Imported/RegistryCDROMExample?PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">info</a> on or <a href="/edit/Imported/RegistryCDROMExample?PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">edit</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="TOP">
		[&nbsp;<a href="/user.php?op=login&redirect=%2Fview%2F%2FRegistryCDROMExample&PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FRegistryCDROMExample&PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">new&nbsp;user</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="TOP">
		[&nbsp;list of <a href="/topics/Imported/?PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">topics</a>, <a href="/hubsnodes/Imported/?PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">hubs&nbsp;&amp;&nbsp;nodes</a>, or <a href="/changes/Imported/?PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">recent&nbsp;changes</a>&nbsp;]	</TD>
	</TR>
</TABLE>

<!-- From CommonHeader !-->
</TR></TD>
</TABLE>
</FORM>

<!-- start BODY page !-->
<P>
<FONT SIZE=-1><a href="/view.php?topic=RegistryPages&PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">RegistryPages</a><wikitopic RegistryPages /wikitopic></FONT>
<HR SIZE=1 NOSHADOW>
<EM>Article contributed by <a href="/view.php?topic=GilbertHerschberger&PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">GilbertHerschberger</a><wikitopic GilbertHerschberger /wikitopic> (20 June 1999).</EM>
<H4>Introduction</H4>
<P>The tale of the two registry <nolink>APIs can be told by the example of the network CD-ROM drive.</P>
<H4>Just an example</H4>
<P>Remember that this is just an example. You must be in physical proximity to a CD-ROM drive in order to use it properly. Reasonable people wouldn't spend thousands of dollars on this, would they? Imagine trying to centralize the function of a CD-ROM drive in order to save $50 per machine! As a practical matter, you must physically insert a CD-ROM into the drive to get it to work. What about performance? Could you sustain a 10X CD-ROM drive across a 10 Mbps network connection?
<H4>Scenario</H4>
<P>How many CD-ROM drives do you really need? Imagine that I have four computers at home, called machine A, B, C and D. All four computers are connected through a TCP/IP network.</P>
<P>It is possible to install one CD-ROM drive on machine A, and use the CD-ROM drive from machines B, C, and D.</P>
<H4>Machine A</H4>
<P>Starting at the beginning, I physically install my new CD-ROM drive in machine A. In this scenario, it doesn't matter if its EIDE, SCSI, or USB. In any case, I need a software driver that corresponds to the physical CD-ROM drive. I install the driver (and test it) on machine A.</P>
<P>What kind of registry does the CD-ROM driver need? It needs a data store. During installation, it may discover that the CD-ROM drive is physically connected to second master EIDE, the interrupt, I/O address and <a href="/view.php?topic=DMA&web=Imported&PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">DMA</a> <wikitopic DMA /wikitopic>channel (all that stuff). An install program must create a registry so that the software driver "knows" how to find the CD-ROM drive.</P>
<P>The only machine that needs to care about this stuff is machine A. This registry data shouldn't be a concern of machines B, C and D.</P>
<P>The only program that needs to care about this stuff is the CD-ROM driver. These settings should not be a concern of the video driver, keyboard driver, or any other software.</P>
<H4>Object store</H4>
<P>Once the CD-ROM driver is configured, here is what should happen.
<UL>
<LI>All machines are off.
<LI>I turn on machines B, C and D. At this point, they will not find any referece to machine A in their network-wide object store.
<LI>I turn on machine A. During boot, eventually <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">JOS</a> <wikitopic JOS /wikitopic>loads the CD-ROM driver. The CD-ROM driver loads its own configuration. If everything goes well, the CD-ROM driver can command the CD-ROM drive. At the last minute, <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">JOS</a> <wikitopic JOS /wikitopic>inserts the fully functioning CD-ROM driver into its system-wide object store. At this point, machine A can use the CD-ROM drive.
<LI>Continuing the boot sequence, <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">JOS</a> <wikitopic JOS /wikitopic>eventually loads network drivers and loads the network-wide object store service. At this point, machines B, C, and D can "see" machine A across the network.
<LI>If I have configured the CD-ROM drive for machine A to be shared, machines B, C, and D can get the CD-ROM driver (proxy) out of their own object store.
<LI>Running for a while...
<LI>When I shut down <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">JOS</a> <wikitopic JOS /wikitopic>on machine A, <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">JOS</a> <wikitopic JOS /wikitopic>shuts down the network-wide object store service. Machine A disappears from the object store of machines B, C and D.
<LI>As <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">JOS</a> <wikitopic JOS /wikitopic>continues to shut down, the CD-ROM driver is shut down, too. First, <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">JOS</a> <wikitopic JOS /wikitopic>removes the driver from the system-wide object store and then asks the driver (politely) to turn itself off with something like shutdown(). <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">JOS</a> <wikitopic JOS /wikitopic>then insists the driver to turn itself off with something like kill().
</UL>
<H4>Tale of two registries</H4>
<P>We need a data store. Because the CD-ROM driver and only the CD-ROM driver could possibly be interested in its specific configuration, its configuration should be stored in a separate, self-contained, read-only, transient registry. The driver shouldn't change its own configuration.</P>
<P>We also need an object store. <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">JOS</a> <wikitopic JOS /wikitopic>needs to keep track of which interrupts and <a href="/view.php?topic=DMA&web=Imported&PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">DMA</a> <wikitopic DMA /wikitopic>channels have been used. At boot time and only at boot time, <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">JOS</a> <wikitopic JOS /wikitopic>must prevent more than one driver from using an interrupt. When a driver wants to connect itself to an interrupt, it must use the <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">JOS</a> <wikitopic JOS /wikitopic>driver <nolink>API to do so. If it registers itself with an interrupt that has already been used, an exception is thrown.</P>
<H4>Things in common</H4>
<P>All registry <nolink>APIs should share the same general syntax for <nolink>URLs and <nolink>URIs.</P>
<P>It doesn't mean that type 1 and type 2 registries are incompatible. Since the type 2 registry has getObject() and setObject() methods, a type 2 registry can get and set objects using a type 1 registry. A type 1 registry can expose a type 2 registry interface.</P>
<P>As long as a type 1 registry is an abstract base class and not an interface, a type 2 registry cannot directly expose a type 1 registry interface.</P>
<P>While bridges are expected, your choice of a type 1 or 2 registry depends on what you want to do. If you want to store active objects, use an object store. If you want to save all kinds of configuration data using a consistent interface, use a data store.</P><BR><BR></P><!--

<TABLE width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="737b9c">
<TR><TD ALIGN="CENTER">
<a href="/user.php?op=login&redirect=%2Fview%2F%2FRegistryCDROMExample&PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FRegistryCDROMExample&PHPSESSID=abba588ff97df83c5cb752a83f68bcb1">new&nbsp;user</a><TR><TD>
</TABLE>

!-->
<!-- end BODY page !-->

<HR>

<DIV ALIGN="CENTER">
<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR>
	<TD ALIGN="CENTER" COLSPAN="2">
		Content of these pages are owned and copyrighted by the poster.
	</TD>
</TR>
<TR>
	<TD ALIGN="RIGHT" WIDTH="50%">
		Hosted by:
	</TD>
	<TD ALIGN="LEFT">
		<A HREF="http://sourceforge.net/"><IMG 
			SRC="http://sourceforge.net/sflogo.php?group_id=2376&type=1"
			BORDER=0 HSPACE=0 VSPACE=0></A>
	</TD>
</TR>
</TABLE>
</DIV>
</BODY>
</HTML>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 FINAL//EN">
<HTML>
  <HEAD>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
    <TITLE>RegistryAndReflection.Imported @ jos.sf.net</TITLE>
  </HEAD>

<BODY BGCOLOR="#FFFFFF">

<!-- The FORM encloses the entire header, because it renders better that way. !-->
<FORM ACTION="/jump.php"><input type="hidden" name="PHPSESSID" value="ca26197e3557371ae1b810317b8e7d3c" />

<!-- The JOS logo. !-->
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR VALIGN="TOP" ALIGN="LEFT">
	<TD><A HREF="http://cjos.sourceforge.net/archive/"><IMG 
		VSPACE="0" HSPACE="0" ALIGN="MIDDLE" BORDER="0"
		SRC="http://cjos.sourceforge.net/archive/media/jos_logo_mini.gif"></A></TD>
	<!-- The tab table. !-->
	<TD WIDTH="100%" ALIGN="RIGHT" BGCOLOR="#FFFFFF" VALIGN="BOTTOM"> 
		<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%" ALIGN="RIGHT">
			<TR VALIGN="MIDDLE" ALIGN="LEFT">

<TD BGCOLOR="White" WIDTH="60%">&nbsp;</TD>
<TD BGCOLOR="#FFFFCC"><A HREF="http://cjos.sourceforge.net/archive/">Home</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/info/">Info</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/dev/">DevZone</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFCC66" ALIGN="CENTER"><A
HREF="http://jos.sourceforge.net/">Wiki</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
			</TR>
			<TR>
				<TD BGCOLOR="#FFCC66" ALIGN="RIGHT" COLSPAN="9">
					<A HREF="/view/Users/?PHPSESSID=ca26197e3557371ae1b810317b8e7d3c">UsersWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Main/?PHPSESSID=ca26197e3557371ae1b810317b8e7d3c">MainWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Info/?PHPSESSID=ca26197e3557371ae1b810317b8e7d3c">InfoWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/DevZone/?PHPSESSID=ca26197e3557371ae1b810317b8e7d3c">DevZoneWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Support/?PHPSESSID=ca26197e3557371ae1b810317b8e7d3c">SupportWeb</A>
				</TD>
			</TR>
		</TABLE>
	</TD>		
</TR>
<!-- The WikiHeader. !-->
<TR><TD COLSPAN="2">
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="CENTER">
		<B>[&nbsp;<a href="/info//RegistryAndReflection?PHPSESSID=ca26197e3557371ae1b810317b8e7d3c">RegistryAndReflection</a>&nbsp;]</B>
	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="CENTER">
		<B>[ not logged in ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="CENTER">
		<B>[ Web: <a href="/view/Imported/?PHPSESSID=ca26197e3557371ae1b810317b8e7d3c">Imported</a> ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFCC66" VALIGN="CENTER">
		goto:&nbsp;<INPUT TYPE="TEXT" SIZE="10" NAME="topic"><!--<INPUT TYPE="IMAGE" SRC="/media/go.gif?PHPSESSID=ca26197e3557371ae1b810317b8e7d3c" BORDER="0" VALUE="topic" ALT="goto">!-->&nbsp;<a href="/search.php?PHPSESSID=ca26197e3557371ae1b810317b8e7d3c"><FONT SIZE="-1">options</FONT></a>
	</TD>
</TR>
</TABLE>

<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
	<TR>
	<TD ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="TOP">
		[&nbsp;get <a href="/info/Imported/RegistryAndReflection?PHPSESSID=ca26197e3557371ae1b810317b8e7d3c">info</a> on or <a href="/edit/Imported/RegistryAndReflection?PHPSESSID=ca26197e3557371ae1b810317b8e7d3c">edit</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="TOP">
		[&nbsp;<a href="/user.php?op=login&redirect=%2Fview%2F%2FRegistryAndReflection&PHPSESSID=ca26197e3557371ae1b810317b8e7d3c">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FRegistryAndReflection&PHPSESSID=ca26197e3557371ae1b810317b8e7d3c">new&nbsp;user</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="TOP">
		[&nbsp;list of <a href="/topics/Imported/?PHPSESSID=ca26197e3557371ae1b810317b8e7d3c">topics</a>, <a href="/hubsnodes/Imported/?PHPSESSID=ca26197e3557371ae1b810317b8e7d3c">hubs&nbsp;&amp;&nbsp;nodes</a>, or <a href="/changes/Imported/?PHPSESSID=ca26197e3557371ae1b810317b8e7d3c">recent&nbsp;changes</a>&nbsp;]	</TD>
	</TR>
</TABLE>

<!-- From CommonHeader !-->
</TR></TD>
</TABLE>
</FORM>

<!-- start BODY page !-->
<P>
<FONT SIZE=-1><a href="/view.php?topic=RegistryPages&PHPSESSID=ca26197e3557371ae1b810317b8e7d3c">RegistryPages</a><wikitopic RegistryPages /wikitopic></FONT>
<HR SIZE="1" NOSHADOW>
<EM>Article contributed by <a href="/view.php?topic=GilbertHerschberger&PHPSESSID=ca26197e3557371ae1b810317b8e7d3c">GilbertHerschberger</a><wikitopic GilbertHerschberger /wikitopic> (16 Jul 1999)</EM>
<H4>Introduction</H4>
<P>The <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=ca26197e3557371ae1b810317b8e7d3c">JOS</a> <wikitopic JOS /wikitopic>project gives me an opportunity to do again what I have always done. It gives me an opportunity to do things I've never done before. It gives me an opportunity to do it right this time. Working on the registry <nolink>API has stretched my imagination. Most of this territory is both familiar and fresh.</P>
<P>The need for a registry is familiar. I have worked with registries from the over-simplified to arbitrarily complex. I just wanted a data store for the configuration kind of data. What sounds simpler than that?</P>
<P>Rethinking the registry <nolink>API from the viewpoint of a Java programmer makes it fresh. There are things in the registry <nolink>API that are ambitious. Don't try this in C/C++. Inside the Java environment, we are free to experiment. We can afford to try and try again. We'll get it right eventually.</P>
<H4>New territory</H4>
<P>It is the potential of the registry <nolink>API that encourage me to keep on working. There are a few things in the design that convinces me that we are on the right path.</P>
<UL>
<LI>Because the registry factory is a smart factory, it is possible to load registries based on different implementations of the well-known registry interface. Some of my own implementations are better than others. All have strengths and weaknesses. I have a choice. The smart factory enables me to run many implementations side by side. I can compare their performance. I can see how well they run.</P>
<LI>Because the registry factory creates an input stream, it is possible to load and save registries to a wide variety of different file formats. All have strengths and weaknesses. I can choose what is best for me and my application.</P>
<LI>I recently figured out that the registry iterator must extend the registry node interface. A registry iterator is a kind of registry wrapper, too. Because it is a kind of registry, the registry iterator can be used to <EM>merge</EM> registries without complexity. You set the current path of your registry iterator and pass it to the registry input stream. The contents of a registry file are inserted into an existing registry, anywhere.
<LI>And then, I started thinking about using reflection to provide a registry interface for all Java objects. I can't believe the elegance of this approach.
</UL>
<H4>Reflection registry</H4>
<P>When the reflection <nolink>API is available to you, you can use a generic reflection registry to get and set the properties of any Java object.</P>
<TABLE WIDTH="100%" BGCOLOR="#EFEFEF">
<TR>
<TD>
<PRE>
public class ReflectionRegistry
	 implements RegistryNode {
  public ReflectionRegistry( Object v ) {
	 object = v;
  }
  public Object getObject( String key ) {
  [1]
  }
  public Object setObject( String key, Object v ) {
  [2]
  }
  public Enumeration getKeys() {
  [3]
  }
  private Object object;
}
</PRE>
</TD>
</TR>
<TR>
<TD BGCOLOR="#FFFFFF">
<OL>
<LI>Inside <CODE>getObject()</CODE>, key is exchanged for a method (either getXXX() or isXXX()). The reflection <nolink>API invokes the method. The return value is adjusted to return an Object.</P>
<P>Even methods with additional parameters may be support-able with additional key syntax, like <EM>name</EM>[<EM>index</EM>].
<LI>Inside <CODE>setObject()</CODE>, key is exchanged for a method (setXXX()). An object (v) is adjusted to pass a parameter to a method. The reflection <nolink>API invokes the method.</P>
<P>Even methods with additional parameters may be support-able with additional key syntax, like <EM>name</EM>[<EM>index</EM>].
<LI>The reflection <nolink>API is used to find any keys. Keys might be cached by this class. Each isXXX(), getXXX() and setXXX() method are tested for compatibility with getObject() and setObject().</P>
</OL>
</TD>
</TR>
</TABLE>
<H4>Store properties</H4>
<P>Combining the registry <nolink>API with reflection enables us to store compatible properties of any object in a registry. The properties of an object are passed through a well-known registry interface.</P>
<H4>Configuration objects</H4>
<P>This combination also enables the conversion of a generic registry to an application-specific configuration object. These light-weight objects are more like structures in C/C++.</P>
<PRE>
public class Configuration {
  public Configuration() {
  }

  public String getForegroundColor() {
	 return foregroundColor;
  }
  public void setForegroundColor( String v ) {
	 foregroundColor = v;
  }
  private String foregroundColor;

  public String getBackgroundColor() {
	 return backgroundColor;
  }
  public void setBackgroundColor( String v ) {
	 backgroundColor = v;
  }
  private String backgroundColor;
:
}
</PRE>
<H4>Loading</H4>
<P>A configuration object can be loaded, like this:
<PRE>
  public void loadConf() {
	 String url = "x-registry:file:/usr/local/example";
	 Registry r = new ReflectionRegistry( conf );
	 RegistryFactory.getFactory().getRegistry( url, r );
  }
  private Configuration conf;
</PRE>
<H4>Saving</H4>
<P>A configuration object can be saved, like this:
<PRE>
  public void saveConf() {
	 String url = "x-registry:file:/usr/local/example";
	 Registry r = new ReflectionRegistry( conf );
	 r.saveAs( url );
  }
  private Configurtation conf;
</PRE>
<A NAME="persistence">
<H4>About persistence</H4>
<P>The registry <nolink>API provides a persistent data store. It stores all of the properties of an object. It is easier to maintain compatibility between different versions of an object through the registry, because there will be a standard registry editor.</P>
<P>None of my implementations use serialization (yet). The registry <nolink>API does not you to use a stream model for persistence. A registry output stream is more flexible than an <CODE>java.io.ObjectOutputStream</CODE>. A registry input stream is more flexible than <CODE>java.io.ObjectInputStream</CODE>. Both the smart factory and a data store make it flexible.<BR><BR></P><!--

<TABLE width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="737b9c">
<TR><TD ALIGN="CENTER">
<a href="/user.php?op=login&redirect=%2Fview%2F%2FRegistryAndReflection&PHPSESSID=ca26197e3557371ae1b810317b8e7d3c">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FRegistryAndReflection&PHPSESSID=ca26197e3557371ae1b810317b8e7d3c">new&nbsp;user</a><TR><TD>
</TABLE>

!-->
<!-- end BODY page !-->

<HR>

<DIV ALIGN="CENTER">
<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR>
	<TD ALIGN="CENTER" COLSPAN="2">
		Content of these pages are owned and copyrighted by the poster.
	</TD>
</TR>
<TR>
	<TD ALIGN="RIGHT" WIDTH="50%">
		Hosted by:
	</TD>
	<TD ALIGN="LEFT">
		<A HREF="http://sourceforge.net/"><IMG 
			SRC="http://sourceforge.net/sflogo.php?group_id=2376&type=1"
			BORDER=0 HSPACE=0 VSPACE=0></A>
	</TD>
</TR>
</TABLE>
</DIV>
</BODY>
</HTML>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 FINAL//EN">
<HTML>
  <HEAD>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
    <TITLE>MemoryConsumption.Main @ jos.sf.net</TITLE>
  </HEAD>

<BODY BGCOLOR="#FFFFFF">

<!-- The FORM encloses the entire header, because it renders better that way. !-->
<FORM ACTION="/jump.php"><input type="hidden" name="PHPSESSID" value="8a1dec1eec33fffd590d791c2a9e658c" />

<!-- The JOS logo. !-->
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR VALIGN="TOP" ALIGN="LEFT">
	<TD><A HREF="http://cjos.sourceforge.net/archive/"><IMG 
		VSPACE="0" HSPACE="0" ALIGN="MIDDLE" BORDER="0"
		SRC="http://cjos.sourceforge.net/archive/media/jos_logo_mini.gif"></A></TD>
	<!-- The tab table. !-->
	<TD WIDTH="100%" ALIGN="RIGHT" BGCOLOR="#FFFFFF" VALIGN="BOTTOM"> 
		<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%" ALIGN="RIGHT">
			<TR VALIGN="MIDDLE" ALIGN="LEFT">

<TD BGCOLOR="White" WIDTH="60%">&nbsp;</TD>
<TD BGCOLOR="#FFFFCC"><A HREF="http://cjos.sourceforge.net/archive/">Home</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/info/">Info</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/dev/">DevZone</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFCC66" ALIGN="CENTER"><A
HREF="http://jos.sourceforge.net/">Wiki</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
			</TR>
			<TR>
				<TD BGCOLOR="#FFCC66" ALIGN="RIGHT" COLSPAN="9">
					<A HREF="/view/Users/?PHPSESSID=8a1dec1eec33fffd590d791c2a9e658c">UsersWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Main/?PHPSESSID=8a1dec1eec33fffd590d791c2a9e658c">MainWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Info/?PHPSESSID=8a1dec1eec33fffd590d791c2a9e658c">InfoWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/DevZone/?PHPSESSID=8a1dec1eec33fffd590d791c2a9e658c">DevZoneWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Support/?PHPSESSID=8a1dec1eec33fffd590d791c2a9e658c">SupportWeb</A>
				</TD>
			</TR>
		</TABLE>
	</TD>		
</TR>
<!-- The WikiHeader. !-->
<TR><TD COLSPAN="2">
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="CENTER">
		<B>[&nbsp;<a href="/info//MemoryConsumption?PHPSESSID=8a1dec1eec33fffd590d791c2a9e658c">MemoryConsumption</a>&nbsp;]</B>
	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="CENTER">
		<B>[ not logged in ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="CENTER">
		<B>[ Web: <a href="/view/Main/?PHPSESSID=8a1dec1eec33fffd590d791c2a9e658c">Main</a> ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFCC66" VALIGN="CENTER">
		goto:&nbsp;<INPUT TYPE="TEXT" SIZE="10" NAME="topic"><!--<INPUT TYPE="IMAGE" SRC="/media/go.gif?PHPSESSID=8a1dec1eec33fffd590d791c2a9e658c" BORDER="0" VALUE="topic" ALT="goto">!-->&nbsp;<a href="/search.php?PHPSESSID=8a1dec1eec33fffd590d791c2a9e658c"><FONT SIZE="-1">options</FONT></a>
	</TD>
</TR>
</TABLE>

<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
	<TR>
	<TD ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="TOP">
		[&nbsp;get <a href="/info/Main/MemoryConsumption?PHPSESSID=8a1dec1eec33fffd590d791c2a9e658c">info</a> on or <a href="/edit/Main/MemoryConsumption?PHPSESSID=8a1dec1eec33fffd590d791c2a9e658c">edit</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="TOP">
		[&nbsp;<a href="/user.php?op=login&redirect=%2Fview%2F%2FMemoryConsumption&PHPSESSID=8a1dec1eec33fffd590d791c2a9e658c">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FMemoryConsumption&PHPSESSID=8a1dec1eec33fffd590d791c2a9e658c">new&nbsp;user</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="TOP">
		[&nbsp;list of <a href="/topics/Main/?PHPSESSID=8a1dec1eec33fffd590d791c2a9e658c">topics</a>, <a href="/hubsnodes/Main/?PHPSESSID=8a1dec1eec33fffd590d791c2a9e658c">hubs&nbsp;&amp;&nbsp;nodes</a>, or <a href="/changes/Main/?PHPSESSID=8a1dec1eec33fffd590d791c2a9e658c">recent&nbsp;changes</a>&nbsp;]	</TD>
	</TR>
</TABLE>

<!-- From CommonHeader !-->
</TR></TD>
</TABLE>
</FORM>

<!-- start BODY page !-->
<P>
<a href="/view.php?topic=IndexPages&PHPSESSID=8a1dec1eec33fffd590d791c2a9e658c">IndexPages</a><wikitopic IndexPages /wikitopic>
<HR>
<EM>Article contributed by <a href="/view.php?topic=GilbertHerschberger&PHPSESSID=8a1dec1eec33fffd590d791c2a9e658c">GilbertHerschberger</a><wikitopic GilbertHerschberger /wikitopic> (updated 19 July 2001).</EM>
<H4>Introduction</H4>
Random access memory (RAM) is a limited resource. Without it, a computer is pretty much useless. My personal computer runs out of <a href="/view.php?topic=RAM&web=Main&PHPSESSID=8a1dec1eec33fffd590d791c2a9e658c">RAM</a> <wikitopic RAM /wikitopic>within a few minutes after starting the operating system. What happens when a computer runs out of <nolink>RAM? <a href="/view.php?topic=VirtualMemory&PHPSESSID=8a1dec1eec33fffd590d791c2a9e658c">VirtualMemory</a><wikitopic VirtualMemory /wikitopic> takes over.
</P><P>
A virtual memory manager extends <nolink>RAM by using disk space. Even virtual memory is a limited resource. I only have a few MB of space on my swap partition. What happens when a computer runs out of virtual memory? What happens next is up to your operating system. It might lock up. It might spontaneously reboot. It might shutdown gracefully. With no more virtual memory, a computer is pretty much useless.
</P><P>
While running a <a href="/view.php?topic=JVM&web=Main&PHPSESSID=8a1dec1eec33fffd590d791c2a9e658c">JVM</a> <wikitopic JVM /wikitopic>as a separate process on a foreign operating system is good, memory consumption is a problem for a foreign operating system. Running multiple copies of a <nolink>JVM on a foreign operating system is a waste of virtual memory.
</P><P>
When bytecode is loaded in a <nolink>JVM, it is used as if it is read-only. Since it is allocated by the foreign operating system, it is marked as read-write, not read-only. It must be loaded into real <nolink>RAM to be used. The foreign OS doesn't know any better. It must write out the bytecode to disk just in case it changes. While the <nolink>JVM "knows" that bytecode can't change, a foreign OS doesn't.
</P><P>
Bytecode for system classes are not expected to change during the lifetime of the JVM. The class loader is supposed to cache the classes so that static fields are static. When developing a Java program, it is possible to compile a new class file while the <nolink>JVM continues to use a copy of the old one.
<UL> <LI> I have to close my browser and open it again to see a re-compiled applet.
<LI> I have to close my <a href="/view.php?topic=JRE&web=Main&PHPSESSID=8a1dec1eec33fffd590d791c2a9e658c">JRE</a> <wikitopic JRE /wikitopic>and start it again to see a re-compiled Java application.
</UL> How is a Java-based operating system going to handle virtual memory? With a virtual memory manager. An exclusively-Java operating system has an edge over all others because all Java objects are more uniformly allocated and garbage collected. Access to objects in Java is already indirect through a reference.
</P><P>
The virtual memory manager must be able to deal with both read-only and read-write blocks. A code block doesn't have to be written to disk when it is swapped out. The memory manager can load it directly from an executable file. Takes less space and less time.
</P><P>
How is a Java-based operating system going to load bytecode? An exclusively-Java operating system has an edge over all others. It can load bytecode for system classes as read-only. It never writes bytecode to disk when it needs more real RAM. It throws the bytecode away. It can read it from disk again because the original is read-only.
</P><P>
Memory for static fields are read-write.
</P><P>
And what about a swap partition? Like Linux, an OS should have a separate swap partition that cannot possibly compete with custom processes. The OS should keep a few MB of virtual memory free all the time so that, when it "runs out of usable memory", it actually has enough left to display a kill process dialog box. It should ask me which process I want to kill. Something like that.
</P><P>
I would like to see a Java-based operating system support read-only package files, like this:
<UL> <LI> <CODE>Package-org.jos.util</CODE>
<LI> <CODE>Package-org.jos.core</CODE>
<LI> <CODE>Package-java.lang</CODE>
<LI> <CODE>Package-java.lang.reflection</CODE>
<LI> <CODE>Package-java.io</CODE>
<LI> <CODE>Package-java.net</CODE>
</UL> The bytecode is organized inside each package file, like this:
<UL> <LI> PACKAGE=java.lang
<UL> <LI> NAME=java.lang.Short VALUE=..bytecode..
<LI> NAME=java.lang.Integer VALUE=..bytecode..
<LI> :
<LI> NAME=java.lang.String VALUE=..bytecode..
</UL> </UL> <H4>Exclusively Java</H4>
When you think about using Java bytecode exclusively, it changes a few of the ground rules for operating your computer. This platform has the potential to be far less complex than any other. The bytecode processor provides a uniform model for all of the processes, everywhere.
<UL> <LI> Parts of the kernel are executable Java bytecodes.
<LI> Device drivers are executable Java bytecodes.
<LI> OS utilities are executable Java bytecodes.
<LI> Major application suites are executable Java bytecodes.
<LI> Custom development is executable Java bytecodes.
</UL> I believe that a Java-based operating system is going to provide a Java Virtual Machine unlike any other. It must still be a <EM>virtual</EM> machine because it is expected to run on a real '386 processor, not a Java-bytecode processor. An exclusively-Java platform can optimize around the bytecode processor. The exclusively-Java platform can outperform the currently available Java Virtual Machines.
</P><P>
When it comes to memory consumption, a Java-based operating system should outperform all other JVMs. Why? Because the memory manager has only one kind of allocation to perform. It must allocate primative Java data types and objects. The memory manager can be highly optimized for this singular mission.
</P><P>
And when it comes t memory consumption, a Java-based operating system should outperform all others by reusing bytecode for classes. From this viewpoint, all bytecode is read-only. Since the bytecode is read-only, it does not have to be always kept in <nolink>RAM. A bytecode cache should allow a short list of the last 100 classes to actual exist in <nolink>RAM, with the rest on disk, ready to be loaded at a moments notice.
</P><P>
If the class loader were going to provide just-in-time compiling or ahead-of-time compiling, all bytecode could be compiled once at boot-time. Compiling all bytecode into a bytecode/native code cache would make a Java-based operating system the fastest <nolink>JVM on the planet.
<H4>Architecture</H4>
After reading other proposals, I think there may be something missing from the general architecture. Somewhere before there can be a device manager, there must be a class manager and/or class loader manager. I believe that the class loader manager must come just after the kernel in the start-up sequence. What happens without the class loader manager?
<UL> <LI> There is no way to load additional bytecodes for device drivers.
<LI> There is no way to load bytecodes for a process manager and a main process.
<LI> There is no way to load additional classes from either the org.jos or java packages.
<LI> There is no way to cache system classes properly for all processes.
<LI> There is no opportunity to compile bytecode to native code just-in-time.
</UL> <H4>More than a language</H4>
Since the Java language isn't the only language that outputs Java-compatible byte codes, the Java-based operating system becomes a platform for many languages. It becomes a platform where new programming languages will be invented:
<UL> <LI> Java -&gt; bytecode
<LI> C -&gt; bytecode
<LI> Pascal -&gt; bytecode
<LI> <a href="/view.php?topic=COBOL&web=Main&PHPSESSID=8a1dec1eec33fffd590d791c2a9e658c">COBOL</a> <wikitopic COBOL /wikitopic>-&gt; bytecode
<LI> and many, many others</UL> <BR><BR></P><!--

<TABLE width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="737b9c">
<TR><TD ALIGN="CENTER">
<a href="/user.php?op=login&redirect=%2Fview%2F%2FMemoryConsumption&PHPSESSID=8a1dec1eec33fffd590d791c2a9e658c">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FMemoryConsumption&PHPSESSID=8a1dec1eec33fffd590d791c2a9e658c">new&nbsp;user</a><TR><TD>
</TABLE>

!-->
<!-- end BODY page !-->

<HR>

<DIV ALIGN="CENTER">
<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR>
	<TD ALIGN="CENTER" COLSPAN="2">
		Content of these pages are owned and copyrighted by the poster.
	</TD>
</TR>
<TR>
	<TD ALIGN="RIGHT" WIDTH="50%">
		Hosted by:
	</TD>
	<TD ALIGN="LEFT">
		<A HREF="http://sourceforge.net/"><IMG 
			SRC="http://sourceforge.net/sflogo.php?group_id=2376&type=1"
			BORDER=0 HSPACE=0 VSPACE=0></A>
	</TD>
</TR>
</TABLE>
</DIV>
</BODY>
</HTML>

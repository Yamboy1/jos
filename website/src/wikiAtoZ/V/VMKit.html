<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 FINAL//EN">
<HTML>
  <HEAD>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
    <TITLE>VMKit.Imported @ jos.sf.net</TITLE>
  </HEAD>

<BODY BGCOLOR="#FFFFFF">

<!-- The FORM encloses the entire header, because it renders better that way. !-->
<FORM ACTION="/jump.php"><input type="hidden" name="PHPSESSID" value="25e53c036e71316270b359203b338109" />

<!-- The JOS logo. !-->
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR VALIGN="TOP" ALIGN="LEFT">
	<TD><A HREF="http://cjos.sourceforge.net/archive/"><IMG 
		VSPACE="0" HSPACE="0" ALIGN="MIDDLE" BORDER="0"
		SRC="http://cjos.sourceforge.net/archive/media/jos_logo_mini.gif"></A></TD>
	<!-- The tab table. !-->
	<TD WIDTH="100%" ALIGN="RIGHT" BGCOLOR="#FFFFFF" VALIGN="BOTTOM"> 
		<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%" ALIGN="RIGHT">
			<TR VALIGN="MIDDLE" ALIGN="LEFT">

<TD BGCOLOR="White" WIDTH="60%">&nbsp;</TD>
<TD BGCOLOR="#FFFFCC"><A HREF="http://cjos.sourceforge.net/archive/">Home</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/info/">Info</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/dev/">DevZone</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFCC66" ALIGN="CENTER"><A
HREF="http://jos.sourceforge.net/">Wiki</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
			</TR>
			<TR>
				<TD BGCOLOR="#FFCC66" ALIGN="RIGHT" COLSPAN="9">
					<A HREF="/view/Users/?PHPSESSID=25e53c036e71316270b359203b338109">UsersWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Main/?PHPSESSID=25e53c036e71316270b359203b338109">MainWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Info/?PHPSESSID=25e53c036e71316270b359203b338109">InfoWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/DevZone/?PHPSESSID=25e53c036e71316270b359203b338109">DevZoneWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Support/?PHPSESSID=25e53c036e71316270b359203b338109">SupportWeb</A>
				</TD>
			</TR>
		</TABLE>
	</TD>		
</TR>
<!-- The WikiHeader. !-->
<TR><TD COLSPAN="2">
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="CENTER">
		<B>[&nbsp;<a href="/info//VMKit?PHPSESSID=25e53c036e71316270b359203b338109">VMKit</a>&nbsp;]</B>
	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="CENTER">
		<B>[ not logged in ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="CENTER">
		<B>[ Web: <a href="/view/Imported/?PHPSESSID=25e53c036e71316270b359203b338109">Imported</a> ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFCC66" VALIGN="CENTER">
		goto:&nbsp;<INPUT TYPE="TEXT" SIZE="10" NAME="topic"><!--<INPUT TYPE="IMAGE" SRC="/media/go.gif?PHPSESSID=25e53c036e71316270b359203b338109" BORDER="0" VALUE="topic" ALT="goto">!-->&nbsp;<a href="/search.php?PHPSESSID=25e53c036e71316270b359203b338109"><FONT SIZE="-1">options</FONT></a>
	</TD>
</TR>
</TABLE>

<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
	<TR>
	<TD ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="TOP">
		[&nbsp;get <a href="/info/Imported/VMKit?PHPSESSID=25e53c036e71316270b359203b338109">info</a> on or <a href="/edit/Imported/VMKit?PHPSESSID=25e53c036e71316270b359203b338109">edit</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="TOP">
		[&nbsp;<a href="/user.php?op=login&redirect=%2Fview%2F%2FVMKit&PHPSESSID=25e53c036e71316270b359203b338109">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FVMKit&PHPSESSID=25e53c036e71316270b359203b338109">new&nbsp;user</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="TOP">
		[&nbsp;list of <a href="/topics/Imported/?PHPSESSID=25e53c036e71316270b359203b338109">topics</a>, <a href="/hubsnodes/Imported/?PHPSESSID=25e53c036e71316270b359203b338109">hubs&nbsp;&amp;&nbsp;nodes</a>, or <a href="/changes/Imported/?PHPSESSID=25e53c036e71316270b359203b338109">recent&nbsp;changes</a>&nbsp;]	</TD>
	</TR>
</TABLE>

<!-- From CommonHeader !-->
</TR></TD>
</TABLE>
</FORM>

<!-- start BODY page !-->
<P>
<FONT SIZE="-1"><a href="/view.php?topic=ArchitectureGroup&PHPSESSID=25e53c036e71316270b359203b338109">ArchitectureGroup</a><wikitopic ArchitectureGroup /wikitopic></FONT>
<HR SIZE="1" NOSHADOW>
<P><EM>Article contributed by <a href="/view.php?topic=GilbertHerschberger&PHPSESSID=25e53c036e71316270b359203b338109">GilbertHerschberger</a><wikitopic GilbertHerschberger /wikitopic> (21 June 2000).</EM></P>
<H4>Introduction</H4>
<P>In an afternoon, I'd like to throw together a virtual machine from a virtual machine kit. How might this be possible? This article describes the development of a virtual machine from reusable C library and/or C++ class library.</P>
<H4>Components</H4>
<P>Every virtual machine has similar components. Each component talks to other components. It is possible to build a virtual machine from plug-ins for each component.</P>
<UL>
<LI><P><STRONG>Component environment</STRONG></P>
<P>All components run in a component environment. When you want a virtual machine, you load a component environment. In turn, the component environment loads and runs additional plug-in components. When a component environment is distributed, components can be allocated to different machines. A component environment has a run-time configuration, enabling you to select your favorite components.</P>
<LI><P><STRONG>Allocation and garbage collection</STRONG></P>
<P>Instead of deciding up-front how your objects are allocated and garbage collected, you could design your virtual machine around a gc plug-in. This plug-in could be optimized for different performance requirements. It could be selected at runtime.</P>
<LI><P><STRONG>Bytecode resource</STRONG></P>
<P>If necessary, bytecode for standard class libraries can be converted into binary resources. This component does not need to be redesigned for each custom virtual machine. One generic design will do.</P>
<P><A HREF="DownloadPureReflection?PHPSESSID=25e53c036e71316270b359203b338109">Pure Reflection for C++</A> combines bytecode with pure reflection to enable an extreme form of a bytecode resource. Raw bytecode is packaged in a <CODE>rc<EM>Bytecode</CODE> class, which is already capable of pure reflection. Instances of <CODE>rc</EM>Bytecode</CODE> are organized into packages with <CODE>rc_Package</CODE>.</P>
<LI><P><STRONG>Bytecode cache</STRONG></P>
<P>Instead of building a bytecode cache from scratch, you could plug-in a bytecode cache written by another programmer. A bytecode cache is loosly-coupled to a bytecode interpreter.</P>
<LI><P><STRONG>Bytecode interpreter</STRONG></P>
<P>Instead of binding your virtual machine to Java-compatible bytecodes, you could design your virtual machine around a plug-in bytecode interpreter. This plug-in could be optimized for different performance requirements, too. It could be selected at runtime. It could, for example, depend on Java platform compatibility.</P>
<P>Multiple interpreters can be loaded in a single component environment.</P>
<LI><P><STRONG>Calculator</STRONG></P>
<P>Part of a bytecode interpreter is a calculator. A calculator is responsible for <a href="/view.php?topic=CalculatorOpcodes&PHPSESSID=25e53c036e71316270b359203b338109">CalculatorOpcodes</a><wikitopic CalculatorOpcodes /wikitopic>.</P>
<LI><P><STRONG>Primordial class loader</STRONG></P>
<P>Instead of deciding up-front on a classic file-system primordial class loader, you could design your virtual machine around a plug-in primordial class loader. At runtime, a virtual machine could be switch-able from classic or MPCL-compatible design.</P>
<LI><P><STRONG>Thread manager</STRONG></P>
<P>Instead of deciding on preemptive or non-preemptive thread at compile-time, you could design your virtual machine around a plug-in thread manager. It would be able to create and destroy threads. It would schedule threads appropriately.</P>
<LI><P><STRONG>Bytecode verifier</STRONG></P>
<P>When your virtual machine needs a bytecode verifier, it should be able to select one from many verifiers available. A bytecode verifier could be a plug-in to your virtual machine.</P>
<LI><P><STRONG>I/O support</STRONG></P>
<P>When your virtual machine needs native I/O support, plug it in. This plug-in corresponds to the <CODE>java.io</CODE> package.</P>
<LI><P><STRONG>Network support</STRONG></P>
<P>If you don't wish to write your own network support, select a network support component from a list. If your virtual machine needs to run network on different foreign operating system, different plug-ins are needed.</P>
<LI><P><STRONG>Data conversion</STRONG></P>
<P>Many virtual machines use the same data conversion routines. The data conversion library needs a well-known interface so that any compatible conversion library can be used in your virtual machine.</P>
<LI><P><STRONG>Other components</STRONG></P>
<P>And so on. Additional components could be added and changed as needed to fit all kinds of operating environments.</P>
</UL>
<P>Instead of fixing the design of your virtual machine at the factory, you could build a virtual machine around loosly-coupled components. Together we can build these generic components and distributed a virtual machine kit.</P>
<H4>Reuse</H4>
<P>A virtual machine is not a monolythic application. There are many opportunities to build a virtual machine from resuable components.</P>
<P>A plug-in architecture is required to build a virtual machine from a catalog of plug-ins. Plug-ins are loosly-coupled. A well-defined interface is needed for each kind of plug-in and for plug-ins in general.</P>
<P>The C++ language provides at least two kinds of ways to encourage plug-ins. First, header files are separate from implementation. Like system header files for Linux, a virtual machine kit should have its header files maintained in a different directory. The header files must not be mixed with its implementation. When an implementation follows the interface design found in header files, a linker can select a plug-in at link-time.</P>
<P>Secondly, C++ provides inheritence. A custom implementation of garbage collection might extend the garbage collection base class. It is possible to have two different kinds of garbage collection running inside a virtual machine at the same time.</P>
<P>Like an operating system kit provides the ground work for building your own operating system, a virtual machine kit would provide the ground work for building your own virtual machine. You can write your own plug-in or use an existing one.</P>
<P>The combination of <CODE>OSKit</CODE> and <CODE>VMKit</CODE> would give us a Java-based operating sytem.</P>
<H4>Independent</H4>
<P>By encouraging the independent development of each component, more open-source programmers will be able to contribute their code to the project. For optimum performance, each component should be developed independently, in its own directory, with its own development team. Each component should be compiled into a library. Libraries can be linked, statically or dynamically, to throw together a custom virtual machine.</P>
<P>By encouraging the independent test of each component, each custom virtual machine will be more reliable. Each component should be tested independently. The well-known interface is used to test any compatible component.</P><BR><BR></P><!--

<TABLE width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="737b9c">
<TR><TD ALIGN="CENTER">
<a href="/user.php?op=login&redirect=%2Fview%2F%2FVMKit&PHPSESSID=25e53c036e71316270b359203b338109">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FVMKit&PHPSESSID=25e53c036e71316270b359203b338109">new&nbsp;user</a><TR><TD>
</TABLE>

!-->
<!-- end BODY page !-->

<HR>

<DIV ALIGN="CENTER">
<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR>
	<TD ALIGN="CENTER" COLSPAN="2">
		Content of these pages are owned and copyrighted by the poster.
	</TD>
</TR>
<TR>
	<TD ALIGN="RIGHT" WIDTH="50%">
		Hosted by:
	</TD>
	<TD ALIGN="LEFT">
		<A HREF="http://sourceforge.net/"><IMG 
			SRC="http://sourceforge.net/sflogo.php?group_id=2376&type=1"
			BORDER=0 HSPACE=0 VSPACE=0></A>
	</TD>
</TR>
</TABLE>
</DIV>
</BODY>
</HTML>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 FINAL//EN">
<HTML>
  <HEAD>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
    <TITLE>DynamicStorageObject.Main @ jos.sf.net</TITLE>
  </HEAD>

<BODY BGCOLOR="#FFFFFF">

<!-- The FORM encloses the entire header, because it renders better that way. !-->
<FORM ACTION="/jump.php"><input type="hidden" name="PHPSESSID" value="0b5f99bbafe4c97c156ce509416d2bdd" />

<!-- The JOS logo. !-->
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR VALIGN="TOP" ALIGN="LEFT">
	<TD><A HREF="http://cjos.sourceforge.net/archive/"><IMG 
		VSPACE="0" HSPACE="0" ALIGN="MIDDLE" BORDER="0"
		SRC="http://cjos.sourceforge.net/archive/media/jos_logo_mini.gif"></A></TD>
	<!-- The tab table. !-->
	<TD WIDTH="100%" ALIGN="RIGHT" BGCOLOR="#FFFFFF" VALIGN="BOTTOM"> 
		<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%" ALIGN="RIGHT">
			<TR VALIGN="MIDDLE" ALIGN="LEFT">

<TD BGCOLOR="White" WIDTH="60%">&nbsp;</TD>
<TD BGCOLOR="#FFFFCC"><A HREF="http://cjos.sourceforge.net/archive/">Home</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/info/">Info</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/dev/">DevZone</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFCC66" ALIGN="CENTER"><A
HREF="http://jos.sourceforge.net/">Wiki</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
			</TR>
			<TR>
				<TD BGCOLOR="#FFCC66" ALIGN="RIGHT" COLSPAN="9">
					<A HREF="/view/Users/?PHPSESSID=0b5f99bbafe4c97c156ce509416d2bdd">UsersWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Main/?PHPSESSID=0b5f99bbafe4c97c156ce509416d2bdd">MainWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Info/?PHPSESSID=0b5f99bbafe4c97c156ce509416d2bdd">InfoWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/DevZone/?PHPSESSID=0b5f99bbafe4c97c156ce509416d2bdd">DevZoneWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Support/?PHPSESSID=0b5f99bbafe4c97c156ce509416d2bdd">SupportWeb</A>
				</TD>
			</TR>
		</TABLE>
	</TD>		
</TR>
<!-- The WikiHeader. !-->
<TR><TD COLSPAN="2">
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="CENTER">
		<B>[&nbsp;<a href="/info//DynamicStorageObject?PHPSESSID=0b5f99bbafe4c97c156ce509416d2bdd">DynamicStorageObject</a>&nbsp;]</B>
	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="CENTER">
		<B>[ not logged in ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="CENTER">
		<B>[ Web: <a href="/view/Main/?PHPSESSID=0b5f99bbafe4c97c156ce509416d2bdd">Main</a> ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFCC66" VALIGN="CENTER">
		goto:&nbsp;<INPUT TYPE="TEXT" SIZE="10" NAME="topic"><!--<INPUT TYPE="IMAGE" SRC="/media/go.gif?PHPSESSID=0b5f99bbafe4c97c156ce509416d2bdd" BORDER="0" VALUE="topic" ALT="goto">!-->&nbsp;<a href="/search.php?PHPSESSID=0b5f99bbafe4c97c156ce509416d2bdd"><FONT SIZE="-1">options</FONT></a>
	</TD>
</TR>
</TABLE>

<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
	<TR>
	<TD ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="TOP">
		[&nbsp;get <a href="/info/Main/DynamicStorageObject?PHPSESSID=0b5f99bbafe4c97c156ce509416d2bdd">info</a> on or <a href="/edit/Main/DynamicStorageObject?PHPSESSID=0b5f99bbafe4c97c156ce509416d2bdd">edit</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="TOP">
		[&nbsp;<a href="/user.php?op=login&redirect=%2Fview%2F%2FDynamicStorageObject&PHPSESSID=0b5f99bbafe4c97c156ce509416d2bdd">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FDynamicStorageObject&PHPSESSID=0b5f99bbafe4c97c156ce509416d2bdd">new&nbsp;user</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="TOP">
		[&nbsp;list of <a href="/topics/Main/?PHPSESSID=0b5f99bbafe4c97c156ce509416d2bdd">topics</a>, <a href="/hubsnodes/Main/?PHPSESSID=0b5f99bbafe4c97c156ce509416d2bdd">hubs&nbsp;&amp;&nbsp;nodes</a>, or <a href="/changes/Main/?PHPSESSID=0b5f99bbafe4c97c156ce509416d2bdd">recent&nbsp;changes</a>&nbsp;]	</TD>
	</TR>
</TABLE>

<!-- From CommonHeader !-->
</TR></TD>
</TABLE>
</FORM>

<!-- start BODY page !-->
<P>
<a href="/view.php?topic=StaticStorageObject&PHPSESSID=0b5f99bbafe4c97c156ce509416d2bdd">StaticStorageObject</a><wikitopic StaticStorageObject /wikitopic>
<HR>
<EM>Article contributed by <a href="/view.php?topic=GilbertHerschberger&PHPSESSID=0b5f99bbafe4c97c156ce509416d2bdd">GilbertHerschberger</a><wikitopic GilbertHerschberger /wikitopic> (revised 14 December 2000, revised 1 January 2002).</EM>
<H4>Introduction</H4>
A <EM>dynamic storage object</EM> is characterized by allocating space in memory for each value stored. A dynamic storage object is often implemented in Java as a native array. A dynamic storage object is also different than a regular object by its lack of class-specific behavior.
<H4>Products</H4>
The following products explore dynamic storage objects using the Java programming language:
<UL> <LI> Khimera ( <a href="/view.php?topic=AboutKhimera&PHPSESSID=0b5f99bbafe4c97c156ce509416d2bdd">AboutKhimera</a><wikitopic AboutKhimera /wikitopic> )
<LI> <a href="/view.php?topic=XDC&web=Main&PHPSESSID=0b5f99bbafe4c97c156ce509416d2bdd">XDC</a><wikitopic XDC /wikitopic>
<LI> Kato
<LI> Data Registry ( <a href="/view.php?topic=DataRegistry&PHPSESSID=0b5f99bbafe4c97c156ce509416d2bdd">DataRegistry</a><wikitopic DataRegistry /wikitopic> )
</UL> <H4>Example</H4>
Here is a short example:
<PRE>
public class X {
  private static Object[] buf = new Object[ 10 ];

  public void pack() {
    buf[ 0 ] = new Short( (short) i1 );
    buf[ 1 ] = new String( "PQRS" );
    :
  }

  public void unpack()
      throws UnpackException {
    i1 = ( (Short) buf[ 0 ] ).getInt();
    if ( ( (String) buf[ 1 ] ).equals( "PQRS" ) ) {
      throw new UnpackException();
    }
    :
  }
}
</PRE>
Writing the dynamic storage object to an output stream is more complicated because the <CODE>Object</CODE> array can hold objects of many different types. An alternative is to use an array of <CODE>Serializable</CODE> instead of <CODE>Object</CODE>, restricting the dynamic storage object to only those objects which are serializable.
<PRE>
static Serializable[] buf = new Serializable[ 10 ];
</PRE>
Reading the dynamic storage object from an input stream is more complicated, too. There must be mechanism for each object to be unpacked from a stream, using its original class name and references to other objects.
</P><P>
The official answer comes from <CODE>ObjectOutputStream</CODE> and <CODE>ObjectInputStream</CODE>. After collecting a list of serializable objects into an array, the array can be written to a <CODE>ObjectOutputStream</CODE>, like this:
<PRE>
  f.write( buf );
</PRE>
Unfortunately, the official answer doesn't quite work from one version of a <CODE>Serializable</CODE> class to another. When you intend to use data written by an old version in a new version of a class, it is often a challenge too complex to finish. A bug in an old version may prevent you from getting your data out of an old object stream.
</P><P>
A small collection of generic dynamic storage objects are the only objects that should be serializable. These object would be stable, rugged, and fully debugged before any data is saved to an output stream. Generic dynamic storage objects are reusable. Regular Java classes would pack their data into dynamic storage objects and unpack their data from dynamic storage objects. Java classes would be constructed in the regular way and survive the usual bugs in Java classes.
</P><P>
An <EM>event object</EM> is an example of a dynamic storage object. An event object has been made more popular by object-oriented design. It is a way to get around the complexity of a completely type-safe design in favor of generic storage.
</P><P>
<STRONG>Better than serialization</STRONG> Using a dynamic storage object is better than serialization for many reasons, including creating multiple object snapshots. Each time pack() is called, a full copy of an object's data is written into the dynamic storage object. The following code works as expected, writing x three times into the output stream:
<PRE>
  X x = new X();
  x.pack();
  f.write( x );
  x.setValue( 1 );
  x.pack();
  f.write( x );
  x.setValue( 2 );
  x.pack();
  f.write( x );
</PRE>
When writing objects to a <CODE>DSOOutputStream</CODE>, a specialized stream, the stream calls <CODE>x.pack()</CODE> automatically:
<PRE>
  X x = new X();
  DSOOutputStream f = new DSOOutputStream( ... );
  f.write( x );
  x.setValue( 1 );
  f.write( x );
  x.setValue( 2 );
  f.write( x );
</PRE><BR><BR></P><!--

<TABLE width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="737b9c">
<TR><TD ALIGN="CENTER">
<a href="/user.php?op=login&redirect=%2Fview%2F%2FDynamicStorageObject&PHPSESSID=0b5f99bbafe4c97c156ce509416d2bdd">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FDynamicStorageObject&PHPSESSID=0b5f99bbafe4c97c156ce509416d2bdd">new&nbsp;user</a><TR><TD>
</TABLE>

!-->
<!-- end BODY page !-->

<HR>

<DIV ALIGN="CENTER">
<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR>
	<TD ALIGN="CENTER" COLSPAN="2">
		Content of these pages are owned and copyrighted by the poster.
	</TD>
</TR>
<TR>
	<TD ALIGN="RIGHT" WIDTH="50%">
		Hosted by:
	</TD>
	<TD ALIGN="LEFT">
		<A HREF="http://sourceforge.net/"><IMG 
			SRC="http://sourceforge.net/sflogo.php?group_id=2376&type=1"
			BORDER=0 HSPACE=0 VSPACE=0></A>
	</TD>
</TR>
</TABLE>
</DIV>
</BODY>
</HTML>

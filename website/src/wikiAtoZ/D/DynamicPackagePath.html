<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 FINAL//EN">
<HTML>
  <HEAD>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
    <TITLE>DynamicPackagePath.Imported @ jos.sf.net</TITLE>
  </HEAD>

<BODY BGCOLOR="#FFFFFF">

<!-- The FORM encloses the entire header, because it renders better that way. !-->
<FORM ACTION="/jump.php"><input type="hidden" name="PHPSESSID" value="8d7c13ca704c5ef04d4b812f94495ed3" />

<!-- The JOS logo. !-->
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR VALIGN="TOP" ALIGN="LEFT">
	<TD><A HREF="http://cjos.sourceforge.net/archive/"><IMG 
		VSPACE="0" HSPACE="0" ALIGN="MIDDLE" BORDER="0"
		SRC="http://cjos.sourceforge.net/archive/media/jos_logo_mini.gif"></A></TD>
	<!-- The tab table. !-->
	<TD WIDTH="100%" ALIGN="RIGHT" BGCOLOR="#FFFFFF" VALIGN="BOTTOM"> 
		<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%" ALIGN="RIGHT">
			<TR VALIGN="MIDDLE" ALIGN="LEFT">

<TD BGCOLOR="White" WIDTH="60%">&nbsp;</TD>
<TD BGCOLOR="#FFFFCC"><A HREF="http://cjos.sourceforge.net/archive/">Home</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/info/">Info</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/dev/">DevZone</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFCC66" ALIGN="CENTER"><A
HREF="http://jos.sourceforge.net/">Wiki</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
			</TR>
			<TR>
				<TD BGCOLOR="#FFCC66" ALIGN="RIGHT" COLSPAN="9">
					<A HREF="/view/Users/?PHPSESSID=8d7c13ca704c5ef04d4b812f94495ed3">UsersWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Main/?PHPSESSID=8d7c13ca704c5ef04d4b812f94495ed3">MainWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Info/?PHPSESSID=8d7c13ca704c5ef04d4b812f94495ed3">InfoWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/DevZone/?PHPSESSID=8d7c13ca704c5ef04d4b812f94495ed3">DevZoneWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Support/?PHPSESSID=8d7c13ca704c5ef04d4b812f94495ed3">SupportWeb</A>
				</TD>
			</TR>
		</TABLE>
	</TD>		
</TR>
<!-- The WikiHeader. !-->
<TR><TD COLSPAN="2">
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="CENTER">
		<B>[&nbsp;<a href="/info//DynamicPackagePath?PHPSESSID=8d7c13ca704c5ef04d4b812f94495ed3">DynamicPackagePath</a>&nbsp;]</B>
	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="CENTER">
		<B>[ not logged in ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="CENTER">
		<B>[ Web: <a href="/view/Imported/?PHPSESSID=8d7c13ca704c5ef04d4b812f94495ed3">Imported</a> ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFCC66" VALIGN="CENTER">
		goto:&nbsp;<INPUT TYPE="TEXT" SIZE="10" NAME="topic"><!--<INPUT TYPE="IMAGE" SRC="/media/go.gif?PHPSESSID=8d7c13ca704c5ef04d4b812f94495ed3" BORDER="0" VALUE="topic" ALT="goto">!-->&nbsp;<a href="/search.php?PHPSESSID=8d7c13ca704c5ef04d4b812f94495ed3"><FONT SIZE="-1">options</FONT></a>
	</TD>
</TR>
</TABLE>

<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
	<TR>
	<TD ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="TOP">
		[&nbsp;get <a href="/info/Imported/DynamicPackagePath?PHPSESSID=8d7c13ca704c5ef04d4b812f94495ed3">info</a> on or <a href="/edit/Imported/DynamicPackagePath?PHPSESSID=8d7c13ca704c5ef04d4b812f94495ed3">edit</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="TOP">
		[&nbsp;<a href="/user.php?op=login&redirect=%2Fview%2F%2FDynamicPackagePath&PHPSESSID=8d7c13ca704c5ef04d4b812f94495ed3">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FDynamicPackagePath&PHPSESSID=8d7c13ca704c5ef04d4b812f94495ed3">new&nbsp;user</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="TOP">
		[&nbsp;list of <a href="/topics/Imported/?PHPSESSID=8d7c13ca704c5ef04d4b812f94495ed3">topics</a>, <a href="/hubsnodes/Imported/?PHPSESSID=8d7c13ca704c5ef04d4b812f94495ed3">hubs&nbsp;&amp;&nbsp;nodes</a>, or <a href="/changes/Imported/?PHPSESSID=8d7c13ca704c5ef04d4b812f94495ed3">recent&nbsp;changes</a>&nbsp;]	</TD>
	</TR>
</TABLE>

<!-- From CommonHeader !-->
</TR></TD>
</TABLE>
</FORM>

<!-- start BODY page !-->
<P>
<FONT SIZE="-1"><a href="/view.php?topic=BytecodePages&PHPSESSID=8d7c13ca704c5ef04d4b812f94495ed3">BytecodePages</a><wikitopic BytecodePages /wikitopic></FONT>
<HR SIZE="1" NOSHADOW>
<P><EM>Article contributed by <a href="/view.php?topic=GilbertHerschberger&PHPSESSID=8d7c13ca704c5ef04d4b812f94495ed3">GilbertHerschberger</a><wikitopic GilbertHerschberger /wikitopic> (1 May 2000).</EM></P>
<H4>Introduction</H4>
<P><nolink>CLASSPATH is dynamic, <EM>and should be</EM>. A classic virtual machine treats <nolink>CLASSPATH as if it were static when it is not. The classic virtual machine depends a custom class loader when a custom class loader is not required.</P>
<P>This might be the most irritating constraint of a classic virtual machine. This defect is most clearly visible when trying to build an operating system, starting with the <a href="/view.php?topic=JavaVirtualMachineSpecification&PHPSESSID=8d7c13ca704c5ef04d4b812f94495ed3">JavaVirtualMachineSpecification</a><wikitopic JavaVirtualMachineSpecification /wikitopic>. A static system-wide <nolink>CLASSPATH can't support multiple, independent Java applications. The source of the executable is not known, and not know-able, at boot-time. Rather, <nolink>CLASSPATH must be maintained over the lifetime of a virtual machine.</P>
<P><EM>Note: This is how the</EM> <a href="/view.php?topic=ERICProject&PHPSESSID=8d7c13ca704c5ef04d4b812f94495ed3">ERICProject</a><wikitopic ERICProject /wikitopic> <EM>should do it.</EM></P>
<H4>Where's the bytecode?</H4>
<P><nolink>CLASSPATH explains to a primordial class loader where to find the bytecode. How does an application explain to a virtual machine about its <nolink>CLASSPATH?</P>
<BLOCKQUOTE><STRONG>It is neither necessary nor desireable to explain <nolink>CLASSPATH to the virtual machine <EM>before</EM> the first class is invoked.</STRONG></BLOCKQUOTE></P>
<P>Everything that can be written in bytecode should be written in bytecode. <nolink>CLASSPATH management can be written in bytecode, <EM>and should be</EM>. An application's main class should be able to set the <nolink>CLASSPATH dynamically, and then launch an application. Since this is a universal problem that all Java applications have, a custom class loader should not be required.</P>
<P>This mechanism can be implemented in such a way that works in all Java platforms, past, present and future. Such a platform-independent mechanism would make it easier to distribute Java applications that do not require a high level of technical Java expertise to install.</P>
<P>This mechanism is critical to the success of a Java-based operating system, like JOS.</P>
<H4>Add location</H4>
<P><nolink>CLASSPATH needs a <nolink>CLASSPATH manager. A virtual machine should not treat <nolink>CLASSPATH as a <CODE>String</CODE>, but an array of bytecode locations.</P>
<P>A new <nolink>CLASSPATH manager is created with each bytecode process. One process can obtain a proxy to the <nolink>CLASSPATH manager of another. Locations added when the <nolink>CLASSPATH manager is created are locked and cannot be removed.</P>
<P>A directory can be added to <nolink>CLASSPATH.</P>
<PRE>
  public void example() {
	 ClasspathManager manager = getClasspathManager();
	 manager.addDirectory( "/usr/local/classes" );
  }
</PRE>
<P>A process-wide primordial class loader uses a new location from the point that it has been added.</P>
<P>A <a href="/view.php?topic=URL&web=Imported&PHPSESSID=8d7c13ca704c5ef04d4b812f94495ed3">URL</a> <wikitopic URL /wikitopic>can be added to <nolink>CLASSPATH.</P>
<PRE>
  public void example() {
	 ClasspathManager manager = getClasspathManager();
	 manager.addLocation( "http://www.jos.org/classes" );
  }
</PRE>
<H4>Enumerate directories</H4>
<P>A <nolink>CLASSPATH manager can enumerate locations in the order in which they were added. A primordial class loader uses this to load a new class.</P>
<PRE>
  public void example() {
	 ClasspathManager manager = getClasspathManager();
	 Enumeration list = manager.getLocations();
	 for (;;) {
		if ( !list.hasMoreElements() ) {
		  break;
		}

		String item = (String) list.nextElement();
	 }
  }
</PRE>
<H4>Remove location</H4>
<P>Locations can be locked or unlocked. A locked location is added when a <nolink>CLASSPATH manager is created and cannot be removed. An unlocked location can be removed.</P>
<PRE>
  public void example() {
	 ClasspathManager manager = getClasspathManager();
	 manager.removeLocation( "http://www.jos.org/classes" );
  }
</PRE>
<P>A process-wide primordial class loader stops using a location from the point that it has been removed.</P>
<H4>Security</H4>
<P>The <CODE>getClasspathManager()</CODE> method must be a little concerned with security. The factory method might return a different implementation of the <CODE>ClasspathManager</CODE> interface depending on the security level of the requesting class.</P>
<H4>Archive path</H4>
<P>Archive files (.cab, .jar and .zip) are supported only for backward compatibility. While a <nolink>CLASSPATH manager looks for .class files, a <nolink>ARCHIVEPATH manager looks for archive files in each of the given directories.</P>
<PRE>
  public void example() {
	 ArchivePathManager manager = getArchivePathManager();
	 manager.addLocation( "http://www.jos.org/redist/mirror" );
  }
</PRE>
<P>An archive location contains zero or more archives.</P>
<H4>Package path</H4>
<P>A package should be the smallest unit of distribution. While a <nolink>CLASSPATH looks for .class files, a <nolink>PACKAGEPATH looks for .package files in each of the given directories.</P>
<PRE>
  public void example() {
	 PackagePathManager manager = getPackagePathManager();
	 manager.addLocation( "http://www.jos.org/jpkg" );
  }
</PRE>
<H4>Location manager</H4>
<P>Instead of literally implementing a <nolink>CLASSPATH, <nolink>ARCHIVEPATH and <nolink>PACKAGEPATH manager separately, a single location manager is quite capable of managing all kinds of bytecode locations.</P>
<PRE>
  public void example() {
	 LocationManager manager = getLocationManager();
	 manager.addClassLocation( "/usr/local/classes" );
	 manager.addArchiveLocation( "/usr/local/archives" );
	 manager.addPackageLocation( "/usr/local/packages" );
  }
</PRE>
<P>A location is usually a <nolink>URL. Otherwise, a location without a colon (:) is assumed to be a local directory. Local directory names can be expressed at the application level with a platform-independent forward slash (/), just like a <nolink>URL. Locations are automatically translated using a platform-specific file separator.</P>
<H4>Summary</H4>
<P>A bytecode manager would use location manager to find all kinds of bytecode. A package-oriented bytecode manager always loads one package at a time.</P>
<UL>
<LI><P>Packages are loaded on demand. The package specification is used to load all classes in a package from a single location. A package specification can be extracted from a class specification, like <CODE>java/lang/Object</CODE>.</P>
<LI><P>When bytecode is requested for a class, all classes in a package should be loaded. This is not always possible. Both a <nolink>PACKAGEPATH and <nolink>CLASSPATH manager can easily download a package from a remote machine. An <nolink>ARCHIVEPATH manager can only load archives from a local machine.</P>
<LI><P>A <nolink>CLASSPATH manager downloads an entire archive. The archive is stored in a system-wide <nolink>URL cache. Even a <nolink>CLASSPATH manager loads classes for one package at a time.</P>
</UL>
<HR>
<P>An <nolink>ARCHIVEPATH manager makes no assumptions about the names of any archive; an archive name is <EM>unpredictable</EM>. Therefore, an <nolink>ARCHIVEPATH manager is compatible with an <nolink>HTTP directory as long as it has no index. By default, the <nolink>ARCHIVEPATH manager must download and search every archive when one archive is stored on an <nolink>HTTP service.</P>
<P>On the other hand, a <nolink>PACKAGEPATH manager makes a simple assumption about the names of archives; an archive name is <EM>predictable</EM>. An archive contains .class files for exactly one package. The archive reflects the name of the package. Classes in the <CODE>java.lang</CODE> package, for example, are always stored in an archive called <CODE>java.lang.jar</CODE>.</P>
<P>One archive at a time can be added to a <nolink>CLASSPATH manager. A <nolink>CLASSPATH manager can download any archive if its name is explicitely added to <nolink>CLASSPATH.</P>
<P>This mechanism can be extended. A <nolink>PACKAGEPATH manager can be linked to a package cache across the network. A location can be specified with a package service, either stand-alone or a servlet. Each request for a package using a package service always returns one package file. A package service can manage its own <nolink>CLASSPATH, <nolink>ARCHIVEPATH and <nolink>PACKAGEPATH. The mechanism to manage these and other properties is dependent on each implementation of a package service. Package services can be daisy-chained so that a client-side application has virtual access to all packages through one well-known package service. All packages files become predictable through a package service, although individual archives have unpredictable names. -- <a href="/view.php?topic=GilbertHerschberger&PHPSESSID=8d7c13ca704c5ef04d4b812f94495ed3">GilbertHerschberger</a><wikitopic GilbertHerschberger /wikitopic> (8 May 2000)</P><BR><BR></P><!--

<TABLE width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="737b9c">
<TR><TD ALIGN="CENTER">
<a href="/user.php?op=login&redirect=%2Fview%2F%2FDynamicPackagePath&PHPSESSID=8d7c13ca704c5ef04d4b812f94495ed3">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FDynamicPackagePath&PHPSESSID=8d7c13ca704c5ef04d4b812f94495ed3">new&nbsp;user</a><TR><TD>
</TABLE>

!-->
<!-- end BODY page !-->

<HR>

<DIV ALIGN="CENTER">
<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR>
	<TD ALIGN="CENTER" COLSPAN="2">
		Content of these pages are owned and copyrighted by the poster.
	</TD>
</TR>
<TR>
	<TD ALIGN="RIGHT" WIDTH="50%">
		Hosted by:
	</TD>
	<TD ALIGN="LEFT">
		<A HREF="http://sourceforge.net/"><IMG 
			SRC="http://sourceforge.net/sflogo.php?group_id=2376&type=1"
			BORDER=0 HSPACE=0 VSPACE=0></A>
	</TD>
</TR>
</TABLE>
</DIV>
</BODY>
</HTML>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 FINAL//EN">
<HTML>
  <HEAD>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
    <TITLE>EricAndJniOnLinux.Main @ jos.sf.net</TITLE>
  </HEAD>

<BODY BGCOLOR="#FFFFFF">

<!-- The FORM encloses the entire header, because it renders better that way. !-->
<FORM ACTION="/jump.php"><input type="hidden" name="PHPSESSID" value="8bbed3702130665147e1366912c34345" />

<!-- The JOS logo. !-->
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR VALIGN="TOP" ALIGN="LEFT">
	<TD><A HREF="http://cjos.sourceforge.net/archive/"><IMG 
		VSPACE="0" HSPACE="0" ALIGN="MIDDLE" BORDER="0"
		SRC="http://cjos.sourceforge.net/archive/media/jos_logo_mini.gif"></A></TD>
	<!-- The tab table. !-->
	<TD WIDTH="100%" ALIGN="RIGHT" BGCOLOR="#FFFFFF" VALIGN="BOTTOM"> 
		<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%" ALIGN="RIGHT">
			<TR VALIGN="MIDDLE" ALIGN="LEFT">

<TD BGCOLOR="White" WIDTH="60%">&nbsp;</TD>
<TD BGCOLOR="#FFFFCC"><A HREF="http://cjos.sourceforge.net/archive/">Home</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/info/">Info</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/dev/">DevZone</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFCC66" ALIGN="CENTER"><A
HREF="http://jos.sourceforge.net/">Wiki</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
			</TR>
			<TR>
				<TD BGCOLOR="#FFCC66" ALIGN="RIGHT" COLSPAN="9">
					<A HREF="/view/Users/?PHPSESSID=8bbed3702130665147e1366912c34345">UsersWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Main/?PHPSESSID=8bbed3702130665147e1366912c34345">MainWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Info/?PHPSESSID=8bbed3702130665147e1366912c34345">InfoWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/DevZone/?PHPSESSID=8bbed3702130665147e1366912c34345">DevZoneWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Support/?PHPSESSID=8bbed3702130665147e1366912c34345">SupportWeb</A>
				</TD>
			</TR>
		</TABLE>
	</TD>		
</TR>
<!-- The WikiHeader. !-->
<TR><TD COLSPAN="2">
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="CENTER">
		<B>[&nbsp;<a href="/info//EricAndJniOnLinux?PHPSESSID=8bbed3702130665147e1366912c34345">EricAndJniOnLinux</a>&nbsp;]</B>
	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="CENTER">
		<B>[ not logged in ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="CENTER">
		<B>[ Web: <a href="/view/Main/?PHPSESSID=8bbed3702130665147e1366912c34345">Main</a> ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFCC66" VALIGN="CENTER">
		goto:&nbsp;<INPUT TYPE="TEXT" SIZE="10" NAME="topic"><!--<INPUT TYPE="IMAGE" SRC="/media/go.gif?PHPSESSID=8bbed3702130665147e1366912c34345" BORDER="0" VALUE="topic" ALT="goto">!-->&nbsp;<a href="/search.php?PHPSESSID=8bbed3702130665147e1366912c34345"><FONT SIZE="-1">options</FONT></a>
	</TD>
</TR>
</TABLE>

<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
	<TR>
	<TD ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="TOP">
		[&nbsp;get <a href="/info/Main/EricAndJniOnLinux?PHPSESSID=8bbed3702130665147e1366912c34345">info</a> on or <a href="/edit/Main/EricAndJniOnLinux?PHPSESSID=8bbed3702130665147e1366912c34345">edit</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="TOP">
		[&nbsp;<a href="/user.php?op=login&redirect=%2Fview%2F%2FEricAndJniOnLinux&PHPSESSID=8bbed3702130665147e1366912c34345">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FEricAndJniOnLinux&PHPSESSID=8bbed3702130665147e1366912c34345">new&nbsp;user</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="TOP">
		[&nbsp;list of <a href="/topics/Main/?PHPSESSID=8bbed3702130665147e1366912c34345">topics</a>, <a href="/hubsnodes/Main/?PHPSESSID=8bbed3702130665147e1366912c34345">hubs&nbsp;&amp;&nbsp;nodes</a>, or <a href="/changes/Main/?PHPSESSID=8bbed3702130665147e1366912c34345">recent&nbsp;changes</a>&nbsp;]	</TD>
	</TR>
</TABLE>

<!-- From CommonHeader !-->
</TR></TD>
</TABLE>
</FORM>

<!-- start BODY page !-->
<P>
<a href="/view.php?topic=EricPages&PHPSESSID=8bbed3702130665147e1366912c34345">EricPages</a><wikitopic EricPages /wikitopic>
<HR>
<h3>Overview</h3>
<h4>About this document</h4>
This document contains an overview of the renewed effort to support the <a href="/view.php?topic=InvocationApi&PHPSESSID=8bbed3702130665147e1366912c34345">InvocationApi</a><wikitopic InvocationApi /wikitopic> part of the <a href="/view.php?topic=JavaNativeInterface&PHPSESSID=8bbed3702130665147e1366912c34345">JavaNativeInterface</a><wikitopic JavaNativeInterface /wikitopic> on Linux. We have selected the C++ <nolink>API.
<h4>Author</h4>
This document was contributed by <a href="/view.php?topic=GilbertHerschberger&PHPSESSID=8bbed3702130665147e1366912c34345">GilbertHerschberger</a><wikitopic GilbertHerschberger /wikitopic> (16 April 2004).
<h4>Audience</h4>
This document is primarily intended for users of the eric tool for Linux (ericlinux). It might also be of interest to C++ programmers trying to use the Invocation <nolink>API on Linux.
<h4>Reference</h4>
The following are references used during the research of this project.
<UL> <LI> <a href="http://www.public.asu.edu/~wjanjua/java/jni/">http://www.public.asu.edu/~wjanjua/java/jni/</a>
<LI> <a href="http://www.gmonline.demon.co.uk/cscene/CS4/CS4-04.html">http://www.gmonline.demon.co.uk/cscene/CS4/CS4-04.html</a>
<LI> <a href="http://www.cs.kuleuven.ac.be/~barta/links/jni-jawt.pdf">http://www.cs.kuleuven.ac.be/~barta/links/jni-jawt.pdf</a>
<LI> <a href="http://www.blackdown.org/java-linux/docs/faq/examples/invocation-in-C++/">http://www.blackdown.org/java-linux/docs/faq/examples/invocation-in-C++/</a>
<LI> <a href="http://www.javalinux.net/updates.html">http://www.javalinux.net/updates.html</a>
</UL> <h4>Contents</h4>
This document contains the following sections:
<UL> <LI> Getting Started
<LI> Loading a Dynamically Shared Library
<LI> Design
</UL> 
<h3>Getting Started</h3>
<h4>Introduction</h4>
This section provides information about the prerequisites to compiling a C++ program that depends upon the Invocation <nolink>API.
</P><P>
<h4>Version control</h4>
A version control system is needed for this open source effort. We choose Concurrent Versioning System (CVS) over Secure Shell (SSH). We choose our <nolink>CVS repository on sourceforge.net.
</P><P>
The cvs client is distributed as an <nolink>RPM package.
<UL> <LI> Next: A cvs client must be installed on the world.dmr.com server.
</UL> 
<h4>Java 2 Software Development Kit</h4>
A development kit, or J2SDK, is required for two reasons. First, it provides <code>jni.h</code>, a C/C++ header files for the Invocation <nolink>API. Second, it enables us to run our test program to demonstrate our support for <nolink>JNI on Linux.
</P><P>
<h4>Java 2 Runtime Environment</h4>
A runtime environment, or J2RE, is optional. It is needed for testing. It might be needed if you're planning on distributing an eric-enabled Java application.
<UL> <LI> A J2RE might be distributed as part of your J2SDK.
</UL> 
<h4>C++ compiler</h4>
A C++ compiler is required to build an eric tool from source code. We choose a gcc compiler for Linux.
</P><P>
<h4>Build script</h4>
A build script enables us to build an eric tool reliably. We choose make for Linux. We start with our Makefile for version 1e.
</P><P>
<h4>Vendor and version</h4>
We must select a vendor and version for our first J2SDK. We choose Sun Microsystems. We choose version 1.4.1_04. Furthermore, we are installing the <nolink>J2SDK from <nolink>RPM.
</P><P>
<h4>Additional products</h4>
We choose the Java Native Interface (JNI) to be more product-independent. Any <nolink>JNI-compatible virtual machine should work. If a product works without modification of our code, great! Otherwise, your contribution to our open source effort is appreciated.
</P><P>
<h4>Location</h4>
Wouldn't it be great if your favorite J2SDK is always installed in a well-known location? Yes, it would simplify the development of our tools (and build process). The folks at <a href="/view.php?topic=JPackageOrg&PHPSESSID=8bbed3702130665147e1366912c34345">JPackageOrg</a><wikitopic JPackageOrg /wikitopic> have done this. Here's how:
<OL> <LI> You install a J2SDK on your machine. You can install it anywhere you want.
<LI> You create a symbolic link to your J2SDK. You always call it "java" in the following well-known directory: <code>/usr/lib/jvm</code>.
<LI> Your <nolink>JAVAHOME property can always be set to <code>/usr/lib/jvm/java</code>.
<LI> Your path property can always include the <code>/usr/lib/jvm/java/bin</code> directory so that you can always find your favorite tools, such as java and keytool.
</OL> 
We choose to install the jpackage tools from the <nolink>RPM provided at <a href="http://www.jpackage.org/">http://www.jpackage.org/</a> .
</P><P>
<h3>Loading a Dynamically Shared Library</h3>
<h4>Introduction</h4>
This section provides a review of how to load a dynamically shared library.
</P><P>
<h4>See also</h4>
The "zerick" research project is complete. It provides a platform-independent framework for loading libraries dynamically.
<UL> <LI> Next: The zerick module seems to be missing from <a href="/view.php?topic=CjOSCVSOnSourceForge&PHPSESSID=8bbed3702130665147e1366912c34345">CjOSCVSOnSourceForge</a><wikitopic CjOSCVSOnSourceForge /wikitopic> . Release 2 of Zerick 1b must be imported as <code>cpp/zerick1b</code>.
</UL> 
<h3>Design</h3>
<h4>Introduction</h4>
This section provides a detailed look at the design of a C++ class for Linux.
</P><P>
<h4>About kick property</h4>
The <code>kick</code> property determines if an eric tool uses an external tool.
<UL> <LI> When <code>true</code>, an eric tool kicks off another tool. It skips the Invocation <nolink>API and uses an external tool, such as <code>java</code> or <code>javaw</code>. An eric tool is in a separate process from a Java application.
<LI> Otherwise, an eric tool use the Invocation <nolink>API. An eric tool is part of the same process as a Java application.
</UL> 
The default value for this property should be <code>true</code> for both Linux and Microsoft Windows.
<UL> <LI> On Linux, the default is currently <code>false</code> because our work is incomplete.
<LI> On Microsoft Windows, the default is <code>true</code>, as it should be.
</UL> 
<h4>About javahome property</h4>
This property is a local path to a J2SDK or J2RE.
</P><P>
This property should be optional, even on Linux.
<UL> <LI> On Linux, the eric tool should perform a simple search for the J2SDK or J2RE. It should look for <code>/usr/lib/jvm/java</code> to match jpackage tools. It might examine the <nolink>JAVAHOME environment variable.
<LI> On Microsoft Windows, this property is optional. An eric tool reads well-known locations in the Windows registry. It does not yet examine the <nolink>JAVAHOME environment variable.
</UL> 
<h4>About runtimelibrary property</h4>
Most of the time, an eric tool uses the javahome property to derive the runtimelibrary property. This property is available so that you can select something other than the non-debug default library.
<UL> <LI> What is the logical name of the non-debug default runtime library?
</UL> 
<h4>Using polymophism</h4>
Our "virtual machine" class in C++ is used as a base class for a concrete virtual machine. A virtual machine object represents a load-able virtual machine. It is responsible for opening and closing the dynamic shared library. It is responsible for resolving and invoking <nolink>JNI-compatible functions.
</P><P>
On Microsoft Windows, a concrete class is selected at runtime.
<UL> <LI> When kick is true, a kick virtual machine is selected. This class encapsulates the details of using an external tool.
<LI> Otherwise, a basic virtual machine is selected. This class encapsulates a <nolink>JNI-compatible virtual machine for Windows.
</UL> 
On Linux, we desire a similar design.
<UL> <LI> When kick is true, a kick virtual machine should be selected.
<LI> Otherwise, a linux-and-jni virtual machine should be selected. This class should encapsulate a <nolink>JNI-compatible virtual machine for Linux.
</UL> 
<h4>Compile-time target</h4>
When compiling for Windows, none of the Linux-only code is compiled. Likewise, when compiling for Linux, none of the Windows-only code is compiled.
</P><P>
<h4>Loading a runtime library</h4>
A dynamic link library on Windows is similar to a dynamic shared library on Linux. The Zerick project shows that a common C++ interface can be used to access a shared library and its methods.
<UL> <LI> Likely, the techique for loading a shared library on Linux will be extracted from the Zerick research project.
<LI> It might be possible to use the Zerick classes directly. What are the possible benefits? It is not yet clear.
</UL> 
<h4>Passing properties</h4>
In any case, merged properties are passed to a virtual machine object and then the object is invoked. Merged properties include:
<UL> <LI> classpath,
<LI> start-up class, and
<LI> argument zero.
</UL> In turn, argument zero includes
<UL> <LI> package path
<LI> shell
<LI> location
</UL> 
<h4>Conclusion</h4>
Therefore, our assignment is very specific. We must implement a concrete virtual machine class capable of loading a <nolink>JNI-compatible virtual machine on Linux, using the similar mechanism for Microsoft Windows as an example.<BR><BR></P><!--

<TABLE width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="737b9c">
<TR><TD ALIGN="CENTER">
<a href="/user.php?op=login&redirect=%2Fview%2F%2FEricAndJniOnLinux&PHPSESSID=8bbed3702130665147e1366912c34345">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FEricAndJniOnLinux&PHPSESSID=8bbed3702130665147e1366912c34345">new&nbsp;user</a><TR><TD>
</TABLE>

!-->
<!-- end BODY page !-->

<HR>

<DIV ALIGN="CENTER">
<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR>
	<TD ALIGN="CENTER" COLSPAN="2">
		Content of these pages are owned and copyrighted by the poster.
	</TD>
</TR>
<TR>
	<TD ALIGN="RIGHT" WIDTH="50%">
		Hosted by:
	</TD>
	<TD ALIGN="LEFT">
		<A HREF="http://sourceforge.net/"><IMG 
			SRC="http://sourceforge.net/sflogo.php?group_id=2376&type=1"
			BORDER=0 HSPACE=0 VSPACE=0></A>
	</TD>
</TR>
</TABLE>
</DIV>
</BODY>
</HTML>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 FINAL//EN">
<HTML>
  <HEAD>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
    <TITLE>IdentifySystemClasses.Imported @ jos.sf.net</TITLE>
  </HEAD>

<BODY BGCOLOR="#FFFFFF">

<!-- The FORM encloses the entire header, because it renders better that way. !-->
<FORM ACTION="/jump.php"><input type="hidden" name="PHPSESSID" value="cabd66ed332018e00220c52a207c79c9" />

<!-- The JOS logo. !-->
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR VALIGN="TOP" ALIGN="LEFT">
	<TD><A HREF="http://cjos.sourceforge.net/archive/"><IMG 
		VSPACE="0" HSPACE="0" ALIGN="MIDDLE" BORDER="0"
		SRC="http://cjos.sourceforge.net/archive/media/jos_logo_mini.gif"></A></TD>
	<!-- The tab table. !-->
	<TD WIDTH="100%" ALIGN="RIGHT" BGCOLOR="#FFFFFF" VALIGN="BOTTOM"> 
		<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%" ALIGN="RIGHT">
			<TR VALIGN="MIDDLE" ALIGN="LEFT">

<TD BGCOLOR="White" WIDTH="60%">&nbsp;</TD>
<TD BGCOLOR="#FFFFCC"><A HREF="http://cjos.sourceforge.net/archive/">Home</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/info/">Info</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/dev/">DevZone</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFCC66" ALIGN="CENTER"><A
HREF="http://jos.sourceforge.net/">Wiki</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
			</TR>
			<TR>
				<TD BGCOLOR="#FFCC66" ALIGN="RIGHT" COLSPAN="9">
					<A HREF="/view/Users/?PHPSESSID=cabd66ed332018e00220c52a207c79c9">UsersWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Main/?PHPSESSID=cabd66ed332018e00220c52a207c79c9">MainWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Info/?PHPSESSID=cabd66ed332018e00220c52a207c79c9">InfoWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/DevZone/?PHPSESSID=cabd66ed332018e00220c52a207c79c9">DevZoneWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Support/?PHPSESSID=cabd66ed332018e00220c52a207c79c9">SupportWeb</A>
				</TD>
			</TR>
		</TABLE>
	</TD>		
</TR>
<!-- The WikiHeader. !-->
<TR><TD COLSPAN="2">
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="CENTER">
		<B>[&nbsp;<a href="/info//IdentifySystemClasses?PHPSESSID=cabd66ed332018e00220c52a207c79c9">IdentifySystemClasses</a>&nbsp;]</B>
	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="CENTER">
		<B>[ not logged in ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="CENTER">
		<B>[ Web: <a href="/view/Imported/?PHPSESSID=cabd66ed332018e00220c52a207c79c9">Imported</a> ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFCC66" VALIGN="CENTER">
		goto:&nbsp;<INPUT TYPE="TEXT" SIZE="10" NAME="topic"><!--<INPUT TYPE="IMAGE" SRC="/media/go.gif?PHPSESSID=cabd66ed332018e00220c52a207c79c9" BORDER="0" VALUE="topic" ALT="goto">!-->&nbsp;<a href="/search.php?PHPSESSID=cabd66ed332018e00220c52a207c79c9"><FONT SIZE="-1">options</FONT></a>
	</TD>
</TR>
</TABLE>

<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
	<TR>
	<TD ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="TOP">
		[&nbsp;get <a href="/info/Imported/IdentifySystemClasses?PHPSESSID=cabd66ed332018e00220c52a207c79c9">info</a> on or <a href="/edit/Imported/IdentifySystemClasses?PHPSESSID=cabd66ed332018e00220c52a207c79c9">edit</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="TOP">
		[&nbsp;<a href="/user.php?op=login&redirect=%2Fview%2F%2FIdentifySystemClasses&PHPSESSID=cabd66ed332018e00220c52a207c79c9">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FIdentifySystemClasses&PHPSESSID=cabd66ed332018e00220c52a207c79c9">new&nbsp;user</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="TOP">
		[&nbsp;list of <a href="/topics/Imported/?PHPSESSID=cabd66ed332018e00220c52a207c79c9">topics</a>, <a href="/hubsnodes/Imported/?PHPSESSID=cabd66ed332018e00220c52a207c79c9">hubs&nbsp;&amp;&nbsp;nodes</a>, or <a href="/changes/Imported/?PHPSESSID=cabd66ed332018e00220c52a207c79c9">recent&nbsp;changes</a>&nbsp;]	</TD>
	</TR>
</TABLE>

<!-- From CommonHeader !-->
</TR></TD>
</TABLE>
</FORM>

<!-- start BODY page !-->
<P>
<EM>Article contributed by <a href="/view.php?topic=GilbertHerschberger&PHPSESSID=cabd66ed332018e00220c52a207c79c9">GilbertHerschberger</a><wikitopic GilbertHerschberger /wikitopic>.</EM>
<H4>Introduction</H4>
<P>When given a reference to any class, your program can deteremine if it is a system class or not. How is this possible?</P>
<P>The standard <a href="/view.php?topic=JVM&web=Imported&PHPSESSID=cabd66ed332018e00220c52a207c79c9">JVM</a> <wikitopic JVM /wikitopic>assumes that all system classes are loaded by the <a href="/view.php?topic=PrimordialClassLoader&PHPSESSID=cabd66ed332018e00220c52a207c79c9">PrimordialClassLoader</a><wikitopic PrimordialClassLoader /wikitopic>, which is not a real Java class.</P>
<P>On the other hand, take a look at the methods of the <CODE>java.lang.Class</CODE> itself. There is a method called <CODE>getClassLoader()</CODE>, which is always supposed to return the custom class loader where the class came from.</P>
<P>A system class is loaded by an internal mechanism and does not have a real class loader, so <CODE>getClassLoader</CODE> returns <CODE>null</CODE> for all system classes.</P>
<P>Is this going to be preserved by the <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=cabd66ed332018e00220c52a207c79c9">JOS</a> <wikitopic JOS /wikitopic>JVM?</P>
<P>There are a few things dreadfully wrong with the <CODE>java.lang.ClassLoader</CODE> class. It has no public method, for example, for other requestors to find a class. Without a public method for finding classes, standard loaders don't support any form of Class.forName() for a custom class loader.</P>
<P>This won't work:
<PRE>
public Object getCustomInstance( Object o ) {
  String cn = "custompackage.customclass";
  Class c1 = o.getClass();
  ClassLoader loader = c1.getClassLoader();
  Class c2 = loader.findClass( cn );
  return c2.newInstance();
}
</PRE>
<P>Why doesn't it work? Besides there's no primordial class loader, there is no public <CODE>findClass</CODE> method, common to all custom class loaders.
<P>Maybe Class.forName() should have been an instance method (instead of static).
<P>This won't work:</P>
<PRE>
public Object getCustomInstance( Object o ) {
  String cn = "custompackage.customclass";
  Class c1 = o.getClass();
  Class c2 = c1.forName( cn );
  return c2.newInstance();
}
</PRE>
<P>The line <CODE>Class c2 = c1.forName( cn );</CODE> should use the custom class loader of that instance of <CODE>java.lang.Class</CODE>.</P>
<P>Either one of these two mechanisms would have worked. When you have a custom class loader attached to an archive (.zip or .jar), you must know more about the custom class loader in order to dynamically load other classes in that archive. Different custom class loaders have different methods. That is not good or useful.</P>
<H4>Public loadClass()</H4>
<P>Some custom class loaders make the loadClass() method public, instead of keeping it protected. The loadClass() method should be protected. Making it public is a symptom of a missing method, like findClass(). Requestors of a custom class loader can't count on a public loadClass() method.</P><BR><BR></P><!--

<TABLE width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="737b9c">
<TR><TD ALIGN="CENTER">
<a href="/user.php?op=login&redirect=%2Fview%2F%2FIdentifySystemClasses&PHPSESSID=cabd66ed332018e00220c52a207c79c9">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FIdentifySystemClasses&PHPSESSID=cabd66ed332018e00220c52a207c79c9">new&nbsp;user</a><TR><TD>
</TABLE>

!-->
<!-- end BODY page !-->

<HR>

<DIV ALIGN="CENTER">
<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR>
	<TD ALIGN="CENTER" COLSPAN="2">
		Content of these pages are owned and copyrighted by the poster.
	</TD>
</TR>
<TR>
	<TD ALIGN="RIGHT" WIDTH="50%">
		Hosted by:
	</TD>
	<TD ALIGN="LEFT">
		<A HREF="http://sourceforge.net/"><IMG 
			SRC="http://sourceforge.net/sflogo.php?group_id=2376&type=1"
			BORDER=0 HSPACE=0 VSPACE=0></A>
	</TD>
</TR>
</TABLE>
</DIV>
</BODY>
</HTML>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 FINAL//EN">
<HTML>
  <HEAD>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
    <TITLE>SmartAPIPattern.Imported @ jos.sf.net</TITLE>
  </HEAD>

<BODY BGCOLOR="#FFFFFF">

<!-- The FORM encloses the entire header, because it renders better that way. !-->
<FORM ACTION="/jump.php"><input type="hidden" name="PHPSESSID" value="a13b2dcfe0658e80ba11612c98e5d1ec" />

<!-- The JOS logo. !-->
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR VALIGN="TOP" ALIGN="LEFT">
	<TD><A HREF="http://cjos.sourceforge.net/archive/"><IMG 
		VSPACE="0" HSPACE="0" ALIGN="MIDDLE" BORDER="0"
		SRC="http://cjos.sourceforge.net/archive/media/jos_logo_mini.gif"></A></TD>
	<!-- The tab table. !-->
	<TD WIDTH="100%" ALIGN="RIGHT" BGCOLOR="#FFFFFF" VALIGN="BOTTOM"> 
		<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%" ALIGN="RIGHT">
			<TR VALIGN="MIDDLE" ALIGN="LEFT">

<TD BGCOLOR="White" WIDTH="60%">&nbsp;</TD>
<TD BGCOLOR="#FFFFCC"><A HREF="http://cjos.sourceforge.net/archive/">Home</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/info/">Info</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/dev/">DevZone</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFCC66" ALIGN="CENTER"><A
HREF="http://jos.sourceforge.net/">Wiki</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
			</TR>
			<TR>
				<TD BGCOLOR="#FFCC66" ALIGN="RIGHT" COLSPAN="9">
					<A HREF="/view/Users/?PHPSESSID=a13b2dcfe0658e80ba11612c98e5d1ec">UsersWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Main/?PHPSESSID=a13b2dcfe0658e80ba11612c98e5d1ec">MainWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Info/?PHPSESSID=a13b2dcfe0658e80ba11612c98e5d1ec">InfoWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/DevZone/?PHPSESSID=a13b2dcfe0658e80ba11612c98e5d1ec">DevZoneWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Support/?PHPSESSID=a13b2dcfe0658e80ba11612c98e5d1ec">SupportWeb</A>
				</TD>
			</TR>
		</TABLE>
	</TD>		
</TR>
<!-- The WikiHeader. !-->
<TR><TD COLSPAN="2">
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="CENTER">
		<B>[&nbsp;<a href="/info//SmartAPIPattern?PHPSESSID=a13b2dcfe0658e80ba11612c98e5d1ec">SmartAPIPattern</a>&nbsp;]</B>
	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="CENTER">
		<B>[ not logged in ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="CENTER">
		<B>[ Web: <a href="/view/Imported/?PHPSESSID=a13b2dcfe0658e80ba11612c98e5d1ec">Imported</a> ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFCC66" VALIGN="CENTER">
		goto:&nbsp;<INPUT TYPE="TEXT" SIZE="10" NAME="topic"><!--<INPUT TYPE="IMAGE" SRC="/media/go.gif?PHPSESSID=a13b2dcfe0658e80ba11612c98e5d1ec" BORDER="0" VALUE="topic" ALT="goto">!-->&nbsp;<a href="/search.php?PHPSESSID=a13b2dcfe0658e80ba11612c98e5d1ec"><FONT SIZE="-1">options</FONT></a>
	</TD>
</TR>
</TABLE>

<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
	<TR>
	<TD ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="TOP">
		[&nbsp;get <a href="/info/Imported/SmartAPIPattern?PHPSESSID=a13b2dcfe0658e80ba11612c98e5d1ec">info</a> on or <a href="/edit/Imported/SmartAPIPattern?PHPSESSID=a13b2dcfe0658e80ba11612c98e5d1ec">edit</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="TOP">
		[&nbsp;<a href="/user.php?op=login&redirect=%2Fview%2F%2FSmartAPIPattern&PHPSESSID=a13b2dcfe0658e80ba11612c98e5d1ec">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FSmartAPIPattern&PHPSESSID=a13b2dcfe0658e80ba11612c98e5d1ec">new&nbsp;user</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="TOP">
		[&nbsp;list of <a href="/topics/Imported/?PHPSESSID=a13b2dcfe0658e80ba11612c98e5d1ec">topics</a>, <a href="/hubsnodes/Imported/?PHPSESSID=a13b2dcfe0658e80ba11612c98e5d1ec">hubs&nbsp;&amp;&nbsp;nodes</a>, or <a href="/changes/Imported/?PHPSESSID=a13b2dcfe0658e80ba11612c98e5d1ec">recent&nbsp;changes</a>&nbsp;]	</TD>
	</TR>
</TABLE>

<!-- From CommonHeader !-->
</TR></TD>
</TABLE>
</FORM>

<!-- start BODY page !-->
<P>
<FONT SIZE=-1><a href="/view.php?topic=SmartAPIPages&PHPSESSID=a13b2dcfe0658e80ba11612c98e5d1ec">SmartAPIPages</a><wikitopic SmartAPIPages /wikitopic></FONT>
<HR SIZE="1" NOSHADOW>
<EM>Article contributed by <a href="/view.php?topic=GilbertHerschberger&PHPSESSID=a13b2dcfe0658e80ba11612c98e5d1ec">GilbertHerschberger</a><wikitopic GilbertHerschberger /wikitopic> (15 Jul 1999).</EM>
<H4>Introduction</H4>
<P>Here is the pattern for building a <a href="/view.php?topic=SmartAPI&PHPSESSID=a13b2dcfe0658e80ba11612c98e5d1ec">SmartAPI</a><wikitopic SmartAPI /wikitopic>. We refine the factory pattern to create an infinitely expanding factory. We identify each object created by a factory to be a resource, and use a uniform resource locator (or URL).</P>
<P>A smart <nolink>API provides a smart factory. A smart factory is infinitely expandable. It has no convention for which package names can be used for any implementation. A <EM>smart <nolink>API</EM> is a refined approach to making an <nolink>API in Java. The <a href="/view.php?topic=RegistryAPI&PHPSESSID=a13b2dcfe0658e80ba11612c98e5d1ec">RegistryAPI</a><wikitopic RegistryAPI /wikitopic> for the <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=a13b2dcfe0658e80ba11612c98e5d1ec">JOS</a> <wikitopic JOS /wikitopic>Project has helped refined the naming convention and classes necessary to make it work smartly.</P>
<P>Using this pattern, you can create a smart <nolink>API, make the <nolink>API available for <STRONG>other programmers</STRONG> to write implementations of a well-known interface. An infinitely expandable factory means that you can create a mechanism to find a specific implementation of an interface that goes beyond your competition.
<UL>
<LI>Your factory can fully support a large number of implementations right out of the box.
<LI>You can make it easy for your customers to plug in (configure) implementations from you and other programmers.
<LI>You can make it easy for many other programmers to provide both an implementations and an implementation's controller.
<LI>You might provide a default implementation that would be used if no other plug-ins are available.
<LI>Your factory might display a dialog box to ask which implementation you want to use this time.
<LI>Your factory might provide implementations by class name, even displaying a dialog box to type in a class name on the fly.
<LI>Your factory might use the power of the <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=a13b2dcfe0658e80ba11612c98e5d1ec">JOS</a> <wikitopic JOS /wikitopic>registry for maintaining its persistent configuration.
<LI>Like a factory, the behavior of a smart factory can change without recompiling.
<LI>Your factory can provide for more complex type-safe validation, including a requirement for an object to implement multiple interfaces. There are times when you need an object derived from <CODE>java.awt.Component</CODE> that must implement both <CODE>java.lang.Runnable</CODE> and <CODE>java.io.Serializable</CODE>. With a smart factory, it's no problem.
<LI>Your factory can return an implementation based on its ideal properties, rather than its class (or package).
<LI>Your factory can handle singletons, remote objects, and load balancing.
<LI>And, it strongly encourages code reuse. Every program using your factory doesn't need to know all those implementation details.
</UL>
<H4>Diagram</H4>
<P>The following diagram illustrates the smart <nolink>API for an <CODE>Editor</CODE> interface.</P>
<TABLE WIDTH="100%" BORDER="1" BGCOLOR="#EFEFEF">
<TR>
<TD ALIGN="CENTER" VALIGN="TOP">
<TABLE BORDER="1" BGCOLOR="#FFFFCC">
<TR>
<TD>
<STRONG>requestor</STRONG>
</TD>
</TR>
</TABLE>
</TD>
<TD ALIGN="CENTER" VALIGN="TOP">
==&gt;
</TD>
<TD ALIGN="CENTER" VALIGN="TOP" BGCOLOR="#FFFFCC">
<CODE><STRONG>EditorFactory</STRONG></CODE>
<BR>
|<BR>
<TABLE BORDER="1" BGCOLOR="#FFCC00">
<TR>
<TD>
<CODE><STRONG><EM>CustomEditorController</EM></STRONG></CODE>
</TD>
<TD>
==&gt;
</TD>
<TD>
<CODE><STRONG><EM>CustomEditor</EM></STRONG></CODE>
</TD>
</TR>
<TR>
<TD>
<CODE><STRONG><EM>CustomEditorController</EM></STRONG></CODE>
</TD>
<TD>
==&gt;
</TD>
<TD>
<UL>
<LI><CODE><STRONG><EM>CustomEditor-1</EM></STRONG></CODE>
<LI><CODE><STRONG><EM>CustomEditor-2</EM></STRONG></CODE>
<LI>
<LI><CODE><STRONG><EM>CustomEditor-n</EM></STRONG></CODE>
</UL>
</TD>
</TR>
<TR>
<TD>:</TD>
<TD>:</TD>
<TD>:</TD>
</TR>
<TR>
<TD>
<CODE><STRONG><EM>CustomEditorController</EM></STRONG></CODE>
</TD>
<TD>
==&gt;
</TD>
<TD>
<CODE><STRONG><EM>CustomEditor</EM></STRONG></CODE>
</TD>
</TR>
</TABLE>
</TD>
</TR>
</TABLE>
<P>The following is a step-by-step explanation of this diagram.</P>
<OL>
<LI>A <STRONG>requestor</STRONG> wants an editor. The requestor doesn't need to know the exact name of the editor, or if the editor is currently available.</P>
<LI>A requestor uses the well-known <CODE><STRONG>EditorFactory</STRONG></CODE> to get an editor, like this:
<PRE>
  public void example() {
	 String url = "x-editor:?type=text"
	 Editor e = EditorFactory.getFactory().getEditor( url );
  }
</PRE>
<LI>The editor factory is configured for any number of <STRONG>custom editor controllers</STRONG>. All custom editor controllers must implement the well-known <CODE>EditorController</CODE> interface.</P>
<LI>A custom editor controller creates a <STRONG>custom editor</STRONG>, configures it and returns it to the editor factory. The editor factory returns it to the requestor. All custom editors must implement the well-known <CODE>Editor</CODE> interface.</P>
</OL>
<P>This architecture enables a standard <CODE>EditorFactory</CODE> to be expanded infinitely as more custom editors are developed and installed.</P>
<H4>DriverManager</H4>
<P>Inside the <CODE>java.sql.DriverManager</CODE>, there is a similar mechanism. Unfortunately, <CODE>DriverManager</CODE> is a factory that requires you to know more than you really want to know about each <a href="/view.php?topic=JDBC&web=Imported&PHPSESSID=a13b2dcfe0658e80ba11612c98e5d1ec">JDBC</a> <wikitopic JDBC /wikitopic>driver.</P>
<P>What is <CODE>DriverManager</CODE>? It is a connection factory. It is the only class that can create a <CODE>java.sql.Connection</CODE>. The driver manager uses drivers to create connections. There are potentially a large number of drivers. You cannot expect all drivers to be available on every machine. The driver manager had to be expandable somehow.
<P>A mechanism was selected to register individual drivers. Drivers can register themselves (semi-automatically) or you can register a driver with the driver manager manually.</P>
<P>This mechanism means that each Java programmer has to know the name of each implementation of <CODE>java.sql.Driver</CODE>. There is nothing in the <nolink>API itself to automatically load drivers based on a <a href="/view.php?topic=JDBC&web=Imported&PHPSESSID=a13b2dcfe0658e80ba11612c98e5d1ec">JDBC</a> <wikitopic JDBC /wikitopic>URL.</P>
<P>If <CODE>DriverManager</CODE> were a smart factory, it could load drivers automatically based on a <a href="/view.php?topic=JDBC&web=Imported&PHPSESSID=a13b2dcfe0658e80ba11612c98e5d1ec">JDBC</a> <wikitopic JDBC /wikitopic>URL and the large number of drivers could have been supported out of the box. You still don't have to have every driver available on every machine.</P>
<P><CODE>DriverManager</CODE> should have provided a persistent configuration. It should have used <CODE>DriverControllers</CODE> to load drivers automatically.</P>
<H4>Framework vs. <nolink>API</H4>
<P>A framework and <nolink>API are part of the same spectrum, with a framework at one end and an <nolink>API at the other. The Java <nolink>API is both a framework and an <nolink>API. It is a matter of perspective. From a program viewpoint, much of the Java <nolink>API is closer to a framework than <nolink>API. From the <a href="/view.php?topic=JVM&web=Imported&PHPSESSID=a13b2dcfe0658e80ba11612c98e5d1ec">JVM</a> <wikitopic JVM /wikitopic>vendor's viewpoint, the Java <nolink>API is reduced to an <nolink>API, a short list of native methods passed through to a vendor-specific implementation.</P>
<P>While a framework is light on interfaces and heavy on implementations, an <nolink>API is heavy on interfaces, and light on implementations of an interface. A framework is a package of reusable components. An <nolink>API is a package of mostly interfaces, so that other programmers can build compatible frameworks. An <nolink>API is concerned about the signature of a method, rather than a methods implementation. A framework is concerned about providing standard implementations, so that other programmers can build applications.</P>
<H4>Applications vs system programming</H4>
<P>Programming is programming, right? Application and system programming are part of the same programming spectrum, with application programming at one end and system programming at the other. Both the framework and <nolink>API are supposed to be <EM>developed</EM> by system programmers and <EM>used</EM> by application programmers.</P>
<P>Responsibility has shifted from system to application programmers with the introduction of object-orientation. Application programmers build both applications and frameworks. System programmers build <nolink>JVMs and <nolink>APIs.</P>
<H4>An interface</H4>
<P>The smart <nolink>API starts with an interface. For these examples, I will use an interface called <CODE>Editor</CODE>.
<PRE>
public interface Editor {
}
</PRE>
<H4>Editor <nolink>API</H4>
<P>The editor <nolink>API includes an editor factory. The editor factory creates editors based on a uniform resource locator (or <nolink>URL).</P>
<PRE>
public class EditorFactory {
  public static EditorFactory getFactory() {
	 if ( factory == null ) {
		factory = new EditorFactory();
	 }
	 return factory;
  }
  public static void setFactory( EditorFactory v ) {
	 if ( factory != null ) {
		return; // *A! throw an exception
	 }
	 factory = v;
  }
  private static EditorFactory factory;
  protected EditorFactory() {
  }
  public boolean acceptsURL( String url ) {
  :
  }
  public Editor getEditor( String url ) {
  :
  }
}
</PRE>
<H4>Beyond default constructor</H4>
<P>An implementation of an editor may require parameters for an editor's constructor. We cannot go directly from an editor factory to an editor. We must build a two-part editor factory. The first part of the editor factory manages editor controllers; the second part manages editors.</P>
<P><EM>Note:</EM> There may be many different implementations of an Editor. The generic <nolink>API has no knowledge of which packages might contain an implementation of an editor. It has no knowledge of a class name for an editor implementation.</P>
<H4>EditorController</H4>
<P>The editor <nolink>API includes a standard interface for editor controllers. The interface for a controller is part of an <nolink>API.</P>
<PRE>
public interface EditorController {
  public boolean acceptsURL( String url );
  public Editor getEditor( String url );
}
</PRE>
<H4>Factory configuration</H4>
<P>Here are the additional methods for <CODE>EditorFactory</CODE>, which support a factory configuration. This configuration gives the generic <nolink>API the names of editor controllers "installed" on a given machine or classpath.</P>
<PRE>
public class EditorFactory { (cont.)
:
  public void addController( EditorController v ) {
  :
  }
  public void addControllerFor( String className ) {
  :
  }
  public void removeController( EditorController v ) {
  :
  }
  public void removeControllerFor( String className ) {
  }
}
</PRE>
<H4>Default configuration</H4>
<P>A generic editor factory may provide a default configuration in its own constructor. If an editor factory cannot dynamically load the editor controller, none of that controller's editors are available; and yet, the editor factory still continues to function within normal parameters.</P>
<PRE>
public class EditorFactory { (.cont)
:
  protected EditorFactory() {
	 String[] list = {
	 "org.jos.editor.text.TextEditorController",
	 "org.jos.editor.telnet.TelnetEditorController",
	 "org.jos.editor.ftp.FtpEditorController",
	 "org.jos.editor.registry.RegistryEditorController"
	 };
	 int iMax = list.length;
	 for ( int i = 0; i &lt; iMax; i++ ) {
		addControllerFor( list[ i ] );
	 }
  }
:
}
</PRE>
<H4>Registry configuration</H4>
<P>A generic editor factory may get its own configuration out of a system-wide registry.
<PRE>
public class EditorFactory { (cont.)
:
  protected EditorFactory() {
	 String key = "editorfactory/controllers";
	 String list;
	 try {
		Registry r = SystemRegistry.getRegistry();
		String[] list = r.getStringArray( key );
	 }
	 catch ( AccessorException e ) {
		list = {
		"org.jos.editor.text.TextEditorController",
		"org.jos.editor.telnet.TelnetEditorController",
		"org.jos.editor.ftp.FtpEditorController",
		"org.jos.editor.registry.RegistryEditorController"
		};
	 }
	 int iMax = list.length;
	 for ( int i = 0; i &lt; iMax; i++ ) {
		addControllerFor( list[ i ] );
	 }
  }
:
}
</PRE><BR><BR></P><!--

<TABLE width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="737b9c">
<TR><TD ALIGN="CENTER">
<a href="/user.php?op=login&redirect=%2Fview%2F%2FSmartAPIPattern&PHPSESSID=a13b2dcfe0658e80ba11612c98e5d1ec">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FSmartAPIPattern&PHPSESSID=a13b2dcfe0658e80ba11612c98e5d1ec">new&nbsp;user</a><TR><TD>
</TABLE>

!-->
<!-- end BODY page !-->

<HR>

<DIV ALIGN="CENTER">
<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR>
	<TD ALIGN="CENTER" COLSPAN="2">
		Content of these pages are owned and copyrighted by the poster.
	</TD>
</TR>
<TR>
	<TD ALIGN="RIGHT" WIDTH="50%">
		Hosted by:
	</TD>
	<TD ALIGN="LEFT">
		<A HREF="http://sourceforge.net/"><IMG 
			SRC="http://sourceforge.net/sflogo.php?group_id=2376&type=1"
			BORDER=0 HSPACE=0 VSPACE=0></A>
	</TD>
</TR>
</TABLE>
</DIV>
</BODY>
</HTML>

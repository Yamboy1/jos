<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 FINAL//EN">
<HTML>
  <HEAD>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
    <TITLE>SmartAPIAsNeeded.Main @ jos.sf.net</TITLE>
  </HEAD>

<BODY BGCOLOR="#FFFFFF">

<!-- The FORM encloses the entire header, because it renders better that way. !-->
<FORM ACTION="/jump.php"><input type="hidden" name="PHPSESSID" value="98efdeaf0abd77866b023f5beff23b83" />

<!-- The JOS logo. !-->
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR VALIGN="TOP" ALIGN="LEFT">
	<TD><A HREF="http://cjos.sourceforge.net/archive/"><IMG 
		VSPACE="0" HSPACE="0" ALIGN="MIDDLE" BORDER="0"
		SRC="http://cjos.sourceforge.net/archive/media/jos_logo_mini.gif"></A></TD>
	<!-- The tab table. !-->
	<TD WIDTH="100%" ALIGN="RIGHT" BGCOLOR="#FFFFFF" VALIGN="BOTTOM"> 
		<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%" ALIGN="RIGHT">
			<TR VALIGN="MIDDLE" ALIGN="LEFT">

<TD BGCOLOR="White" WIDTH="60%">&nbsp;</TD>
<TD BGCOLOR="#FFFFCC"><A HREF="http://cjos.sourceforge.net/archive/">Home</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/info/">Info</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/dev/">DevZone</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFCC66" ALIGN="CENTER"><A
HREF="http://jos.sourceforge.net/">Wiki</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
			</TR>
			<TR>
				<TD BGCOLOR="#FFCC66" ALIGN="RIGHT" COLSPAN="9">
					<A HREF="/view/Users/?PHPSESSID=98efdeaf0abd77866b023f5beff23b83">UsersWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Main/?PHPSESSID=98efdeaf0abd77866b023f5beff23b83">MainWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Info/?PHPSESSID=98efdeaf0abd77866b023f5beff23b83">InfoWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/DevZone/?PHPSESSID=98efdeaf0abd77866b023f5beff23b83">DevZoneWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Support/?PHPSESSID=98efdeaf0abd77866b023f5beff23b83">SupportWeb</A>
				</TD>
			</TR>
		</TABLE>
	</TD>		
</TR>
<!-- The WikiHeader. !-->
<TR><TD COLSPAN="2">
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="CENTER">
		<B>[&nbsp;<a href="/info//SmartAPIAsNeeded?PHPSESSID=98efdeaf0abd77866b023f5beff23b83">SmartAPIAsNeeded</a>&nbsp;]</B>
	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="CENTER">
		<B>[ not logged in ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="CENTER">
		<B>[ Web: <a href="/view/Main/?PHPSESSID=98efdeaf0abd77866b023f5beff23b83">Main</a> ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFCC66" VALIGN="CENTER">
		goto:&nbsp;<INPUT TYPE="TEXT" SIZE="10" NAME="topic"><!--<INPUT TYPE="IMAGE" SRC="/media/go.gif?PHPSESSID=98efdeaf0abd77866b023f5beff23b83" BORDER="0" VALUE="topic" ALT="goto">!-->&nbsp;<a href="/search.php?PHPSESSID=98efdeaf0abd77866b023f5beff23b83"><FONT SIZE="-1">options</FONT></a>
	</TD>
</TR>
</TABLE>

<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
	<TR>
	<TD ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="TOP">
		[&nbsp;get <a href="/info/Main/SmartAPIAsNeeded?PHPSESSID=98efdeaf0abd77866b023f5beff23b83">info</a> on or <a href="/edit/Main/SmartAPIAsNeeded?PHPSESSID=98efdeaf0abd77866b023f5beff23b83">edit</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="TOP">
		[&nbsp;<a href="/user.php?op=login&redirect=%2Fview%2F%2FSmartAPIAsNeeded&PHPSESSID=98efdeaf0abd77866b023f5beff23b83">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FSmartAPIAsNeeded&PHPSESSID=98efdeaf0abd77866b023f5beff23b83">new&nbsp;user</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="TOP">
		[&nbsp;list of <a href="/topics/Main/?PHPSESSID=98efdeaf0abd77866b023f5beff23b83">topics</a>, <a href="/hubsnodes/Main/?PHPSESSID=98efdeaf0abd77866b023f5beff23b83">hubs&nbsp;&amp;&nbsp;nodes</a>, or <a href="/changes/Main/?PHPSESSID=98efdeaf0abd77866b023f5beff23b83">recent&nbsp;changes</a>&nbsp;]	</TD>
	</TR>
</TABLE>

<!-- From CommonHeader !-->
</TR></TD>
</TABLE>
</FORM>

<!-- start BODY page !-->
<P>
<a href="/view.php?topic=SmartAPIPages&PHPSESSID=98efdeaf0abd77866b023f5beff23b83">SmartAPIPages</a><wikitopic SmartAPIPages /wikitopic>
<HR>
<EM>Article contributed by <a href="/view.php?topic=GilbertHerschberger&PHPSESSID=98efdeaf0abd77866b023f5beff23b83">GilbertHerschberger</a><wikitopic GilbertHerschberger /wikitopic> (3 July 2001).</EM>
<H4>Introduction</H4>
The next version of the <EM>Smart <nolink>API</EM> will be able to load controllers as needed, rather than all controllers at once. This is expected to improve run-time performance. Controllers which are never used will never be loaded.
</P><P>
In all previous versions, there is a direct relationship between the default controller and custom controllers. Custom controllers are loaded when the default controller is loaded, all at one time, usually when an application is starting up.
</P><P>
To be clear, this is not inherent in the previous design. It is just the way the majority of the recommended controllers were designed. At the dawn of a new version of this API, it seems to be an opportunity to improve the recommended controllers.
<H4>Version 3a</H4>
The next version is 3a. It uses a transaction object to pass a request to a chain of controllers, instead of a string used in previous versions. The transaction object provides convenient methods to decode a request. Here are some of its proposed methods:
<UL> <LI> <CODE>getScheme()</CODE>
<LI> <CODE>getSubscheme()</CODE>
<LI> <CODE>popScheme()</CODE>
<LI> <CODE>getMessages()</CODE>
<LI> <CODE>addMessage()</CODE>
</UL> <H4>Dependency</H4>
The next version may depend on previous versions. Good controllers should not go to waste. In fact, it may be very helpful for old controllers to work with new controllers. A new controller must be light-weight and only load an object factory as needed. If a new controller implements the same scheme as an old one, the old controller can serve as the object factory.
<H4>Robust, rugged</H4>
Every version has been robust. If controller requires a specific class and that class is missing, it disables only one scheme. It does not disable them all. A general-purpose object factory serves up many kinds of objects. It depends on a run-time environment to serve up objects. A rugged factory serves up as many kinds of objects as possible.
<H4>As needed</H4>
Taking this one more step, an object factory can load controllers as needed. It is possible to load the general-purpose object factory without loading a controller for every imaginable kind of object. A controller should have a helper. A helper must recognize the scheme supported by the corresponding controller. If the helper accepts the scheme, it can replace itself dynamically with the corresponding controller.
</P><P>
As far as an application is concerned, version 3a produces the same results; it only loads faster. There are subtle differences in the timing of potential exceptions. The new version will be implemented in the <CODE>org.jos.smartapi3a</CODE> package. This means that you'll need to upgrade your applications intentionally, not accidentally. As you upgrade, you should pay close attention to your application.
</P><P>
Version 3a provides a mechanism for controller messages. A controller adds one or more messages to a transaction as it fulfills a request. Your application can check these messages. Messages should help expecially if a controller fails to produce the requested object.
<H4>Example</H4>
The design of your calling method remains basically the same. Here is a snippet using the old <nolink>API.
<PRE>
  public void example1( String spec ) {
    URI uri = new URI( spec );
    SomeClass o = (SomeClass) uri.getObject();
    if ( o == null ) {
      System.out.println( "o == null" );
      return;
    }
    :
  }
</PRE>
Here is a snippet using the new <nolink>API.
<PRE>
  public void example1( String spec ) {
    URI uri = new URI( spec );
    SomeClass o = (SomeClass) uri.getObject();
    if ( o == null ) {
      System.out.println( uri.getMessage() );
      return;
    }
    :
  }
</PRE>
<HR>
It is neither necessary nor desirable to exclude advanced features from version 2a. If version 3a depends on version 2a, version 2a should be enabled to load controllers as needed.
</P><P>
Within the process of enabling version 2a to load controllers as needed, it might be possible to further document the schemes supported by default.
</P><P>
How can we implement the as-needed feature?
</P><P>
Likely, it is possible to create a factory1c package. This package should be compatible with version 2a. It should include as-needed controllers. An as-needed controller might be consistently triggered by a given scheme or scheme/subscheme. Some controllers are always needed; some work could be eliminated to concentrate on loading optional controllers as needed.
<UL> <LI> The "in:" and "out:" schemes have many subschemes.
<LI> The "run:" scheme has many subschemes.
</UL> Unlike factory1b, factory1c should install a proxy controller. A proxy controller must match the acceptsURI() method of a real controller perfectly. It might be necessary to break out the acceptsURI() method from the real controller so that both the proxy and real controllers use the same implementation of acceptsURI().
</P><P>
-- <a href="/view.php?topic=GilbertHerschberger&PHPSESSID=98efdeaf0abd77866b023f5beff23b83">GilbertHerschberger</a><wikitopic GilbertHerschberger /wikitopic> (19 July 2001)
<HR>
Again, how do we implement the as-needed feature? It might be possible to design a more generic proxy controller, called <nolink>ProxyController.
<OL> <LI> The scheme property provides the scheme accepted by the real controller.
<LI> The classname property provides the class name of the real controller.
<LI> In the beginning, the controller property is null.
<LI> When getObject() is invoked for the given scheme, it sets the controller property to an instance of the given class name.
</OL> 
A proxy controller may be given a scheme that does not match the real controller. Therefore, the getObject() method should invoke both its own acceptURI() method and the real controller's acceptURI() method. A mis-match should be logged.
</P><P>
<PRE>
public class ProxyController
    extends BaseController {
  public ProxyController( String s, String cn ) {
    super( s );
    className = cn;
  }
  public String getClassName() {
    return className;
  }
  public Controller getController() {
    return controller;
  }
  public getObject( String v ) {
    if ( !acceptsURI( v ) ) {
      return null;
    }
  }
  private String className;
  private Controller controller;
}
</pre>
</P><P>
-- <a href="/view.php?topic=GilbertHerschberger&PHPSESSID=98efdeaf0abd77866b023f5beff23b83">GilbertHerschberger</a><wikitopic GilbertHerschberger /wikitopic> (26 March 2004)<BR><BR></P><!--

<TABLE width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="737b9c">
<TR><TD ALIGN="CENTER">
<a href="/user.php?op=login&redirect=%2Fview%2F%2FSmartAPIAsNeeded&PHPSESSID=98efdeaf0abd77866b023f5beff23b83">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FSmartAPIAsNeeded&PHPSESSID=98efdeaf0abd77866b023f5beff23b83">new&nbsp;user</a><TR><TD>
</TABLE>

!-->
<!-- end BODY page !-->

<HR>

<DIV ALIGN="CENTER">
<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR>
	<TD ALIGN="CENTER" COLSPAN="2">
		Content of these pages are owned and copyrighted by the poster.
	</TD>
</TR>
<TR>
	<TD ALIGN="RIGHT" WIDTH="50%">
		Hosted by:
	</TD>
	<TD ALIGN="LEFT">
		<A HREF="http://sourceforge.net/"><IMG 
			SRC="http://sourceforge.net/sflogo.php?group_id=2376&type=1"
			BORDER=0 HSPACE=0 VSPACE=0></A>
	</TD>
</TR>
</TABLE>
</DIV>
</BODY>
</HTML>

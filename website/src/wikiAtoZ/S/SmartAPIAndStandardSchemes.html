<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 FINAL//EN">
<HTML>
  <HEAD>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
    <TITLE>SmartAPIAndStandardSchemes.Imported @ jos.sf.net</TITLE>
  </HEAD>

<BODY BGCOLOR="#FFFFFF">

<!-- The FORM encloses the entire header, because it renders better that way. !-->
<FORM ACTION="/jump.php"><input type="hidden" name="PHPSESSID" value="062538dafc64608a577bf4bf42336639" />

<!-- The JOS logo. !-->
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR VALIGN="TOP" ALIGN="LEFT">
	<TD><A HREF="http://cjos.sourceforge.net/archive/"><IMG 
		VSPACE="0" HSPACE="0" ALIGN="MIDDLE" BORDER="0"
		SRC="http://cjos.sourceforge.net/archive/media/jos_logo_mini.gif"></A></TD>
	<!-- The tab table. !-->
	<TD WIDTH="100%" ALIGN="RIGHT" BGCOLOR="#FFFFFF" VALIGN="BOTTOM"> 
		<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%" ALIGN="RIGHT">
			<TR VALIGN="MIDDLE" ALIGN="LEFT">

<TD BGCOLOR="White" WIDTH="60%">&nbsp;</TD>
<TD BGCOLOR="#FFFFCC"><A HREF="http://cjos.sourceforge.net/archive/">Home</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/info/">Info</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/dev/">DevZone</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFCC66" ALIGN="CENTER"><A
HREF="http://jos.sourceforge.net/">Wiki</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
			</TR>
			<TR>
				<TD BGCOLOR="#FFCC66" ALIGN="RIGHT" COLSPAN="9">
					<A HREF="/view/Users/?PHPSESSID=062538dafc64608a577bf4bf42336639">UsersWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Main/?PHPSESSID=062538dafc64608a577bf4bf42336639">MainWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Info/?PHPSESSID=062538dafc64608a577bf4bf42336639">InfoWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/DevZone/?PHPSESSID=062538dafc64608a577bf4bf42336639">DevZoneWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Support/?PHPSESSID=062538dafc64608a577bf4bf42336639">SupportWeb</A>
				</TD>
			</TR>
		</TABLE>
	</TD>		
</TR>
<!-- The WikiHeader. !-->
<TR><TD COLSPAN="2">
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="CENTER">
		<B>[&nbsp;<a href="/info//SmartAPIAndStandardSchemes?PHPSESSID=062538dafc64608a577bf4bf42336639">SmartAPIAndStandardSchemes</a>&nbsp;]</B>
	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="CENTER">
		<B>[ not logged in ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="CENTER">
		<B>[ Web: <a href="/view/Imported/?PHPSESSID=062538dafc64608a577bf4bf42336639">Imported</a> ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFCC66" VALIGN="CENTER">
		goto:&nbsp;<INPUT TYPE="TEXT" SIZE="10" NAME="topic"><!--<INPUT TYPE="IMAGE" SRC="/media/go.gif?PHPSESSID=062538dafc64608a577bf4bf42336639" BORDER="0" VALUE="topic" ALT="goto">!-->&nbsp;<a href="/search.php?PHPSESSID=062538dafc64608a577bf4bf42336639"><FONT SIZE="-1">options</FONT></a>
	</TD>
</TR>
</TABLE>

<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
	<TR>
	<TD ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="TOP">
		[&nbsp;get <a href="/info/Imported/SmartAPIAndStandardSchemes?PHPSESSID=062538dafc64608a577bf4bf42336639">info</a> on or <a href="/edit/Imported/SmartAPIAndStandardSchemes?PHPSESSID=062538dafc64608a577bf4bf42336639">edit</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="TOP">
		[&nbsp;<a href="/user.php?op=login&redirect=%2Fview%2F%2FSmartAPIAndStandardSchemes&PHPSESSID=062538dafc64608a577bf4bf42336639">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FSmartAPIAndStandardSchemes&PHPSESSID=062538dafc64608a577bf4bf42336639">new&nbsp;user</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="TOP">
		[&nbsp;list of <a href="/topics/Imported/?PHPSESSID=062538dafc64608a577bf4bf42336639">topics</a>, <a href="/hubsnodes/Imported/?PHPSESSID=062538dafc64608a577bf4bf42336639">hubs&nbsp;&amp;&nbsp;nodes</a>, or <a href="/changes/Imported/?PHPSESSID=062538dafc64608a577bf4bf42336639">recent&nbsp;changes</a>&nbsp;]	</TD>
	</TR>
</TABLE>

<!-- From CommonHeader !-->
</TR></TD>
</TABLE>
</FORM>

<!-- start BODY page !-->
<P>
<FONT SIZE=-1><a href="/view.php?topic=SmartAPIPages&PHPSESSID=062538dafc64608a577bf4bf42336639">SmartAPIPages</a><wikitopic SmartAPIPages /wikitopic></FONT>
<HR SIZE="1" NOSHADOW>
<EM>Article contributed by <a href="/view.php?topic=GilbertHerschberger&PHPSESSID=062538dafc64608a577bf4bf42336639">GilbertHerschberger</a><wikitopic GilbertHerschberger /wikitopic> (28 July 1999).</EM>
<H4>Introduction</H4>
<P>When the smart object factory is presented with a standard scheme, what should it do? It should return a <CODE>java.net.URL</CODE> object. Therefore, we need a <CODE>URLController</CODE>.</P>
<H4>Using <CODE>java.net.URL</CODE></H4>
<P>Once the object factory has returned an instance of <CODE>java.net.URL</CODE>, you can use its methods to open an input stream.</P>
<PRE>
  public void example() {
	 String s = "http://www.jos.org/wiki/view/main/SmartAPI";
	 URL url = (URL) new URI( s ).getObject();
	 if ( url == null ) {
		return;
	 }
	 InputStream in = url.openStream();
	 :
	 in.close();
  }
</PRE>
<P>Why not just create a <CODE>java.net.URL</CODE> directly? You use the <CODE>java.net.URL</CODE> directly, if you want. When you write an interactive <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=062538dafc64608a577bf4bf42336639">JOS</a> <wikitopic JOS /wikitopic>program, the end-user can type in <STRONG>any URI</STRONG>. Some URIs will be compatible with the <CODE>java.net.URL</CODE> class, and some won't.</P>
<H4><CODE>URLController</CODE> class</H4>
<P>The <a href="/view.php?topic=URL&web=Imported&PHPSESSID=062538dafc64608a577bf4bf42336639">URL</a> <wikitopic URL /wikitopic>controller always returns a <CODE>java.net.URL</CODE>; or, null when presented with a malformed URL.</P>
<TABLE WIDTH="100%" BGCOLOR="#EFEFEF">
<TR>
<TD>
<PRE>
public class URLController
	 implements Controller {
  public URLController() {
  }
  public boolean acceptsURI( String v ) {
	 try {
		new URL( v );
		return true;
	 }
	 catch( MalformedURLException e ) {
		return false;
	 }
  }
  public Object getObject( String v ) {
	 try {
		return new URL( v );
	 }
	 catch( MalformedURLException e ) {
		return null;
	 }
  }
}
</PRE>
</TD>
</TR>
</TABLE>
<H4>Client agent uses object factory</H4>
<P>If you want to build a future-compatible browser, your browser should use the smart object factory. How does a browser handle the diffent types of objects return-able by the factory? A hard-wired browser responds to an object's class:
<PRE>
  public void display( String v ) {
	 Object o = new URI( v ).getObject();
	 if ( o == null ) {
		// object not found
		return;
	 }

	 if ( o instanceof &lt;STRONG&gt;URL&lt;/STRONG&gt; ) {
		// do the java.net.URL thing
		return;
	 }

	 if ( o instanceof &lt;STRONG&gt;InputStream&lt;/STRONG&gt; ) {
		DataInputStream di;
		if ( o instanceof DataInputStream ) {
		  di = (DataInputStream) o;
		}
		else {
		  di = new DataInputStream( (InputStream) o );
		}
		for (;;) {
		  println( di.readLine() );
		}
		((InputStream) o).close();
		return;
	 }

	 if ( o instanceof &lt;STRONG&gt;StreamTokenizer&lt;/STRONG&gt; ) {
		StreamTokenizer st = (StreamTokenizer) o;
		for (;;) {
		  println( t.getNextToken() );
		}
		st.close();
	 }

	 if ( o instanceof &lt;STRONG&gt;OutputStream&lt;/STRONG&gt; ) {
		PrintStream ps;
		if ( o instanceof PrintStream ) {
		  ps = (PrintStream) o;
		}
		else {
		  ps = new PrintStream( (InputStream) o );
		}
		for (;;) {
		  ps.println( readLine() );
		}
		((OutputStream) o).close();
	 }
	 :
  }
</PRE>
<P>An advanced future-oriented client agent uses content handlers. The content handler manager provides a mechanism for plug-ins. Such a client agent would prefix the handler: protocol to a <nolink>URI provided by the user:</P>
<PRE>
http://www.jos.org/wiki/view/main/SmartAPI#arch
</PRE>
becomes
<PRE>
handler:http://www.jos.org/wiki/view/main/SmartAPI
</PRE>
before the client agent sends a request to the smart object factory. The handler: protocol is supported by a handler controller, which I won't go into here.</P>
<H4>Standard schemes</H4>
<P>The <CODE>java.net.URL</CODE> class provides for a small set of standard schemes. These standard schemes must be fully supported by the smart object factory. As for the priority of the standard schemes, the <a href="/view.php?topic=URL&web=Imported&PHPSESSID=062538dafc64608a577bf4bf42336639">URL</a> <wikitopic URL /wikitopic>controller should be the first controller used by the smart object factory. You are free to change the priority of controllers for your machine. The default configuration should set a high priority for the <a href="/view.php?topic=URL&web=Imported&PHPSESSID=062538dafc64608a577bf4bf42336639">URL</a> <wikitopic URL /wikitopic>controller.
<H4>Controller priority</H4>
<P>In place of a flat list of controllers, the smart factory could be improved a little with the introduction of a priority property. Each controller might have a priority property (from 1 to 100?). When you set the priority of a controller, a factory must use higher priority controllers first.</P>
<P>Release 1a of the smart factory uses the order in which controllers are added to a factory to determine controller priority. The first controller added has the highest priority. When a registry is used to configure a smart factory, the priority is used to determine the order controllers should be added to a factory. The priority does not have to be part of the factory, only the mechanism to configure a factory.</P>
<P>A priority property could simply be HIGH=100, REGULAR=50 and LOW=1. When configuring a factory with the registry, it might be easier to set a priority property than keep the controllers in order by priority.</P>
<PRE>
; org/jos/demo/object-alt1.ini
[awt]
class=org.jos.demo.AWTFactory

[class]
class=org.jos.demo.ClassFactory

[registry]
class=org.jos.demo.RegistryFactory

[swing]
class=org.jos.demo.SwingFactory

[stream]
class=org.jos.demo.StreamFactory

[url]
class=org.jos.demo.URLController
priority=HIGH
</PRE>
<H4>Dynamic configuration</H4>
<P>While a default constructor (and the registry) provide a smart factory with a default configuration, the configuration of a factory is truely dynamic. A program can add a controller to a factory at any time. As soon as a controller has been added, it can be used.</P>
<P>For example, a program that does not get an object in response to a valid <nolink>URI can add a controller to a smart factory <STRONG>and try again</STRONG>.</P>
<P>When you edit the configuration of a smart factory, you can re-configure the factory without restarting your <a href="/view.php?topic=JVM&web=Imported&PHPSESSID=062538dafc64608a577bf4bf42336639">JVM</a> <wikitopic JVM /wikitopic>or kernel. The configuration of a smart factory is transient. Runtime changes to a factory configuration are not saved implicitely.</P>
<P>You can upgrade. As a <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=062538dafc64608a577bf4bf42336639">JOS</a> <wikitopic JOS /wikitopic>end-user, you're free to download and install new controllers without restarting your OS. You can downgrade. If you don't like the result, you restore the configuration without restarting your OS. <EM>Caution:</EM> Controllers that use native methods may be an exception.</P>
<P>You can be creative. As a <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=062538dafc64608a577bf4bf42336639">JOS</a> <wikitopic JOS /wikitopic>programmer, you're free to experiment with new controllers and see how they affect the performance of all your existing application software. <EM>Caution:</EM> After using a controller, you may have to force its classes to be unloaded by your JVM. Your class is useable as soon as it is compiled, but, not re-useable. You may have to restart your JVM.</P>
<P>On the other hand, objects already created by a smart factory are unaffected by subsequent configuration changes.</P>
<H4>Supreme debugging</H4>
<P>Go way beyond current debugging techniques. Not only can you log all of the transactions of a smart object factory, you can create a new controller to use for debugging.
<UL>
<LI>A debugging controller can return an object wrapper when asked for an object. You can trace all of the interactions of an object through an object wrapper. You can single-step through the use of any object returned by the object factory.
<LI> You can configure your debugging controller. For example, you can test for worst-case scenarios in your own code and in the code from other programs. You can configure a debugging controller to always return <CODE>null</CODE>. Experiment. See what happens.</P>
</UL>
<H4>Remote objects</H4>
<P>In a distributed computing environment, the smart object factory is asking for an object. It doesn't know the difference between a local object and a remote one. When you fully embrace the smart factory, you can create remote controllers, replacements for the local controllers found in the standard smart <nolink>API.</P>
<P>To isolate remote objects, you can configure a remote controller to factory objects from a specific host. You can configure a remote controller to return local objects for everything except for the object you're testing.</P>
<P>You can debug inside your distributed computing environment. The network connection should be a property of a controller; or, shared among controllers. The controller uses its network connection to create proxies for objects requested. The <nolink>URI string is forwarded across a connection to a remote machine. The program on the remote machine uses its object factory to create an object.</P>
<P>When you build an environment for other people to use, they don't have to know (do they?) that their object factory has been configured to create remote objects for some things and local objects for others. If you are an administrator, from your own desk you can reconfigure a client machine for new server without restarting the client machine's OS.</P>
<P>When asking a smart object factory for a program or process, a smart factory may return a proxy for a remote object. For embedded devices, a smart object factory may be configured to use remote objects for just about everything.</P><BR><BR></P><!--

<TABLE width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="737b9c">
<TR><TD ALIGN="CENTER">
<a href="/user.php?op=login&redirect=%2Fview%2F%2FSmartAPIAndStandardSchemes&PHPSESSID=062538dafc64608a577bf4bf42336639">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FSmartAPIAndStandardSchemes&PHPSESSID=062538dafc64608a577bf4bf42336639">new&nbsp;user</a><TR><TD>
</TABLE>

!-->
<!-- end BODY page !-->

<HR>

<DIV ALIGN="CENTER">
<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR>
	<TD ALIGN="CENTER" COLSPAN="2">
		Content of these pages are owned and copyrighted by the poster.
	</TD>
</TR>
<TR>
	<TD ALIGN="RIGHT" WIDTH="50%">
		Hosted by:
	</TD>
	<TD ALIGN="LEFT">
		<A HREF="http://sourceforge.net/"><IMG 
			SRC="http://sourceforge.net/sflogo.php?group_id=2376&type=1"
			BORDER=0 HSPACE=0 VSPACE=0></A>
	</TD>
</TR>
</TABLE>
</DIV>
</BODY>
</HTML>

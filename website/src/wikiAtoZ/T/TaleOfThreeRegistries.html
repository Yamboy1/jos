<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 FINAL//EN">
<HTML>
  <HEAD>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
    <TITLE>TaleOfThreeRegistries.Main @ jos.sf.net</TITLE>
  </HEAD>

<BODY BGCOLOR="#FFFFFF">

<!-- The FORM encloses the entire header, because it renders better that way. !-->
<FORM ACTION="/jump.php"><input type="hidden" name="PHPSESSID" value="b767d4cce930c6a07f75d458397b6ecd" />

<!-- The JOS logo. !-->
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR VALIGN="TOP" ALIGN="LEFT">
	<TD><A HREF="http://cjos.sourceforge.net/archive/"><IMG 
		VSPACE="0" HSPACE="0" ALIGN="MIDDLE" BORDER="0"
		SRC="http://cjos.sourceforge.net/archive/media/jos_logo_mini.gif"></A></TD>
	<!-- The tab table. !-->
	<TD WIDTH="100%" ALIGN="RIGHT" BGCOLOR="#FFFFFF" VALIGN="BOTTOM"> 
		<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%" ALIGN="RIGHT">
			<TR VALIGN="MIDDLE" ALIGN="LEFT">

<TD BGCOLOR="White" WIDTH="60%">&nbsp;</TD>
<TD BGCOLOR="#FFFFCC"><A HREF="http://cjos.sourceforge.net/archive/">Home</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/info/">Info</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/dev/">DevZone</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFCC66" ALIGN="CENTER"><A
HREF="http://jos.sourceforge.net/">Wiki</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
			</TR>
			<TR>
				<TD BGCOLOR="#FFCC66" ALIGN="RIGHT" COLSPAN="9">
					<A HREF="/view/Users/?PHPSESSID=b767d4cce930c6a07f75d458397b6ecd">UsersWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Main/?PHPSESSID=b767d4cce930c6a07f75d458397b6ecd">MainWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Info/?PHPSESSID=b767d4cce930c6a07f75d458397b6ecd">InfoWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/DevZone/?PHPSESSID=b767d4cce930c6a07f75d458397b6ecd">DevZoneWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Support/?PHPSESSID=b767d4cce930c6a07f75d458397b6ecd">SupportWeb</A>
				</TD>
			</TR>
		</TABLE>
	</TD>		
</TR>
<!-- The WikiHeader. !-->
<TR><TD COLSPAN="2">
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="CENTER">
		<B>[&nbsp;<a href="/info//TaleOfThreeRegistries?PHPSESSID=b767d4cce930c6a07f75d458397b6ecd">TaleOfThreeRegistries</a>&nbsp;]</B>
	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="CENTER">
		<B>[ not logged in ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="CENTER">
		<B>[ Web: <a href="/view/Main/?PHPSESSID=b767d4cce930c6a07f75d458397b6ecd">Main</a> ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFCC66" VALIGN="CENTER">
		goto:&nbsp;<INPUT TYPE="TEXT" SIZE="10" NAME="topic"><!--<INPUT TYPE="IMAGE" SRC="/media/go.gif?PHPSESSID=b767d4cce930c6a07f75d458397b6ecd" BORDER="0" VALUE="topic" ALT="goto">!-->&nbsp;<a href="/search.php?PHPSESSID=b767d4cce930c6a07f75d458397b6ecd"><FONT SIZE="-1">options</FONT></a>
	</TD>
</TR>
</TABLE>

<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
	<TR>
	<TD ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="TOP">
		[&nbsp;get <a href="/info/Main/TaleOfThreeRegistries?PHPSESSID=b767d4cce930c6a07f75d458397b6ecd">info</a> on or <a href="/edit/Main/TaleOfThreeRegistries?PHPSESSID=b767d4cce930c6a07f75d458397b6ecd">edit</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="TOP">
		[&nbsp;<a href="/user.php?op=login&redirect=%2Fview%2F%2FTaleOfThreeRegistries&PHPSESSID=b767d4cce930c6a07f75d458397b6ecd">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FTaleOfThreeRegistries&PHPSESSID=b767d4cce930c6a07f75d458397b6ecd">new&nbsp;user</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="TOP">
		[&nbsp;list of <a href="/topics/Main/?PHPSESSID=b767d4cce930c6a07f75d458397b6ecd">topics</a>, <a href="/hubsnodes/Main/?PHPSESSID=b767d4cce930c6a07f75d458397b6ecd">hubs&nbsp;&amp;&nbsp;nodes</a>, or <a href="/changes/Main/?PHPSESSID=b767d4cce930c6a07f75d458397b6ecd">recent&nbsp;changes</a>&nbsp;]	</TD>
	</TR>
</TABLE>

<!-- From CommonHeader !-->
</TR></TD>
</TABLE>
</FORM>

<!-- start BODY page !-->
<P>
<a href="/view.php?topic=RegistryPages&PHPSESSID=b767d4cce930c6a07f75d458397b6ecd">RegistryPages</a><wikitopic RegistryPages /wikitopic>
<HR>
<EM>Article contributed by <a href="/view.php?topic=GilbertHerschberger&PHPSESSID=b767d4cce930c6a07f75d458397b6ecd">GilbertHerschberger</a><wikitopic GilbertHerschberger /wikitopic> (15 March 2000, revised 31 May 2002).</EM>
<H4>Introduction</H4>
<EM>Here is a tale for all to see. There is not one registry, but three.</EM>
</P><P>
Transient and persistent registries are different kinds of registries. Both have a similar interface. Both are branches of a registry tree. Both are part of a uniform registry model. They are different because the kinds of objects they manage are different. This article shows how it works.
</P><P>
Objects are still objects regardless of whether they are transient or persistent. All requests to a uniform registry model will returns an object.
<PRE>
  public Object getObject(...);
</PRE>
Most properties for hardware are <EM>transient</EM>, changing quickly from one moment to the next. Such properties are stored in the hardware and reflected in a software object. Proxy objects that represent hardware are themselves transient, not persistent. They don't fit into a persistent registry.
<H4>History</H4>
At first, registries were non-existant. Configuration was determined at compile-time or link-time. Both commercial and non-commercial programs were delivered in source code for the purpose of custom configuration. The source code had to be modified and programs compiled to change the configuration. This kind of registry is program-wide. <EM>This is still the most widely practiced option.</EM>
</P><P>
And then, there was one. Configuration was determined at run-time. Configuration was imported from a file. Importing a configuration file is a form of <EM>data</EM> registry. Popular file formats include
<UL> <LI> <CODE>.conf</CODE>
<LI> <CODE>.ini</CODE>, and
<LI> <CODE>.properties</CODE>.
</UL> 
The <EM>data</EM> registry evolved into a shared resource. As a shared resource, many programs might share one copy of registry information. The system-wide "registry" of Win32 is a well-known example of a <EM>data</EM> registry. It puts transient and persistent data on different branches of a registry tree.
</P><P>
The <EM>object</EM> registry evolved from shared libraries and distributed computing. A shared library is an object. It participates in an <EM>object</EM> registry.
</P><P>
An object registry is most flexible. Like a data registry, it maintains inert objects, such as string resources and service classes. Unlike a data registry, it maintains active objects, too. It can maintain proxies for local and remote <EM>services</EM>.
<H4>About <nolink>JOS</H4>
A modern operating system, such as JOS, must support all kinds of registries. With each passing decade, a new kind registry was born. A new kind does not replace the kinds that came before.
<OL> <LI> <STRONG>Transitent object registry.</STRONG> A transitent object registry is the perfect location for low-level hardware proxies. The information provided by all of these objects are transient, determined by hardware. None of the objects in an active object registry are persistent. All their properties go away when the power is turned off.
<LI> <STRONG>Persistent object registry.</STRONG> A persistent object registry is the perfect location for high-level services. Some services are designed around checkpoints. Their state must be restored to the last checkpoint saved. All of the objects in a persistent registry are persistent. They must implement a consistent persistence mechanism so that system-wide checkpoints are consistent. Such a mechanism does not imply Java persistence or serialization. An object only needs to implement the <CODE>checkpoint()</CODE> method.
<LI> <STRONG>Persistent data registry.</STRONG> A <EM>data</EM> registry maintains inert objects. Data objects are low-level objects that are easily stored, using in an I/O stream. In Java, this includes <EM>primatives</EM>, the built-in data types that are not really objects after all. All primatives are persistent. It also includes <CODE>java.lang.String</CODE> and some sort of collection for storing data and their corresponding keys.
</OL> <H4>How it works</H4>
Let's take a look at the interaction between an transient object registry and a persistent object registry. Both kinds of registries maintain objects. For hardware, an active object registry is a collection of objects, where each object represents a low-level limited resource.
<UL> <LI> <STRONG>An object in a transient registry cannot be distributed.</STRONG> A hardware proxy works exclusively in the context of a single machine. The proxy object for a parallel port or video graphics adapter cannot be distributed across a network. Other non-distributable objects include the keyboard port, mouse port, serial port, <nolink>DMA channels, and things like these.
<LI> <STRONG>An object in a transient registry cannot be cloned.</STRONG> There is only one instance of a low-level hardware proxy in a machine. Two or more comm port proxies must not be allowed, for example, fight over the first comm port.
<LI> An object in a transient object registry should not use an object in a persistent object registry.
</UL> 
For software, a persistent object registry represents an abstraction layer of low-level device drivers, services, shared libraries, and other system-wide active objects.
<UL> <LI> <STRONG>A persistent object registry <EM>exports</EM> data to a data registry.</STRONG> A persistent registry is itself persistent. The <CODE>checkpoint()</CODE> method forces the registry to store a checkpoint of its current state. A registry must do this in such a way that the state information is <EM>consistent</EM>.
<LI> <STRONG>A persistent object registry <EM>imports</EM> data from a data registry.</STRONG> Persistent objects must resume from their previous checkpoint. Data from a data registry is used to restore all objects in the persistent object registry. A registry restores the state of all objects before becoming <EM>active</EM>.
<LI> <STRONG>An object in a persistent object registry might use an object in a transient object registry.</STRONG> A print queue, for example, might immediately resume printing a job that it was printing when the service was shut down. It must use a low-level transient object to access the parallel port.
</UL> <H4>Printer example</H4>
The first object that opens the printer port wins. This is part of the important mechanism of the active object registry.
</P><P>
The connection between a print queue and printer port is broken when the operating system is shut down. The print queue gives up its exclusive use of the printer port. This relationship must not be persistent.
</P><P>
If two print queues are configured to use the same printer port, the first print queue wins. The second print queue is not allowed  access to the printer port's proxy object. Here is how it works:
</P><P>
<PRE>
:
import org.jos.hardware.PrinterPort;
:
  public void example() {
    URI uri = new URI( "bcni:org.jos.hardware.PrinterPort?port=1" );
    PrinterPort pp = (PrinterPort) uri.getObject();
    if ( pp == null ) {
      println( "Printer port is busy." );
    }
    pp.println( "Example Page:" );
    pp.close();
  }
</PRE>
The first request returns a printer port proxy. If the physical printer port is missing, the proxy exists and throws an exception when asked to do things it can't do.
</P><P>
Subsequent requests will return null, until such time as the printer port is "closed". A printer port is closed automatically at finalization.
<H4>Summary</H4>
Other low-level hardware works the same way. Because all requests for hardware is URI-based, any interface (past, present and future) can be requested. The set of URIs supported by your machine are not required to match mine. You might have different peripherals than I do.
</P><P>
When it is restarted, the operating system begins a fresh competition for limited hardware resources.<BR><BR></P><!--

<TABLE width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="737b9c">
<TR><TD ALIGN="CENTER">
<a href="/user.php?op=login&redirect=%2Fview%2F%2FTaleOfThreeRegistries&PHPSESSID=b767d4cce930c6a07f75d458397b6ecd">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FTaleOfThreeRegistries&PHPSESSID=b767d4cce930c6a07f75d458397b6ecd">new&nbsp;user</a><TR><TD>
</TABLE>

!-->
<!-- end BODY page !-->

<HR>

<DIV ALIGN="CENTER">
<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR>
	<TD ALIGN="CENTER" COLSPAN="2">
		Content of these pages are owned and copyrighted by the poster.
	</TD>
</TR>
<TR>
	<TD ALIGN="RIGHT" WIDTH="50%">
		Hosted by:
	</TD>
	<TD ALIGN="LEFT">
		<A HREF="http://sourceforge.net/"><IMG 
			SRC="http://sourceforge.net/sflogo.php?group_id=2376&type=1"
			BORDER=0 HSPACE=0 VSPACE=0></A>
	</TD>
</TR>
</TABLE>
</DIV>
</BODY>
</HTML>

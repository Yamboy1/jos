<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 FINAL//EN">
<HTML>
  <HEAD>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
    <TITLE>WhyNotMultiProcessJVM.Main @ jos.sf.net</TITLE>
  </HEAD>

<BODY BGCOLOR="#FFFFFF">

<!-- The FORM encloses the entire header, because it renders better that way. !-->
<FORM ACTION="/jump.php"><input type="hidden" name="PHPSESSID" value="acd9f9a63177b2e25cc56906638c71ba" />

<!-- The JOS logo. !-->
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR VALIGN="TOP" ALIGN="LEFT">
	<TD><A HREF="http://cjos.sourceforge.net/archive/"><IMG 
		VSPACE="0" HSPACE="0" ALIGN="MIDDLE" BORDER="0"
		SRC="http://cjos.sourceforge.net/archive/media/jos_logo_mini.gif"></A></TD>
	<!-- The tab table. !-->
	<TD WIDTH="100%" ALIGN="RIGHT" BGCOLOR="#FFFFFF" VALIGN="BOTTOM"> 
		<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%" ALIGN="RIGHT">
			<TR VALIGN="MIDDLE" ALIGN="LEFT">

<TD BGCOLOR="White" WIDTH="60%">&nbsp;</TD>
<TD BGCOLOR="#FFFFCC"><A HREF="http://cjos.sourceforge.net/archive/">Home</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/info/">Info</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/dev/">DevZone</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFCC66" ALIGN="CENTER"><A
HREF="http://jos.sourceforge.net/">Wiki</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
			</TR>
			<TR>
				<TD BGCOLOR="#FFCC66" ALIGN="RIGHT" COLSPAN="9">
					<A HREF="/view/Users/?PHPSESSID=acd9f9a63177b2e25cc56906638c71ba">UsersWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Main/?PHPSESSID=acd9f9a63177b2e25cc56906638c71ba">MainWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Info/?PHPSESSID=acd9f9a63177b2e25cc56906638c71ba">InfoWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/DevZone/?PHPSESSID=acd9f9a63177b2e25cc56906638c71ba">DevZoneWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Support/?PHPSESSID=acd9f9a63177b2e25cc56906638c71ba">SupportWeb</A>
				</TD>
			</TR>
		</TABLE>
	</TD>		
</TR>
<!-- The WikiHeader. !-->
<TR><TD COLSPAN="2">
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="CENTER">
		<B>[&nbsp;<a href="/info//WhyNotMultiProcessJVM?PHPSESSID=acd9f9a63177b2e25cc56906638c71ba">WhyNotMultiProcessJVM</a>&nbsp;]</B>
	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="CENTER">
		<B>[ not logged in ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="CENTER">
		<B>[ Web: <a href="/view/Main/?PHPSESSID=acd9f9a63177b2e25cc56906638c71ba">Main</a> ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFCC66" VALIGN="CENTER">
		goto:&nbsp;<INPUT TYPE="TEXT" SIZE="10" NAME="topic"><!--<INPUT TYPE="IMAGE" SRC="/media/go.gif?PHPSESSID=acd9f9a63177b2e25cc56906638c71ba" BORDER="0" VALUE="topic" ALT="goto">!-->&nbsp;<a href="/search.php?PHPSESSID=acd9f9a63177b2e25cc56906638c71ba"><FONT SIZE="-1">options</FONT></a>
	</TD>
</TR>
</TABLE>

<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
	<TR>
	<TD ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="TOP">
		[&nbsp;get <a href="/info/Main/WhyNotMultiProcessJVM?PHPSESSID=acd9f9a63177b2e25cc56906638c71ba">info</a> on or <a href="/edit/Main/WhyNotMultiProcessJVM?PHPSESSID=acd9f9a63177b2e25cc56906638c71ba">edit</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="TOP">
		[&nbsp;<a href="/user.php?op=login&redirect=%2Fview%2F%2FWhyNotMultiProcessJVM&PHPSESSID=acd9f9a63177b2e25cc56906638c71ba">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FWhyNotMultiProcessJVM&PHPSESSID=acd9f9a63177b2e25cc56906638c71ba">new&nbsp;user</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="TOP">
		[&nbsp;list of <a href="/topics/Main/?PHPSESSID=acd9f9a63177b2e25cc56906638c71ba">topics</a>, <a href="/hubsnodes/Main/?PHPSESSID=acd9f9a63177b2e25cc56906638c71ba">hubs&nbsp;&amp;&nbsp;nodes</a>, or <a href="/changes/Main/?PHPSESSID=acd9f9a63177b2e25cc56906638c71ba">recent&nbsp;changes</a>&nbsp;]	</TD>
	</TR>
</TABLE>

<!-- From CommonHeader !-->
</TR></TD>
</TABLE>
</FORM>

<!-- start BODY page !-->
<P>
<a href="/view.php?topic=WhyMultiProcessJVM&PHPSESSID=acd9f9a63177b2e25cc56906638c71ba">WhyMultiProcessJVM</a><wikitopic WhyMultiProcessJVM /wikitopic>
<HR>
Article contributed by <a href="/view.php?topic=GilbertHerschberger&PHPSESSID=acd9f9a63177b2e25cc56906638c71ba">GilbertHerschberger</a><wikitopic GilbertHerschberger /wikitopic> (13 September 2000, revised 2 July 2002).
<H4>Introduction</H4>
Read the <a href="/view.php?topic=JavaVirtualMachineSpecification&PHPSESSID=acd9f9a63177b2e25cc56906638c71ba">JavaVirtualMachineSpecification</a><wikitopic JavaVirtualMachineSpecification /wikitopic> carefully. Although it is part of every <EM>virtual</EM> machine and important to the construction of an operating system, virtualization of hardware is not even mentioned.
<UL> <LI> <STRONG>Virtualization of hardware is outside the scope of the Java Virtual Machine Specification.</STRONG>
</UL> Since many foreign operating systems have virtualization of hardware built in, specifying the virtualization of hardware here would have been redundent. Some implementation of a foreign operating system is always required. From its creation onward, a Java Virtual Machine was based upon the assumption of a foreign machine code process to provide all the virtualization of hardware.
</P><P>
A Java Virtual Machine depends heavily upon a foreign operating system. It depends on a foreign operating system a stable machine code process, or virtual machine. A foreign operating system has to do all of the most difficult work. It handles task switching, virtual memory and virtualization of hardware. The Java Virtual Machine is so simple <EM>because</EM> all this complexity is delegated to a foreign operating system.
</P><P>
Take the foreign operating system away and the Java Virtual Machine Specification would be in big trouble. There are no models in the specification for virtualization of hardware. There is no mention of device drivers. There is no mention of a kernel interface. No mention of user account (name/password), file subsystem, protocol stack and many concepts necessary to define an operating system.
</P><P>
Defining a new operating system is ambitious, risky and necessary. Companies have spent billions of US$ to define an new operating system. (We don't have billions, do we?) Many have failed. Most of us are still waiting for an operating system that works. I want an operating system that works for me. That's one reason why I want a new operating system ( <a href="/view.php?topic=IWantANewOS&PHPSESSID=acd9f9a63177b2e25cc56906638c71ba">IWantANewOS</a><wikitopic IWantANewOS /wikitopic> ).
<H4>Abstract machine</H4>
The name of the Java Virtual Machine is mis-leading. A Java Virtual Machine is only virtual when combined with a foreign operating system that supports virtualization of hardware. The specification of the Java Virtual Machine is actually a specification of an abstract Java Machine.
</P><P>
A machine is a finite state machine. While a <EM>real machine</EM> is implemented in hardware, an <EM>abstract machine</EM> is implemented in software. The official specification describes an abstract machine, implemented in software in order to have the widest binary compatibility on foreign operating systems.
<H4>Virtual machine</H4>
This brings us to a <EM>virtual</EM> machine. In the domain of operating systems, a virtual machine involves the virtualization of hardware, and typically, time-slicing. Virtualization creates the illusion that more than one machine exists when it doesn't.
</P><P>
To virtualize a machine, you install specialized software at boot-time. The specialized software enables the processor to switch from one task to another (task switching). It enables the creation of multiple virtual machines. It enables virtual machines to interact carefully with the real machine. For example, only one virtual machine at a time can have access to real hardware devices.
<H4>Memory</H4>
Saving real memory is the primary reason given for building a multi-process virtual machine.
</P><P>
Does a multi-process virtual machine save memory or not?
<H4>Non-standard</H4>
A multi-process virtual machine is inherently more complex than a single process virtual machine. It is non-standard. It is not popular. The Java Virtual Machine specification does not support it.
<H4>Shared bytecode</H4>
Early virtual machines are notorious for wasting memory. Since they depend upon an efficient foreign operating system with pre-existing virtual memory management, saving memory was not a priority. When many virtual machines of this type are running on a foreign operating system, they share only the machine code image; the bytecode image is not shared. So each virtual machine/process is required to load a separate copy of the standard Java class library. This is highly inefficient.
</P><P>
A single process virtual machine can be greatly improved. It can redesigned to save just as much memory as a multi-process virtual machine, if not more.
</P><P>
When bytecode resource is added to an off-the-shelf virtual machine, most of the memory-saving benefits of a multi-process virtual machine disappear. They vanish.
<H4>New theory</H4>
A single process virtual machine can run more efficiently inside a multi-process kernel. When a virtual machine is the only kind of process running on this multi-process kernel, it becomes possible to optimize the kernel for running a virtual machine.
</P><P>
A virtual machine simply needs a corresponding interface (API) to collaborate with the kernel. A virtual machine can discover the priority of its own task, create a new task, launch a new instance of a virtual machine.
</P><P>
Each virtual machine becomes an independent security domain.
<H4>Complexity</H4>
A multi-process virtual machine is overly complex. It is likely to remain untested and unworkable.
<H4>Redundent</H4>
When a virtual machine is written in the C or C++ programming language, it can be ported to a foreign operating system. When a virtual machine runs on a foreign operating system, its ability to run multiple bytecode processes becomes redundent. Both the virtual machine and the foreign operating system are capable of running an independent process.
</P><P>
Redundency is not good. It adds to complexity. It increases the amount of real memory required to run the system.
<H4>Summary</H4>
An operating system is the most important goal of the <nolink>JOS Project. A free Java-based operating system is still our goal. A multi-process virtual machine is optional. It is not required to build a Java-based operating system. Since it is optional, redundent and too complex to be practical, it should be pursued only as a research project.
</P><P>
Our time would be better spent on other things, such as the <a href="/view.php?topic=VMKit&PHPSESSID=acd9f9a63177b2e25cc56906638c71ba">VMKit</a><wikitopic VMKit /wikitopic> and taming the jJOS kernel.<BR><BR></P><!--

<TABLE width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="737b9c">
<TR><TD ALIGN="CENTER">
<a href="/user.php?op=login&redirect=%2Fview%2F%2FWhyNotMultiProcessJVM&PHPSESSID=acd9f9a63177b2e25cc56906638c71ba">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FWhyNotMultiProcessJVM&PHPSESSID=acd9f9a63177b2e25cc56906638c71ba">new&nbsp;user</a><TR><TD>
</TABLE>

!-->
<!-- end BODY page !-->

<HR>

<DIV ALIGN="CENTER">
<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR>
	<TD ALIGN="CENTER" COLSPAN="2">
		Content of these pages are owned and copyrighted by the poster.
	</TD>
</TR>
<TR>
	<TD ALIGN="RIGHT" WIDTH="50%">
		Hosted by:
	</TD>
	<TD ALIGN="LEFT">
		<A HREF="http://sourceforge.net/"><IMG 
			SRC="http://sourceforge.net/sflogo.php?group_id=2376&type=1"
			BORDER=0 HSPACE=0 VSPACE=0></A>
	</TD>
</TR>
</TABLE>
</DIV>
</BODY>
</HTML>

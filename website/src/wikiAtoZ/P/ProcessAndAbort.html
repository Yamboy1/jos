<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 FINAL//EN">
<HTML>
  <HEAD>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
    <TITLE>ProcessAndAbort.Imported @ jos.sf.net</TITLE>
  </HEAD>

<BODY BGCOLOR="#FFFFFF">

<!-- The FORM encloses the entire header, because it renders better that way. !-->
<FORM ACTION="/jump.php"><input type="hidden" name="PHPSESSID" value="70d1618b405223ac82e7ee35f57b2b6d" />

<!-- The JOS logo. !-->
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR VALIGN="TOP" ALIGN="LEFT">
	<TD><A HREF="http://cjos.sourceforge.net/archive/"><IMG 
		VSPACE="0" HSPACE="0" ALIGN="MIDDLE" BORDER="0"
		SRC="http://cjos.sourceforge.net/archive/media/jos_logo_mini.gif"></A></TD>
	<!-- The tab table. !-->
	<TD WIDTH="100%" ALIGN="RIGHT" BGCOLOR="#FFFFFF" VALIGN="BOTTOM"> 
		<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%" ALIGN="RIGHT">
			<TR VALIGN="MIDDLE" ALIGN="LEFT">

<TD BGCOLOR="White" WIDTH="60%">&nbsp;</TD>
<TD BGCOLOR="#FFFFCC"><A HREF="http://cjos.sourceforge.net/archive/">Home</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/info/">Info</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/dev/">DevZone</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFCC66" ALIGN="CENTER"><A
HREF="http://jos.sourceforge.net/">Wiki</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
			</TR>
			<TR>
				<TD BGCOLOR="#FFCC66" ALIGN="RIGHT" COLSPAN="9">
					<A HREF="/view/Users/?PHPSESSID=70d1618b405223ac82e7ee35f57b2b6d">UsersWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Main/?PHPSESSID=70d1618b405223ac82e7ee35f57b2b6d">MainWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Info/?PHPSESSID=70d1618b405223ac82e7ee35f57b2b6d">InfoWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/DevZone/?PHPSESSID=70d1618b405223ac82e7ee35f57b2b6d">DevZoneWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Support/?PHPSESSID=70d1618b405223ac82e7ee35f57b2b6d">SupportWeb</A>
				</TD>
			</TR>
		</TABLE>
	</TD>		
</TR>
<!-- The WikiHeader. !-->
<TR><TD COLSPAN="2">
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="CENTER">
		<B>[&nbsp;<a href="/info//ProcessAndAbort?PHPSESSID=70d1618b405223ac82e7ee35f57b2b6d">ProcessAndAbort</a>&nbsp;]</B>
	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="CENTER">
		<B>[ not logged in ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="CENTER">
		<B>[ Web: <a href="/view/Imported/?PHPSESSID=70d1618b405223ac82e7ee35f57b2b6d">Imported</a> ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFCC66" VALIGN="CENTER">
		goto:&nbsp;<INPUT TYPE="TEXT" SIZE="10" NAME="topic"><!--<INPUT TYPE="IMAGE" SRC="/media/go.gif?PHPSESSID=70d1618b405223ac82e7ee35f57b2b6d" BORDER="0" VALUE="topic" ALT="goto">!-->&nbsp;<a href="/search.php?PHPSESSID=70d1618b405223ac82e7ee35f57b2b6d"><FONT SIZE="-1">options</FONT></a>
	</TD>
</TR>
</TABLE>

<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
	<TR>
	<TD ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="TOP">
		[&nbsp;get <a href="/info/Imported/ProcessAndAbort?PHPSESSID=70d1618b405223ac82e7ee35f57b2b6d">info</a> on or <a href="/edit/Imported/ProcessAndAbort?PHPSESSID=70d1618b405223ac82e7ee35f57b2b6d">edit</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="TOP">
		[&nbsp;<a href="/user.php?op=login&redirect=%2Fview%2F%2FProcessAndAbort&PHPSESSID=70d1618b405223ac82e7ee35f57b2b6d">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FProcessAndAbort&PHPSESSID=70d1618b405223ac82e7ee35f57b2b6d">new&nbsp;user</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="TOP">
		[&nbsp;list of <a href="/topics/Imported/?PHPSESSID=70d1618b405223ac82e7ee35f57b2b6d">topics</a>, <a href="/hubsnodes/Imported/?PHPSESSID=70d1618b405223ac82e7ee35f57b2b6d">hubs&nbsp;&amp;&nbsp;nodes</a>, or <a href="/changes/Imported/?PHPSESSID=70d1618b405223ac82e7ee35f57b2b6d">recent&nbsp;changes</a>&nbsp;]	</TD>
	</TR>
</TABLE>

<!-- From CommonHeader !-->
</TR></TD>
</TABLE>
</FORM>

<!-- start BODY page !-->
<P>
<FONT SIZE="-1"><a href="/view.php?topic=ProcessPages&PHPSESSID=70d1618b405223ac82e7ee35f57b2b6d">ProcessPages</a><wikitopic ProcessPages /wikitopic></FONT>
<HR SIZE="1" NOSHADOW>
<P><EM>Article contributed by <a href="/view.php?topic=GilbertHerschberger&PHPSESSID=70d1618b405223ac82e7ee35f57b2b6d">GilbertHerschberger</a><wikitopic GilbertHerschberger /wikitopic> (14 July 2000).</EM></P>
<H4>Introduction</H4>
<P>The most widely accepted model of a machine code process is good, strong and worthwhile. It provides an isolated environment for each process. It virtualizes hardware. A process is a virtual machine. The isolated environment is a <EM>virtual machine</EM>, not to be confused with a <a href="/view.php?topic=BytecodeInterpreter&PHPSESSID=70d1618b405223ac82e7ee35f57b2b6d">BytecodeInterpreter</a><wikitopic BytecodeInterpreter /wikitopic>, such as a Java Virtual Machine.</P>
<P>This model of a machine code process should be preserved. Anyone familiar with the machine code process model should be able to recognize the bytecode process model. Both are process models. Feature for feature, a machine code process should be replicated as a bytecode process.</P>
<P>A Java Virtual Machine depends on a pre-existing machine code process. When you start the <CODE>java</CODE> tool on a foreign operating system, the foreign operating system is responsible for virtualizing hardware on behalf of the <CODE>java</CODE> tool. The <CODE>java</CODE> tool does not virtualize the machine on its own.</P>
<P>The single-process model is inherent in the <a href="/view.php?topic=JavaVirtualMachineSpecification&PHPSESSID=70d1618b405223ac82e7ee35f57b2b6d">JavaVirtualMachineSpecification</a><wikitopic JavaVirtualMachineSpecification /wikitopic>. The specification is written from the ground up with the assumption that a foreign operating system would always be responsible for the virtualization of hardware. The foreign operating system is expected to provide a kernel and device drivers and a fully-isolated machine code process.</P>
<H4>Abort</H4>
<P>When a machine code process is terminated, Java objects are abandoned. They are not finalized. They are not garbage collected. Typically, finalization is optional for objects that exist when a virtual machine is closed.</P>
<P>Let's examine the <CODE>exit()</CODE> method of <CODE>java.lang.Runtime</CODE>. What does it do? When invoked, the <CODE>exit()</CODE> method dispatches control to the machine code kernel of a foreign operating system. The kernel releases all system resources used by the machine code process. All of its threads are stopped. All of its files, sockets and share memory handles are closed. All of its memory is free'd.</P>
<PRE>
  void terminate( int pid );
  void kill( int pid );
</PRE>
<H4>About <nolink>MPCL</H4>
<P>When the <CODE>exit()</CODE> method is invoked, a bytecode process cannot dispatch control to the kernel of a foreign operating system. It must be dispatched to a bytecode interpreter. A bytecode interpreter is a kernel. It becomes responsible for things typically delegated to a kernel.</P>
<P>The specification for system-wide garbage collection must be modified so that all objects that belong to a bytecode process can be abandoned without finalization. When a bytecode process is terminated, all of its objects must be free'd <EM>as if</EM> they had been finalized. A MPCL-compatible virtual machine is not required to waste <a href="/view.php?topic=CPU&web=Imported&PHPSESSID=70d1618b405223ac82e7ee35f57b2b6d">CPU</a> <wikitopic CPU /wikitopic>cycles interpreting finalization code after a process has already been terminated.</P>
<H4>Diagram 1</H4>
<P>The following diagram illustrates the responsibilities of a typical kernel.</P>
<TABLE WIDTH="100%" BORDER="1" CELLPADDING="8" BGCOLOR="lightblue">
<TR>
<TD>
kernel
<TABLE BORDER="1" CELLPADDING="4" BGCOLOR="white">
<TR>
<TD>
<UL>
<LI>clean-up
<LI>terminate
<LI>kill
<LI>memory heap
<LI>open devices
<LI>open files
<LI>open sockets
</UL>
</TD>
</TR>
</TABLE>
</TD>
<TD VALIGN="TOP">
machine code process
<TABLE BORDER="1" CELLPADDING="4" BGCOLOR="white">
<TR>
<TD>
<UL>
<LI>bytecode interpreter
<LI>bytecode process
</UL>
</TD>
</TR>
</TABLE>
</TD>
</TR>
</TABLE>
<H4>Diagram 2</H4>
<P>A bytecode process makes a bytecode interpreter less complicated. But, it also makes a bytecode process more complicated. Some responsibilities of a bytecode interpreter are transferred to a bytecode process.</P>
<TABLE WIDTH="100%" BORDER="1" CELLPADDING="8" BGCOLOR="lightblue">
<TR>
<TD>
bytecode interpreter
<TABLE BORDER="1" CELLPADDING="4" BGCOLOR="white">
<TR>
<TD>
<UL>
<LI>clean-up
<LI>terminate
<LI>kill
<LI>memory heap
<LI>open devices
<LI>open files
<LI>open sockets
</UL>
</TD>
</TR>
</TABLE>
</TD>
<TD VALIGN="TOP">
bytecode process
</TD>
</TR>
</TABLE>
<H4>Break apart</H4>
<P>A monolithic bytecode interpreter is extremely complex. It might be too complex to develop, compile and test. For example, a bytecode interpreter should not be responsible for the virtualization of hardware.</P>
<P>The classic operating system breaks the puzzle into two parts:</P>
<UL>
<LI>kernel
<LI>machine code process
</UL>
<P>By optimizing an operating system for a bytecode interpreter, we can break the operating system into two parts:</P>
<UL>
<LI><P>bytecode interpreter</P>
<P>A kernel and bytecode interpreter are inseparable. A bytecode interpreter becomes the new kernel.</P>
<LI><P>bytecode process</P>
<P>A bytecode process must be managed in machine code, just like a machine code process.</P>
</UL>
<H4>Bytecode interpreter</H4>
<P>The bytecode interpreter is a kernel. It keeps track of the system resources consumed by each bytecode process. A bytecode interpreter creates and destroyes bytecode processes.</P>
<P>The bytecode interpreter creates and destroys threads. It has a scheduler and schedules threads.</P>
<H4>Bytecode process</H4>
<P>A bytecode process provides the environment for a standard Java application. The bytecode process has custom class loaders in addition to its primordial class loader.</P>
<P>A bytecode process is owned by a bytecode interpreter. Each bytecode process has its own primordial class loader. With its own primordial class loader, each bytecode process runs an application. Each application has its own application context, isolated and independent from all other applications.</P>
<P>Each bytecode process may have more than one thread. A bytecode process is active. It uses system calls to the bytecode interpreter to create new threads.</P>
<H4>System process</H4>
<P>A bytecode interpreter always has one system process. The system process is used by the bytecode interpreter to perform system tasks, such as scheduling, asynchonous I/O and asynchronous system calls.</P>
<P>The bytecode interpreter/system process is directly responsible for the virtualization of hardware. It makes sure that each physical device is opened by one process at a time.</P>
<P>The system process uses a plug-in protocol stack to communicate with other non-system processes.</P>
<H4>User process</H4>
<P>Each user process is a Java application. It has its own primordial class loader. It has its own <CODE>java.class.path</CODE> and system properties. A bytecode interpreter starts a user process with a command line, loosely based on the <CODE>java</CODE> tool.</P>
<H4>Summary</H4>
<P>Ultimately, <nolink>JOS can be optimized beyond other operating systems. Unlike other operating systems, the bytecode interpreter and kernel are fully integrated for the ultimate <nolink>JOS. They are inseparable. Unlike other virtual machines, multiple primordial class loaders are supported. The process model is preserveable and should be preserved.</P><BR><BR></P><!--

<TABLE width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="737b9c">
<TR><TD ALIGN="CENTER">
<a href="/user.php?op=login&redirect=%2Fview%2F%2FProcessAndAbort&PHPSESSID=70d1618b405223ac82e7ee35f57b2b6d">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FProcessAndAbort&PHPSESSID=70d1618b405223ac82e7ee35f57b2b6d">new&nbsp;user</a><TR><TD>
</TABLE>

!-->
<!-- end BODY page !-->

<HR>

<DIV ALIGN="CENTER">
<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR>
	<TD ALIGN="CENTER" COLSPAN="2">
		Content of these pages are owned and copyrighted by the poster.
	</TD>
</TR>
<TR>
	<TD ALIGN="RIGHT" WIDTH="50%">
		Hosted by:
	</TD>
	<TD ALIGN="LEFT">
		<A HREF="http://sourceforge.net/"><IMG 
			SRC="http://sourceforge.net/sflogo.php?group_id=2376&type=1"
			BORDER=0 HSPACE=0 VSPACE=0></A>
	</TD>
</TR>
</TABLE>
</DIV>
</BODY>
</HTML>

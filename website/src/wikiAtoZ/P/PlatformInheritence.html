<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 FINAL//EN">
<HTML>
  <HEAD>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
    <TITLE>PlatformInheritence.Imported @ jos.sf.net</TITLE>
  </HEAD>

<BODY BGCOLOR="#FFFFFF">

<!-- The FORM encloses the entire header, because it renders better that way. !-->
<FORM ACTION="/jump.php"><input type="hidden" name="PHPSESSID" value="409926da99eb7f14efb6ce48aa2438b0" />

<!-- The JOS logo. !-->
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR VALIGN="TOP" ALIGN="LEFT">
	<TD><A HREF="http://cjos.sourceforge.net/archive/"><IMG 
		VSPACE="0" HSPACE="0" ALIGN="MIDDLE" BORDER="0"
		SRC="http://cjos.sourceforge.net/archive/media/jos_logo_mini.gif"></A></TD>
	<!-- The tab table. !-->
	<TD WIDTH="100%" ALIGN="RIGHT" BGCOLOR="#FFFFFF" VALIGN="BOTTOM"> 
		<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%" ALIGN="RIGHT">
			<TR VALIGN="MIDDLE" ALIGN="LEFT">

<TD BGCOLOR="White" WIDTH="60%">&nbsp;</TD>
<TD BGCOLOR="#FFFFCC"><A HREF="http://cjos.sourceforge.net/archive/">Home</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/info/">Info</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/dev/">DevZone</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFCC66" ALIGN="CENTER"><A
HREF="http://jos.sourceforge.net/">Wiki</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
			</TR>
			<TR>
				<TD BGCOLOR="#FFCC66" ALIGN="RIGHT" COLSPAN="9">
					<A HREF="/view/Users/?PHPSESSID=409926da99eb7f14efb6ce48aa2438b0">UsersWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Main/?PHPSESSID=409926da99eb7f14efb6ce48aa2438b0">MainWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Info/?PHPSESSID=409926da99eb7f14efb6ce48aa2438b0">InfoWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/DevZone/?PHPSESSID=409926da99eb7f14efb6ce48aa2438b0">DevZoneWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Support/?PHPSESSID=409926da99eb7f14efb6ce48aa2438b0">SupportWeb</A>
				</TD>
			</TR>
		</TABLE>
	</TD>		
</TR>
<!-- The WikiHeader. !-->
<TR><TD COLSPAN="2">
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="CENTER">
		<B>[&nbsp;<a href="/info//PlatformInheritence?PHPSESSID=409926da99eb7f14efb6ce48aa2438b0">PlatformInheritence</a>&nbsp;]</B>
	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="CENTER">
		<B>[ not logged in ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="CENTER">
		<B>[ Web: <a href="/view/Imported/?PHPSESSID=409926da99eb7f14efb6ce48aa2438b0">Imported</a> ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFCC66" VALIGN="CENTER">
		goto:&nbsp;<INPUT TYPE="TEXT" SIZE="10" NAME="topic"><!--<INPUT TYPE="IMAGE" SRC="/media/go.gif?PHPSESSID=409926da99eb7f14efb6ce48aa2438b0" BORDER="0" VALUE="topic" ALT="goto">!-->&nbsp;<a href="/search.php?PHPSESSID=409926da99eb7f14efb6ce48aa2438b0"><FONT SIZE="-1">options</FONT></a>
	</TD>
</TR>
</TABLE>

<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
	<TR>
	<TD ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="TOP">
		[&nbsp;get <a href="/info/Imported/PlatformInheritence?PHPSESSID=409926da99eb7f14efb6ce48aa2438b0">info</a> on or <a href="/edit/Imported/PlatformInheritence?PHPSESSID=409926da99eb7f14efb6ce48aa2438b0">edit</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="TOP">
		[&nbsp;<a href="/user.php?op=login&redirect=%2Fview%2F%2FPlatformInheritence&PHPSESSID=409926da99eb7f14efb6ce48aa2438b0">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FPlatformInheritence&PHPSESSID=409926da99eb7f14efb6ce48aa2438b0">new&nbsp;user</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="TOP">
		[&nbsp;list of <a href="/topics/Imported/?PHPSESSID=409926da99eb7f14efb6ce48aa2438b0">topics</a>, <a href="/hubsnodes/Imported/?PHPSESSID=409926da99eb7f14efb6ce48aa2438b0">hubs&nbsp;&amp;&nbsp;nodes</a>, or <a href="/changes/Imported/?PHPSESSID=409926da99eb7f14efb6ce48aa2438b0">recent&nbsp;changes</a>&nbsp;]	</TD>
	</TR>
</TABLE>

<!-- From CommonHeader !-->
</TR></TD>
</TABLE>
</FORM>

<!-- start BODY page !-->
<P>
<FONT SIZE="-1"><a href="/view.php?topic=PlatformAPI&PHPSESSID=409926da99eb7f14efb6ce48aa2438b0">PlatformAPI</a><wikitopic PlatformAPI /wikitopic></FONT>
<HR SIZE="1" NOSHADOW>
<P><EM>Article contributed by <a href="/view.php?topic=GilbertHerschberger&PHPSESSID=409926da99eb7f14efb6ce48aa2438b0">GilbertHerschberger</a><wikitopic GilbertHerschberger /wikitopic> (22 February 2000).</EM></P>
<H4>Introduction</H4>
<P>It is most refreshing to see an object-oriented operating system. At last, the benefits of encapsulation, inheritence and factories come to play on the operating system architecture. When it is object-oriented, the operating system supports software past, present and future.</P>
<P>The platform-dependent features of a machine can be encapsulated, such as processor, virtual memory and task-switching. Each platform-dependent class extends a well-known interface. A platform-dependent factory creates the perfect object for this platform.</P>
<H4>Interface</H4>
<P>In C++, a pure virtual class is a special kind of abstract class. It contains no fields and implements no methods.</P>
<P>Like an interface in Java, a pure virtual class can be implemented by any other class. An interface in Java is expressed as a pure virtual class in C++.</P>
<P>Here is a simple example of a pure virtual class in C++:</P>
<PRE>
class Console {
  public:
	 virtual void println( const char *v ) = 0;
};
</PRE>
<H4>Implementation</H4>
<P>When a pure virtual class is defined, it cannot be instantiated; it has no implementation. This is similar to the way a Java interface cannot be instantiated.</P>
<P>A pure virtual class must be extended. Here is an example of extending an pure virtual class in C++:</P>
<PRE>
class BasicConsole : public Console {
  public:
	 BasicConsole() {};
	 virtual ~BasicConsole() {};
	 void println( const char *v ) {
		cout &lt;&lt; v &lt;&lt; endl;
	 }
};
</PRE>
<H4>Multiple inheritence</H4>
<P>Pure virtual classes, like Java interfaces, enable a class to participate in more than one interface. In C++, this is expressed as multiple inheritence. Here is an example of multiple inheritence in C++:</P>
<PRE>
class Program : public Runnable, Console {
  public:
	 Program() {}
	 virtual ~Program() {}
	 virtual void run() {
		println( "Hello, world!" );
	 }
	 virtual void println( const char *v ) {
		cout &lt;&lt; v &lt;&lt; endl;
	 }
};
</PRE>
<H4>Platform-independent classes</H4>
<P>Because it contains no fields and implements no methods, pure virtual classes are platform-independent. A set of pure virtual classes must be created to define the platform itself. Like Linux uses structures, our operating system uses pure virtual classes. Each "field" must have at least two methods: at least one accessor and at least one modifier.</P>
<H4>Platform-dependent classes</H4>
<P>When building platform-dependent classes, inheritence is the key. Each platform must extend the full set of pure virtual classes. The compiler (and linker) checks a platform for correctness and completeness.</P>
<H4>Common classes</H4>
<P>A set of common classes are then designed to act upon pure virtual classes. Common classes are tightly coupled to pure virtual classes, not platform-dependent classes.</P>
<H4>Header files</H4>
<P>Modules developed for the platform use a common set of header files, where the pure virtual classes are defined. Platform-dependent classes can add fields and define structures as needed to suite the platform. The organization of platform-dependent classes is part of the platform.</P>
<P>Pure virtual classes are not concerned with laying out specific fields in memory. Fields in memory can be organized in a manner best suited to the platform.</P>
<H4>Example of inheritence</H4>
<P>A virtual machine class might be called <CODE>VirtualMachine</CODE>. It is a pure virtual class. Since it is a kind of virtual machine, decaf must inherit the methods of <CODE>VirtualMachine</CODE>.</P>
<PRE>
class decaf : public VirtualMachine {
  public:
	 decaf();
	 virtual ~decaf();
	 virtual void run();
};
</PRE>
<P>Another virtual machine might be called Kaffe. Since it is a kind of virtual machine, Kaffe must inherit the methods of <CODE>VirtualMachine</CODE>.</P>
<PRE>
class Kaffe : public VirtualMachine {
  public:
	 Kaffe();
	 virtual ~Kaffe();
	 virtual void run();
};
</PRE>
<P>At runtime, jJOS only needs to know that it is running a virtual machine. It does not need to know which one.</P>
<PRE>
  :
  void jJOS::startVM() {
	 VirtualMachine &amp;vm = create_virtual_machine();
	 vm.run();
  }
  :
</PRE>
<H4>Likewise</H4>
<P>On the other hand, a virtual machine needs to use the kernel. A kernel class might be called Kernel. It is a pure virtual class. Since it is a kind of kernel, jJOS must inherit the methods of Kernel.</P>
<PRE>
class jJOS : public Kernel {
  public:
	 jJOS();
	 virtual ~jJOS();
	 virtual void kprint( const char *fmt, ... ) const;
};
</PRE>
<P>Both <CODE>Kernel</CODE> and <CODE>VirtualMachine</CODE> are pure virtual classes. The definition of <CODE>VirtualMachine</CODE> can include a reference to <CODE>Kernel</CODE>, like this:
<PRE>
class VirtualMachine {
  public:
	 virtual void setKernel( const Kernel &amp;v ) = 0;
	 virtual void run() = 0;
};
</PRE>
<P>When it creates a virtual machine, the kernel can always set a virtual machine's kernel property. What the virtual machine does with the kernel property is up to a platform-specific implementation.</P>
<PRE>
  :
  void jJOS::startVM() {
	 VirtualMachine &amp;vm = create_virtual_machine();
	 vm.setKernel( *this );
	 vm.run();
  }
  :
</PRE>
<P>This mechanism enables a kernel to start more than one virtual machine, if the virtual machine allows it.</P><BR><BR></P><!--

<TABLE width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="737b9c">
<TR><TD ALIGN="CENTER">
<a href="/user.php?op=login&redirect=%2Fview%2F%2FPlatformInheritence&PHPSESSID=409926da99eb7f14efb6ce48aa2438b0">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FPlatformInheritence&PHPSESSID=409926da99eb7f14efb6ce48aa2438b0">new&nbsp;user</a><TR><TD>
</TABLE>

!-->
<!-- end BODY page !-->

<HR>

<DIV ALIGN="CENTER">
<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR>
	<TD ALIGN="CENTER" COLSPAN="2">
		Content of these pages are owned and copyrighted by the poster.
	</TD>
</TR>
<TR>
	<TD ALIGN="RIGHT" WIDTH="50%">
		Hosted by:
	</TD>
	<TD ALIGN="LEFT">
		<A HREF="http://sourceforge.net/"><IMG 
			SRC="http://sourceforge.net/sflogo.php?group_id=2376&type=1"
			BORDER=0 HSPACE=0 VSPACE=0></A>
	</TD>
</TR>
</TABLE>
</DIV>
</BODY>
</HTML>

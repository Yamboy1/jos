<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 FINAL//EN">
<HTML>
  <HEAD>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
    <TITLE>PackagePath.Imported @ jos.sf.net</TITLE>
  </HEAD>

<BODY BGCOLOR="#FFFFFF">

<!-- The FORM encloses the entire header, because it renders better that way. !-->
<FORM ACTION="/jump.php"><input type="hidden" name="PHPSESSID" value="49f9a75fa2948d0a9dfb73e2100d1908" />

<!-- The JOS logo. !-->
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR VALIGN="TOP" ALIGN="LEFT">
	<TD><A HREF="http://cjos.sourceforge.net/archive/"><IMG 
		VSPACE="0" HSPACE="0" ALIGN="MIDDLE" BORDER="0"
		SRC="http://cjos.sourceforge.net/archive/media/jos_logo_mini.gif"></A></TD>
	<!-- The tab table. !-->
	<TD WIDTH="100%" ALIGN="RIGHT" BGCOLOR="#FFFFFF" VALIGN="BOTTOM"> 
		<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%" ALIGN="RIGHT">
			<TR VALIGN="MIDDLE" ALIGN="LEFT">

<TD BGCOLOR="White" WIDTH="60%">&nbsp;</TD>
<TD BGCOLOR="#FFFFCC"><A HREF="http://cjos.sourceforge.net/archive/">Home</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/info/">Info</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/dev/">DevZone</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFCC66" ALIGN="CENTER"><A
HREF="http://jos.sourceforge.net/">Wiki</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
			</TR>
			<TR>
				<TD BGCOLOR="#FFCC66" ALIGN="RIGHT" COLSPAN="9">
					<A HREF="/view/Users/?PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">UsersWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Main/?PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">MainWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Info/?PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">InfoWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/DevZone/?PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">DevZoneWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Support/?PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">SupportWeb</A>
				</TD>
			</TR>
		</TABLE>
	</TD>		
</TR>
<!-- The WikiHeader. !-->
<TR><TD COLSPAN="2">
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="CENTER">
		<B>[&nbsp;<a href="/info//PackagePath?PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">PackagePath</a>&nbsp;]</B>
	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="CENTER">
		<B>[ not logged in ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="CENTER">
		<B>[ Web: <a href="/view/Imported/?PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">Imported</a> ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFCC66" VALIGN="CENTER">
		goto:&nbsp;<INPUT TYPE="TEXT" SIZE="10" NAME="topic"><!--<INPUT TYPE="IMAGE" SRC="/media/go.gif?PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908" BORDER="0" VALUE="topic" ALT="goto">!-->&nbsp;<a href="/search.php?PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908"><FONT SIZE="-1">options</FONT></a>
	</TD>
</TR>
</TABLE>

<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
	<TR>
	<TD ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="TOP">
		[&nbsp;get <a href="/info/Imported/PackagePath?PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">info</a> on or <a href="/edit/Imported/PackagePath?PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">edit</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="TOP">
		[&nbsp;<a href="/user.php?op=login&redirect=%2Fview%2F%2FPackagePath&PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FPackagePath&PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">new&nbsp;user</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="TOP">
		[&nbsp;list of <a href="/topics/Imported/?PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">topics</a>, <a href="/hubsnodes/Imported/?PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">hubs&nbsp;&amp;&nbsp;nodes</a>, or <a href="/changes/Imported/?PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">recent&nbsp;changes</a>&nbsp;]	</TD>
	</TR>
</TABLE>

<!-- From CommonHeader !-->
</TR></TD>
</TABLE>
</FORM>

<!-- start BODY page !-->
<P>
<EM>Article contributed by <a href="/view.php?topic=GilbertHerschberger&PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">GilbertHerschberger</a><wikitopic GilbertHerschberger /wikitopic>.</EM>
<H4>Introduction</H4>
<P>When <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">JOS</a> <wikitopic JOS /wikitopic>is finished, all of those applications will be written in Java. Are we looking forward to running all those applications?</P>
<P><EM>What does this mean?</EM></P>
<H4>Struggle now</H4>
<P>We're already having problems running applications in Java on a foreign OS. Java wasn't looking forward to running all those applications. If we keep the same solution, we'll keep the same problems. <a href="/view.php?topic=CLASSPATH&web=Imported&PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">CLASSPATH</a> <wikitopic CLASSPATH /wikitopic>and JARs will be fatal for JOS. It means that the same struggle we're having with the current <a href="/view.php?topic=JDK&web=Imported&PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">JDK</a> <wikitopic JDK /wikitopic>and <a href="/view.php?topic=JRE&web=Imported&PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">JRE</a> <wikitopic JRE /wikitopic>will be bigger and badder on JOS.</P>
<P>Can you imagine changing the <a href="/view.php?topic=CLASSPATH&web=Imported&PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">CLASSPATH</a> <wikitopic CLASSPATH /wikitopic>everytime you want to run a new application in JOS? If I have a few hundred applications installed, how long is my CLASSPATH? If I have hundreds of Java appliacations, I would be annoyed by adding each JAR, one at a time, to the CLASSPATH.</P>
<P>What happens when there are a few thousand applications installed? What then?</P>
<H4>New app</H4>
<P>When <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">JOS</a> <wikitopic JOS /wikitopic>launches a new application, it may start a new process. Will it launch a new class loader? Is there going to be one class loader for each process/domain?</P>
<P>If <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">JOS</a> <wikitopic JOS /wikitopic>uses a class loader for each application, only the class loader needs to know where the classes are stored. But then, how do we save on <a href="/view.php?topic=RAM&web=Imported&PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">RAM</a> <wikitopic RAM /wikitopic>when each class loader has its own copy of a class?</P>
<H4>Package path</H4>
<P>If packages are installed on JOS, wherever a user wants them, the link between <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">JOS</a> <wikitopic JOS /wikitopic>and a package should be a PACKAGEPATH. The package path is a flat list of all directories where package files are stored. A package path is needed so that uninstall is a simple <STRONG>delete</STRONG>. After installing a new package, I can uninstall it by deleting it from a directory.</P>
<P>Order is important. The package path will be searched in the order it is built. We should expect system classes and pre-installed <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">JOS</a> <wikitopic JOS /wikitopic>extensions to be first on the package path.</P>
<P>When an application is launched, the package path is searched for a matching class, when providing the entire class name.</P>
<H4>Duplicate classes</H4>
<P>If we're going to support duplicate classes in different JARs, each class loader must be able to load its own copy of a class. This undermines the mission to save <a href="/view.php?topic=RAM&web=Imported&PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">RAM</a> <wikitopic RAM /wikitopic>somehow by building a new JVM.</P>
<P>When configured, a class loader should be given the name of a class to load and a copy of the PACKAGEPATH. When a parent process launches a child process, the <a href="/view.php?topic=PACKAGEPATH&web=Imported&PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">PACKAGEPATH</a> <wikitopic PACKAGEPATH /wikitopic>of the parent must be given to the child.</P>
<H4>Developing for <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">JOS</a> <wikitopic JOS /wikitopic>using JOS</H4>
<P>Follow this scenario carefully. It is important to understand the consequence of how we load classes. Lets say that I have already installed <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">JOS</a> <wikitopic JOS /wikitopic>on my personal computer. I want to compile and test a program I have written in Java. I should be able to bring up an <a href="/view.php?topic=IDE&web=Imported&PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">IDE</a> <wikitopic IDE /wikitopic>written in Java, write a few lines of Java source code, and compile the program. Of course, my compiler is going to create a standard Java .class file.</P>
<P>First of all, if I write a class called <CODE>org.jos.Widget</CODE>, it must not overwrite the <CODE>org.jos.Widget</CODE> used by JOS. There are two classes with the same name, <EM>and should be</EM>.
<P>Second, I should be able to launch a process which uses the class file I just wrote. Not a copy of the class file I wrote fifteen minutes ago. I should be able to use a .class file the moment it is written to disk by the Java compiler.</P>
<P>How are there two copies of <CODE>org.jos.Widget</CODE>? One is part of <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">JOS</a> <wikitopic JOS /wikitopic>and the other is not. Therefore, all of the classes that are part of <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">JOS</a> <wikitopic JOS /wikitopic>itself must be stored elsewhere. Not in a .class file. Not on CLASSPATH.</P>
<P>Like it takes extra special effort to install the Linux kernel, it should take extra special effort to install the classes that make up <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">JOS</a> <wikitopic JOS /wikitopic>itself.</P>
<P>The bootstrap of <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">JOS</a> <wikitopic JOS /wikitopic>must include loading bytecode before a process exists. <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">JOS</a> <wikitopic JOS /wikitopic>must load a bootstrap package into <a href="/view.php?topic=RAM&web=Imported&PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">RAM</a> <wikitopic RAM /wikitopic>using a raw, non-Java mechanism. All of the classes in the bootstrap are going to be used and then discarded. The bootstrap package must be one package. It must be completely self-contained in a single contiguous file.</P>
<P>Next, the bootstrap package is the only package which doesn't need a real class loader. The bootstrap package contains a primordial class loader. Once the bootstrap package has a primordial class loader, then it can load all of the other classes.</P>
<P>Sun has already designated <CODE>java.lang</CODE> as the bootstrap package. Will that work for JOS?</P>
<H4>Architecture</H4>
<P>When I launch an application, I should be able to decide for myself if I want to open a new domain. A well-written <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">JOS</a> <wikitopic JOS /wikitopic>application should be able to run inside a domain with a bunch of other well-written applications. It isn't necessary to create a new domain for each application.</P>
<P>If I do create a new domain, I can shut down a domain without shutting down JOS. I can't shut down anything smaller than a domain.</P>
<TABLE WIDTH="100%" CELLPADDING="6" BORDER="1" BGCOLOR="EFEFEF">
<TR>
<TD ALIGN="CENTER">
<a href="/view.php?topic=JOS&web=Imported&PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">JOS</a> <wikitopic JOS /wikitopic>JVM
<TABLE WIDTH="100%" CELLPADDING="6" BORDER="1" BGCOLOR="FFFFCC">
<TR>
<TD ALIGN="CENTER">
Domain 1
<TABLE WIDTH="100%" CELLPADDING="6" BORDER="1" BGCOLOR="FFCC66">
<TR>
<TD>
<STRONG>app-1</STRONG>
</TD>
<TD>
<STRONG>app-2</STRONG>
</TD>
<TD>
<STRONG>app-3</STRONG>
</TD>
</TR>
</TABLE>
</TD>
<TD ALIGN="CENTER">
Domain 2
<TABLE WIDTH="100%" CELLPADDING="6" BORDER="1" BGCOLOR="FFCC66">
<TR>
<TD>
<STRONG>app-4</STRONG>
</TD>
<TD>
<STRONG>app-5</STRONG>
</TD>
</TR>
</TABLE>
</TD>
<TD ALIGN="CENTER">
Domain 3
<TABLE WIDTH="100%" CELLPADDING="6" BORDER="1" BGCOLOR="FFCC66">
<TR>
<TD>
<STRONG>app-6</STRONG>
</TD>
<TD>
<STRONG>app-7</STRONG>
</TD>
<TD>
<STRONG>app-8</STRONG>
</TD>
</TR>
</TABLE>
</TD>
</TR>
</TABLE>
</TD>
</TR>
</TABLE><BR><BR></P><!--

<TABLE width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="737b9c">
<TR><TD ALIGN="CENTER">
<a href="/user.php?op=login&redirect=%2Fview%2F%2FPackagePath&PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FPackagePath&PHPSESSID=49f9a75fa2948d0a9dfb73e2100d1908">new&nbsp;user</a><TR><TD>
</TABLE>

!-->
<!-- end BODY page !-->

<HR>

<DIV ALIGN="CENTER">
<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR>
	<TD ALIGN="CENTER" COLSPAN="2">
		Content of these pages are owned and copyrighted by the poster.
	</TD>
</TR>
<TR>
	<TD ALIGN="RIGHT" WIDTH="50%">
		Hosted by:
	</TD>
	<TD ALIGN="LEFT">
		<A HREF="http://sourceforge.net/"><IMG 
			SRC="http://sourceforge.net/sflogo.php?group_id=2376&type=1"
			BORDER=0 HSPACE=0 VSPACE=0></A>
	</TD>
</TR>
</TABLE>
</DIV>
</BODY>
</HTML>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 FINAL//EN">
<HTML>
  <HEAD>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
    <TITLE>PrimordialVsKernel.Imported @ jos.sf.net</TITLE>
  </HEAD>

<BODY BGCOLOR="#FFFFFF">

<!-- The FORM encloses the entire header, because it renders better that way. !-->
<FORM ACTION="/jump.php"><input type="hidden" name="PHPSESSID" value="c50a7c0ab753c0570637b5fa72e9e356" />

<!-- The JOS logo. !-->
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR VALIGN="TOP" ALIGN="LEFT">
	<TD><A HREF="http://cjos.sourceforge.net/archive/"><IMG 
		VSPACE="0" HSPACE="0" ALIGN="MIDDLE" BORDER="0"
		SRC="http://cjos.sourceforge.net/archive/media/jos_logo_mini.gif"></A></TD>
	<!-- The tab table. !-->
	<TD WIDTH="100%" ALIGN="RIGHT" BGCOLOR="#FFFFFF" VALIGN="BOTTOM"> 
		<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%" ALIGN="RIGHT">
			<TR VALIGN="MIDDLE" ALIGN="LEFT">

<TD BGCOLOR="White" WIDTH="60%">&nbsp;</TD>
<TD BGCOLOR="#FFFFCC"><A HREF="http://cjos.sourceforge.net/archive/">Home</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/info/">Info</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/dev/">DevZone</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFCC66" ALIGN="CENTER"><A
HREF="http://jos.sourceforge.net/">Wiki</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
			</TR>
			<TR>
				<TD BGCOLOR="#FFCC66" ALIGN="RIGHT" COLSPAN="9">
					<A HREF="/view/Users/?PHPSESSID=c50a7c0ab753c0570637b5fa72e9e356">UsersWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Main/?PHPSESSID=c50a7c0ab753c0570637b5fa72e9e356">MainWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Info/?PHPSESSID=c50a7c0ab753c0570637b5fa72e9e356">InfoWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/DevZone/?PHPSESSID=c50a7c0ab753c0570637b5fa72e9e356">DevZoneWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Support/?PHPSESSID=c50a7c0ab753c0570637b5fa72e9e356">SupportWeb</A>
				</TD>
			</TR>
		</TABLE>
	</TD>		
</TR>
<!-- The WikiHeader. !-->
<TR><TD COLSPAN="2">
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="CENTER">
		<B>[&nbsp;<a href="/info//PrimordialVsKernel?PHPSESSID=c50a7c0ab753c0570637b5fa72e9e356">PrimordialVsKernel</a>&nbsp;]</B>
	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="CENTER">
		<B>[ not logged in ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="CENTER">
		<B>[ Web: <a href="/view/Imported/?PHPSESSID=c50a7c0ab753c0570637b5fa72e9e356">Imported</a> ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFCC66" VALIGN="CENTER">
		goto:&nbsp;<INPUT TYPE="TEXT" SIZE="10" NAME="topic"><!--<INPUT TYPE="IMAGE" SRC="/media/go.gif?PHPSESSID=c50a7c0ab753c0570637b5fa72e9e356" BORDER="0" VALUE="topic" ALT="goto">!-->&nbsp;<a href="/search.php?PHPSESSID=c50a7c0ab753c0570637b5fa72e9e356"><FONT SIZE="-1">options</FONT></a>
	</TD>
</TR>
</TABLE>

<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
	<TR>
	<TD ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="TOP">
		[&nbsp;get <a href="/info/Imported/PrimordialVsKernel?PHPSESSID=c50a7c0ab753c0570637b5fa72e9e356">info</a> on or <a href="/edit/Imported/PrimordialVsKernel?PHPSESSID=c50a7c0ab753c0570637b5fa72e9e356">edit</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="TOP">
		[&nbsp;<a href="/user.php?op=login&redirect=%2Fview%2F%2FPrimordialVsKernel&PHPSESSID=c50a7c0ab753c0570637b5fa72e9e356">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FPrimordialVsKernel&PHPSESSID=c50a7c0ab753c0570637b5fa72e9e356">new&nbsp;user</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="TOP">
		[&nbsp;list of <a href="/topics/Imported/?PHPSESSID=c50a7c0ab753c0570637b5fa72e9e356">topics</a>, <a href="/hubsnodes/Imported/?PHPSESSID=c50a7c0ab753c0570637b5fa72e9e356">hubs&nbsp;&amp;&nbsp;nodes</a>, or <a href="/changes/Imported/?PHPSESSID=c50a7c0ab753c0570637b5fa72e9e356">recent&nbsp;changes</a>&nbsp;]	</TD>
	</TR>
</TABLE>

<!-- From CommonHeader !-->
</TR></TD>
</TABLE>
</FORM>

<!-- start BODY page !-->
<P>
<FONT SIZE="-1"><a href="/view.php?topic=ProcessPages&PHPSESSID=c50a7c0ab753c0570637b5fa72e9e356">ProcessPages</a><wikitopic ProcessPages /wikitopic>; <a href="/view.php?topic=PrimordialClassLoader&PHPSESSID=c50a7c0ab753c0570637b5fa72e9e356">PrimordialClassLoader</a><wikitopic PrimordialClassLoader /wikitopic>; <a href="/view.php?topic=KernelClassLoader&PHPSESSID=c50a7c0ab753c0570637b5fa72e9e356">KernelClassLoader</a><wikitopic KernelClassLoader /wikitopic></FONT>
<HR SIZE="1" NOSHADOW>
<P><EM>Article contributed by <a href="/view.php?topic=GilbertHerschberger&PHPSESSID=c50a7c0ab753c0570637b5fa72e9e356">GilbertHerschberger</a><wikitopic GilbertHerschberger /wikitopic> (18 April 2000).</EM></P>
<H4>Introduction</H4>
<P>We have already established the strong relationship between a bytecode process and primordial class loader. All kinds of class loaders can be understood better by comparing a primordial class loader to a kernel class loader.</P>
<H4>Kinds</H4>
<P>There are three kinds of class loaders, not just two.</P>
<UL>
<LI>kernel class loader
<LI>primordial class loader
<LI>custom class loader
</UL>
<P>Ryan Heise (<a href="mailto:ryan@whitewolf.com.au">ryan@whitewolf.com.au</a>) has identified another kind of class loader. A <EM>kernel class loader</EM> is strongly coupled to a kernel.</P>
<TABLE BORDER="1" CELLPADDING="8" BGCOLOR="lightblue">
<TR>
<TD>
kernel
<UL>
<LI>kernel class loader
</UL>
</TD>
</TR>
</TABLE>
<P>In the classic design, there are two kinds of class loaders: a primordial class loader and a custom class loader. A primordial class loader is strongly coupled to a virtual machine. A custom class loader enables an application to load classes from alternative sources.</P>
<H4>Lifetime</H4>
<P>We can contrast the kernel and primordial class loaders by the life time of a class. Each class has a lifetime. Its lifetime is determined by its class loader. Typically, a class is loaded, used and then garbage collected.</P>
<P>A class loaded by a kernel class loader is a <EM>kernel class</EM>. The lifetime of a kernel class is equal to the lifetime of the kernel. A kernel class dies when the kernel is shut down. It may not be garbage collected at all.</P>
<P>A class loaded by a primordial class loader is a <EM>primordial class</EM>. The lifetime of a primordial class is equal to the lifetime of a bytecode process. A primordial class dies when a process is shut down. It is garbage collected to reuse its resources in other processes.</P>
<P>A class loaded by another class loader is a <EM>custom class</EM>. The lifetime of a custom class is less than the lifetime of a bytecode process. A custom class dies when its class loader is no longer used.</P>
<H4>Kernel modules</H4>
<P>A kernel class loader is part of the kernel. It is loaded with the kernel. It is implemented in machine code. It exists before any kernel module. It exists before any virtual machine. It is system-wide. A kernel class cannot be garbage collected. A kernel class cannot be re-loaded without restarting (rebooting) the kernel.</P>
<P>Any kernel module can use the kernel class loader. When it is implemented as a kernel module, a virtual machine can share classes already loaded by the kernel class loader. A kernel class loader enables many virtual machines to share critical classes.</P>
<H4>Bootstrap</H4>
<P>When it is absolutely necessary, a kernel module can be plugged into the kernel. While they are written in machine code, kernel modules do not have to be loaded exclusively by machine code. They can be stored in many different executable image formats. They can be downloaded by a program written in bytecode.</P>
<H4>Maximum design</H4>
<P>While it always has exactly one kernel class loader, a kernel can have more than one virtual machine. A virtual machine can be a kernel module. A virtual machine can load, install and run any kernel module. When implemented as a kernel module, one virtual machine can be loaded by another.</P>
<P>Each virtual machine has a primordial class loader. A MPCL-compatible virtual machine has more than one primordial class loader. Each bytecode process uses a separate primordial class loader.</P>
<DIV ALIGN="CENTER">
<TABLE BORDER="1" CELLPADDING="8" BGCOLOR="lightblue">
<TR>
<TD VALIGN="TOP">
kernel module 1
</TD>
<TD>
kernel module 2
<TABLE BORDER="1" CELLPADDING="4" BGCOLOR="khaki">
<TR>
<TD>
virtual machine 1
<TABLE BORDER="1" BGCOLOR="#FFFFFF">
<TR>
<TD>
bytecode process 1
<UL>
<LI>primordial class loader
</UL>
</TD>
</TR>
</TABLE>
</TD>
</TR>
</TABLE>
</TD>
</TR>
<TR>
<TD VALIGN="TOP">
kernel module 3
<TABLE BORDER="1" CELLPADDING="4" BGCOLOR="khaki">
<TR>
<TD>
virtual machine 2
<TABLE BORDER="1" BGCOLOR="#FFFFFF">
<TR>
<TD>
bytecode process 2
<UL>
<LI>primordial class loader
</UL>
</TD>
</TR>
</TABLE>
</TD>
</TR>
</TABLE>
</TD>
<TD VALIGN="TOP">
kernel module 4
<TABLE BORDER="1" CELLPADDING="4" BGCOLOR="khaki">
<TR>
<TD>
virtual machine 3<BR>
(MPCL-compatible)
<TABLE BORDER="1" BGCOLOR="#FFFFFF">
<TR>
<TD>
bytecode process 3-1
<UL>
<LI>primordial class loader
</UL>
</TD>
</TR>
<TR>
<TD>
bytecode process 3-2
<UL>
<LI>primordial class loader
</UL>
</TD>
</TR>
<TR>
<TD>
bytecode process 3-3
<UL>
<LI>primordial class loader
</UL>
</TD>
</TR>
</TABLE>
</TD>
</TR>
</TABLE>
</TD>
</TR>
<TR>
<TD COLSPAN="2">
kernel
<UL>
<LI>kernel class loader
</UL>
</TD>
</TR>
</TABLE>
</DIV>
<H4>Static design</H4>
<P>A kernel is not required to support dynamic kernel modules. A kernel and virtual machine can be linked together at link-time. Here is a kernel with static kernel modules.</P>
<DIV ALIGN="CENTER">
<TABLE BORDER="1" CELLPADDING="8" BGCOLOR="lightblue">
<TR>
<TD>
kernel module<BR>
(statically linked)
<TABLE BORDER="1" CELLPADDING="4" BGCOLOR="khaki">
<TR>
<TD>
virtual machine
<TABLE BORDER="1" BGCOLOR="#FFFFFF">
<TR>
<TD>
bytecode process
<UL>
<LI>primordial class loader
</UL>
</TD>
</TR>
</TABLE>
</TD>
</TR>
</TABLE>
</TD>
</TR>
<TR>
<TD>
kernel
<UL>
<LI>kernel class loader
</UL>
</TD>
</TR>
</TABLE>
</DIV>
<H4>Static <nolink>MPCL design</H4>
<P>A kernel and MPCL-compatible virtual machine can be statically linked together at link-time. Here is a kernel and its <nolink>MPCL-compatible virtual machine.</P>
<DIV ALIGN="CENTER">
<TABLE BORDER="1" CELLPADDING="8" BGCOLOR="lightblue">
<TR>
<TD>
kernel module<BR>
(statically linked)
<TABLE BORDER="1" CELLPADDING="4" BGCOLOR="khaki">
<TR>
<TD>
virtual machine<BR>
(MPCL-compatible)
<TABLE BORDER="1" BGCOLOR="#FFFFFF">
<TR>
<TD>
bytecode process 1
<UL>
<LI>primordial class loader
</UL>
</TD>
</TR>
<TR>
<TD>
bytecode process 2
<UL>
<LI>primordial class loader
</UL>
</TD>
</TR>
<TR>
<TD>
bytecode process 3
<UL>
<LI>primordial class loader
</UL>
</TD>
</TR>
</TABLE>
</TD>
</TR>
</TABLE>
</TD>
</TR>
<TR>
<TD>
kernel
<UL>
<LI>kernel class loader
</UL>
</TD>
</TR>
</TABLE>
</DIV>
<H4>Summary</H4>
<P>A kernel class loader is used by one or more virtual machines. Like a classic primordial class loader, it is implemented in machine code. It can load classes; but, it cannot verify, resolve or invoke them.</P>
<P>A kernel class loader cannot return instances of <CODE>java.lang.Class</CODE> because it is disconnected from any virtual machine. Just like a bytecode cache, it returns something at machine code level. It might return raw class data, an instance of <CODE>Bytecode</CODE> or a well-known class definition.</P><BR><BR></P><!--

<TABLE width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="737b9c">
<TR><TD ALIGN="CENTER">
<a href="/user.php?op=login&redirect=%2Fview%2F%2FPrimordialVsKernel&PHPSESSID=c50a7c0ab753c0570637b5fa72e9e356">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FPrimordialVsKernel&PHPSESSID=c50a7c0ab753c0570637b5fa72e9e356">new&nbsp;user</a><TR><TD>
</TABLE>

!-->
<!-- end BODY page !-->

<HR>

<DIV ALIGN="CENTER">
<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR>
	<TD ALIGN="CENTER" COLSPAN="2">
		Content of these pages are owned and copyrighted by the poster.
	</TD>
</TR>
<TR>
	<TD ALIGN="RIGHT" WIDTH="50%">
		Hosted by:
	</TD>
	<TD ALIGN="LEFT">
		<A HREF="http://sourceforge.net/"><IMG 
			SRC="http://sourceforge.net/sflogo.php?group_id=2376&type=1"
			BORDER=0 HSPACE=0 VSPACE=0></A>
	</TD>
</TR>
</TABLE>
</DIV>
</BODY>
</HTML>

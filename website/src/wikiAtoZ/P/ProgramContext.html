<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 FINAL//EN">
<HTML>
  <HEAD>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
    <TITLE>ProgramContext.Imported @ jos.sf.net</TITLE>
  </HEAD>

<BODY BGCOLOR="#FFFFFF">

<!-- The FORM encloses the entire header, because it renders better that way. !-->
<FORM ACTION="/jump.php"><input type="hidden" name="PHPSESSID" value="bbf5fadfcde3c8e488c36ff09d98b63e" />

<!-- The JOS logo. !-->
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR VALIGN="TOP" ALIGN="LEFT">
	<TD><A HREF="http://cjos.sourceforge.net/archive/"><IMG 
		VSPACE="0" HSPACE="0" ALIGN="MIDDLE" BORDER="0"
		SRC="http://cjos.sourceforge.net/archive/media/jos_logo_mini.gif"></A></TD>
	<!-- The tab table. !-->
	<TD WIDTH="100%" ALIGN="RIGHT" BGCOLOR="#FFFFFF" VALIGN="BOTTOM"> 
		<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%" ALIGN="RIGHT">
			<TR VALIGN="MIDDLE" ALIGN="LEFT">

<TD BGCOLOR="White" WIDTH="60%">&nbsp;</TD>
<TD BGCOLOR="#FFFFCC"><A HREF="http://cjos.sourceforge.net/archive/">Home</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/info/">Info</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/dev/">DevZone</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFCC66" ALIGN="CENTER"><A
HREF="http://jos.sourceforge.net/">Wiki</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
			</TR>
			<TR>
				<TD BGCOLOR="#FFCC66" ALIGN="RIGHT" COLSPAN="9">
					<A HREF="/view/Users/?PHPSESSID=bbf5fadfcde3c8e488c36ff09d98b63e">UsersWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Main/?PHPSESSID=bbf5fadfcde3c8e488c36ff09d98b63e">MainWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Info/?PHPSESSID=bbf5fadfcde3c8e488c36ff09d98b63e">InfoWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/DevZone/?PHPSESSID=bbf5fadfcde3c8e488c36ff09d98b63e">DevZoneWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Support/?PHPSESSID=bbf5fadfcde3c8e488c36ff09d98b63e">SupportWeb</A>
				</TD>
			</TR>
		</TABLE>
	</TD>		
</TR>
<!-- The WikiHeader. !-->
<TR><TD COLSPAN="2">
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="CENTER">
		<B>[&nbsp;<a href="/info//ProgramContext?PHPSESSID=bbf5fadfcde3c8e488c36ff09d98b63e">ProgramContext</a>&nbsp;]</B>
	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="CENTER">
		<B>[ not logged in ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="CENTER">
		<B>[ Web: <a href="/view/Imported/?PHPSESSID=bbf5fadfcde3c8e488c36ff09d98b63e">Imported</a> ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFCC66" VALIGN="CENTER">
		goto:&nbsp;<INPUT TYPE="TEXT" SIZE="10" NAME="topic"><!--<INPUT TYPE="IMAGE" SRC="/media/go.gif?PHPSESSID=bbf5fadfcde3c8e488c36ff09d98b63e" BORDER="0" VALUE="topic" ALT="goto">!-->&nbsp;<a href="/search.php?PHPSESSID=bbf5fadfcde3c8e488c36ff09d98b63e"><FONT SIZE="-1">options</FONT></a>
	</TD>
</TR>
</TABLE>

<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
	<TR>
	<TD ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="TOP">
		[&nbsp;get <a href="/info/Imported/ProgramContext?PHPSESSID=bbf5fadfcde3c8e488c36ff09d98b63e">info</a> on or <a href="/edit/Imported/ProgramContext?PHPSESSID=bbf5fadfcde3c8e488c36ff09d98b63e">edit</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="TOP">
		[&nbsp;<a href="/user.php?op=login&redirect=%2Fview%2F%2FProgramContext&PHPSESSID=bbf5fadfcde3c8e488c36ff09d98b63e">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FProgramContext&PHPSESSID=bbf5fadfcde3c8e488c36ff09d98b63e">new&nbsp;user</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="TOP">
		[&nbsp;list of <a href="/topics/Imported/?PHPSESSID=bbf5fadfcde3c8e488c36ff09d98b63e">topics</a>, <a href="/hubsnodes/Imported/?PHPSESSID=bbf5fadfcde3c8e488c36ff09d98b63e">hubs&nbsp;&amp;&nbsp;nodes</a>, or <a href="/changes/Imported/?PHPSESSID=bbf5fadfcde3c8e488c36ff09d98b63e">recent&nbsp;changes</a>&nbsp;]	</TD>
	</TR>
</TABLE>

<!-- From CommonHeader !-->
</TR></TD>
</TABLE>
</FORM>

<!-- start BODY page !-->
<P>
<FONT SIZE=-1><a href="/view.php?topic=SmartAPIPages&PHPSESSID=bbf5fadfcde3c8e488c36ff09d98b63e">SmartAPIPages</a><wikitopic SmartAPIPages /wikitopic>; <a href="/view.php?topic=EmbeddedURIs&PHPSESSID=bbf5fadfcde3c8e488c36ff09d98b63e">EmbeddedURIs</a><wikitopic EmbeddedURIs /wikitopic></FONT>
<HR SIZE="1" NOSHADOW>
<EM>Article contributed by <a href="/view.php?topic=GilbertHerschberger&PHPSESSID=bbf5fadfcde3c8e488c36ff09d98b63e">GilbertHerschberger</a><wikitopic GilbertHerschberger /wikitopic> (27 July 1999).</EM>
<H4>Introduction</H4>
<P>This article is about three things. These things are very much related, but, not obviously so. The first thing we need to demonstrate is the mechanism from command line to main. The second thing is a comparison of the command line and <nolink>URI. For the third, why a Java program needs a program context.</P>
<H4>About main()</H4>
<P>What is the mechanism we use to go from command line to main? The <CODE>main()</CODE> method is the "first" method called by the Java virtual machine. The following Demo class prints out its parameters.</P>
<TABLE WIDTH="100%" BGCOLOR="#EFEFEF">
<TR>
<TD>
<PRE>
public class Demo {
  public static void main( String[] args ) {
	 System.out.println( "Parameters to main()" );
	 int iMax = args.length;
	 for ( int i = 0; i &lt; iMax; i++ ) {
		System.out.println( "args[ " + i + " ]=" + args[ i ] );
	 }
  }
</PRE>
</TD>
</TR>
</TABLE>
<P>These parameters came from the command line. How? The command line was <EM>parsed</EM> or separated into smaller parts. The separator used on a command line is a space. The following method gets an array of strings from a single string, much like parsing a command line.
<PRE>
  public static final String SEPARATOR = " ";
  public String[] getParameters( String v ) {
	 if ( v == null ) {
		return null;
	 }
	 int iMax = 1;
	 int pos = -1;
	 for (;; iMax++ ) {
		pos = v.indexOf( SEPARATOR, pos + SEPARATOR.length() );
		if ( pos &lt; 0 ) {
		  break;
		}
	 }
	 String[] buf = new String[ iMax ];
	 for ( int i = 0; i &lt; iMax; i++ ) {
		pos = v.indexOf( SEPARATOR );
		if ( pos &lt; 0 ) {
		  buf[ i ] = v;
		  break;
		}
		buf[ i ] = v.substring( 0, pos );
		v = v.substring( pos + SEPARATOR.length() );
	 }
	 return buf;
  }
</PRE>
<P>To put the command line parameters back together in a single string, you can use the following method:
<PRE>
  public static final String SEPARATOR = " ";
  public String getCommandLine( String[] v ) {
	 if ( v == null ) {
		return null;
	 }
	 StringBuffer buffer = new StringBuffer();
	 buffer.append( v[ i ] );
	 int iMax = v.length;
	 for ( int i = 1; i &lt; iMax; i++ ) {
		buffer.append( SEPARATOR + v[ i ] );
	 }
	 return buffer.toString();
  }  
</PRE>
<P>When you type in a command when using your client agent, it tries to be helpful by pre-parsing the command line into a parameter list. It calls <CODE>getParameters()</CODE> and then calls main().</P>
<PRE>
  public void launchDemo() {
	 String cl = "name-1=value-1 name-2=value-2 name-3=value-3";
	 Demo.main( getParameters( cl ) );
  }
</PRE>
<H4>Command line vs. <nolink>URI</H4>
<P>The distinction between command line and <nolink>URI has blurred. The command line and a <nolink>URI use exactly the same primative mechanism to do their work. Both the command line and <nolink>URI are based upon a string.</P>
<UL>
<LI>Resources
<P>Both a command line and <nolink>URI are dealing with digital resources. While the command line assumes the digital resource is a program (verb), a <nolink>URI assumes the digital resource is a document (object). While a program is expected to do something, a document is supposed to have things done to it.</P>
<P>In practice, a <nolink>URI is a document for a client agent is command line for an <a href="/view.php?topic=HTTP&web=Imported&PHPSESSID=bbf5fadfcde3c8e488c36ff09d98b63e">HTTP</a> <wikitopic HTTP /wikitopic>service. When you type in the name of a document at a command line, your client agent can run a program and display the document.</P>
<P>The mechanism of the command line and <nolink>URI are one and the same.</P>
<LI>Parameters
<P>Both a command line and <nolink>URI support parameters. As we've seen a command line uses a space character to separate parameters. The <nolink>URI uses a separator, too. Instead of a space, the <nolink>URI uses the amperstand (&amp;amp) character. The space character has been considered <EM>unreliable</EM> for inter-network connections and a new separator was needed.</P>
<P>The conversion of a command line and <nolink>URI are almost identical. Only the separator has changed. The <CODE>getParameters()</CODE> method above works with a <nolink>URI when <CODE>SEPARATOR = "&amp;"</CODE>.</P>
<P>An <nolink>HTML page uses <CODE>PARAM</CODE> tag(s) to pass parameters to an applet. 
</UL>
<H4>Three terms, one mechanism</H4>
<P>Parameters on a command line are often called <EM>command line arguments</EM>. These arguments are expected to be passed to <CODE>main()</CODE>.
<PRE>
org.jos.demo.Demo n1=v1 n2=v2 n3=v3
</PRE>
<P>Parameters in a <nolink>URI are often called a <EM>query string</EM>. These arguments are passed to a service agent, like a Java servlet. The servlet framework provides methods to get the query string (<CODE>getQueryString()</CODE>), get one parameter at a time by name (<CODE>getParameter()</CODE>, and get all parameters (<CODE>getParameters()</CODE>.</P>
<PRE>
/servlet/org.jos.demo.Demo?n1=v1&amp;n2=v2&amp;n3=v3
</PRE>
<P>Parameters in an applet are often calls <EM>parameters</EM>. These parameters are pass to an applet. The applet framework provides methods for a program to get one parameter at a time by name (<CODE>getParameter</CODE>).
<P>As you can see, these three forms carry the same data.
<PRE>
n1=v1 n2=v2 n3=v3
</PRE>is equivalent to<PRE>
&lt;PARAM NAME="n1" VALUE="v1"&gt;
&lt;PARAM NAME="n2" VALUE="v2"&gt;
&lt;PARAM NAME="n3" VALUE="v3"&gt;
</PRE>is equivalent to<PRE>
n1=v1&amp;n2=v2&amp;n3=v3
</PRE>
<H4>Program context</H4>
<P>When a program runs from the java tool, the java tool tries to call <CODE>public static void main( String[] )</CODE>. Any class that meets this requirement <EM>is-a</EM> Java application. When a program runs from the javaw, jre, jrew tools, the requirements remain the same.</P>
<P>When a program runs from a Java-enabled browser, the browser tries to call its init(), start(), stop(), and destroy() methods through the <CODE>java.applet.Applet</CODE> interface. Any class that implements the applet interface <EM>is-a</EM> Java applet.</P>
<P>When a program runs from a servlet-enabled <nolink>HTTP server, the server tries to call its methods through the <CODE>javax.servlet.Servlet</CODE> interface. Any class that implements the servlet interface <EM>is-a</EM> Java servlet.</P>
<H4>Program</H4>
<P>A program is a program. A program is still a program no matter what environment it is running in. Although the java tool, Java-enabled browser and servlet-enabled <nolink>HTTP server seem to be very different environments, they have the Java virtual machine in common. With the same virtual machine, these environments aren't really all that different.</P>
<H4>About JOS</H4>
<P>The <nolink>JOS environment is going to be different than these three. And yet, all four have the Java virtual machine in common. These aren't that different after all.</P>
<H3>Plan A: Build a <nolink>ProgramContext</H3>
<P>In order to unify these environments and promote the <nolink>JOS environment, we should build a <CODE>Program</CODE> interface and a <CODE>ProgramContext</CODE> interface. Any class that implements the <CODE>Program</CODE> interface <EM>is-a</EM> program.</P>
<P>When a <nolink>JOS program runs inside the java tool, the command line is parsed into its parameters. When a <nolink>JOS program is run from inside a Java-enabled browser, applet parameters are mapped into its parameters. When a <nolink>JOS program is run inside a servlet, a <nolink>URI is parsed into its parameters.</P>
<P>When you write a <nolink>JOS program, you can test it using the java tool. Without re-writing your program, you can run it as an applet or servlet.</P>
<H4>Servlets inside a browser</H4>
<P>A servlet can run inside a Java-enabled browser. The servlet <nolink>API provides a framework for using a servlet to create <a href="/view.php?topic=HTML&web=Imported&PHPSESSID=bbf5fadfcde3c8e488c36ff09d98b63e">HTML</a> <wikitopic HTML /wikitopic>pages. A browser can serve as a servlet runner. A browser that provides the servlet environment can pass <nolink>URI-based requests to any local servlet.</P>
<P>When you start this browser, it creates a servlet environment. For those requests to the servlet: protocol, it passes the rest of the <nolink>URI to the servlet host framework. Here is an example of the <nolink>URI for a local servlet:</P>
<TABLE WIDTH="100%" BGCOLOR="#EFEFEF">
<TR>
<TD>
<PRE>
servlet:org.jos.demo.DemoServlet
</PRE>
</TD>
</TR>
</TABLE>
<P>The configuration determines how long the servlet runner runs and how it is shared.
<UL>
<LI><STRONG>stand-alone</STRONG> When you close your browser, the browser closes this local servlet environment, too. The servlet environment does not have to use the TCP/IP stack to communicate between servlets and the <nolink>HTML viewer. The servlet runner inside the browser cannot be used by any other program, not even programs on the same machine.</P>
<LI><STRONG>local</STRONG> When you close your browser, the browser disconnects from your local servlet runner. The browser communicates with its servlet runner over TCP/IP. In this configuration, the servlet runner responds to request from other browsers on this machine. The servlet runner won't respond to any request outside localhost.</P>
<LI><STRONG>network</STRONG> Like local, the servlet runner keeps running after you close your browser. In this configuration, the servlet runner responds to request from other browsers, even across the network.</P>
</UL>
<H4>Old way</H4>
<P>The old way of testing (and running) servlets is to use a separate servlet runner. Your browser and a servletrunner tool work together. You must start them separately. You must use the TCP/IP stack for IPC. Your servletrunner--even while your testing--is available to all the other computers on the network.</P>
<P>While the applet runs inside a sandbox, a servlet does not. The security manager doesn't get in your way. When you need your program to access different TCP/IP hosts (besides first one), the client-side servlet is the way to go. In stand-alone mode, this environment is perfect for developing new servlets.<P>
<H4>Reason</H4>
<P>A program needs a program context in order for <nolink>JOS programmers to write a program once. <nolink>JOS programs written to this environment will run on <nolink>JOS when the time comes. We can simulate the <nolink>JOS environment sooner rather than later. This has applications in non-<nolink>JOS programs, too.</P>
<P>The program context must be implemented as a separate object. Why? Different environments have different needs. While each environment will implement a program context unique to that environment, the <nolink>JOS program remains the same.</P>
<H4>Not a process</H4>
<P>A program is not a process. When a parent program calls a child program, the parent program is suspended. The child program runs inside the parent program's thread. A parent program typically passes a new program context to the child, although its possible to pass its own.</P>
<P>When a parent program forks, the child program runs in a separate thread. The parent and child run concurrently.</P>
<H4><CODE>ProgramContext</CODE></H4>
<P>A <CODE>ProgramContext</CODE> is an interface.
<PRE>
public interface ProgramContext {
  public String getParameter( int index );
  public String getValue( String key );
  public Enumeration getParameters();
  &lt;STRIKE&gt;public PrintStream getStandardOut();&lt;/STRIKE&gt;
  public void setReturnCode( int v );
}
</PRE>
<H4><CODE>Program</CODE></H4>
<P>A <CODE>Program</CODE> is an interface.
<PRE>
public interface Program {
  public void setProgramContext( ProgramContext v );
  public void run();
}
</PRE>
<H4><CODE>Configurable</CODE></H4>
<P>This interface is implemented by any object that is configurable by registry.
<PRE>
public interface Configurable {
  public void setConfiguration( Registry v );
}
</PRE><BR><BR></P><!--

<TABLE width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="737b9c">
<TR><TD ALIGN="CENTER">
<a href="/user.php?op=login&redirect=%2Fview%2F%2FProgramContext&PHPSESSID=bbf5fadfcde3c8e488c36ff09d98b63e">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FProgramContext&PHPSESSID=bbf5fadfcde3c8e488c36ff09d98b63e">new&nbsp;user</a><TR><TD>
</TABLE>

!-->
<!-- end BODY page !-->

<HR>

<DIV ALIGN="CENTER">
<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR>
	<TD ALIGN="CENTER" COLSPAN="2">
		Content of these pages are owned and copyrighted by the poster.
	</TD>
</TR>
<TR>
	<TD ALIGN="RIGHT" WIDTH="50%">
		Hosted by:
	</TD>
	<TD ALIGN="LEFT">
		<A HREF="http://sourceforge.net/"><IMG 
			SRC="http://sourceforge.net/sflogo.php?group_id=2376&type=1"
			BORDER=0 HSPACE=0 VSPACE=0></A>
	</TD>
</TR>
</TABLE>
</DIV>
</BODY>
</HTML>

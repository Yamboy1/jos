<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 FINAL//EN">
<HTML>
  <HEAD>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
    <TITLE>JNIStartService.Imported @ jos.sf.net</TITLE>
  </HEAD>

<BODY BGCOLOR="#FFFFFF">

<!-- The FORM encloses the entire header, because it renders better that way. !-->
<FORM ACTION="/jump.php"><input type="hidden" name="PHPSESSID" value="765cb0c4a687514ef3ca462001effbc8" />

<!-- The JOS logo. !-->
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR VALIGN="TOP" ALIGN="LEFT">
	<TD><A HREF="http://cjos.sourceforge.net/archive/"><IMG 
		VSPACE="0" HSPACE="0" ALIGN="MIDDLE" BORDER="0"
		SRC="http://cjos.sourceforge.net/archive/media/jos_logo_mini.gif"></A></TD>
	<!-- The tab table. !-->
	<TD WIDTH="100%" ALIGN="RIGHT" BGCOLOR="#FFFFFF" VALIGN="BOTTOM"> 
		<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%" ALIGN="RIGHT">
			<TR VALIGN="MIDDLE" ALIGN="LEFT">

<TD BGCOLOR="White" WIDTH="60%">&nbsp;</TD>
<TD BGCOLOR="#FFFFCC"><A HREF="http://cjos.sourceforge.net/archive/">Home</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/info/">Info</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/dev/">DevZone</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFCC66" ALIGN="CENTER"><A
HREF="http://jos.sourceforge.net/">Wiki</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
			</TR>
			<TR>
				<TD BGCOLOR="#FFCC66" ALIGN="RIGHT" COLSPAN="9">
					<A HREF="/view/Users/?PHPSESSID=765cb0c4a687514ef3ca462001effbc8">UsersWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Main/?PHPSESSID=765cb0c4a687514ef3ca462001effbc8">MainWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Info/?PHPSESSID=765cb0c4a687514ef3ca462001effbc8">InfoWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/DevZone/?PHPSESSID=765cb0c4a687514ef3ca462001effbc8">DevZoneWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Support/?PHPSESSID=765cb0c4a687514ef3ca462001effbc8">SupportWeb</A>
				</TD>
			</TR>
		</TABLE>
	</TD>		
</TR>
<!-- The WikiHeader. !-->
<TR><TD COLSPAN="2">
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="CENTER">
		<B>[&nbsp;<a href="/info//JNIStartService?PHPSESSID=765cb0c4a687514ef3ca462001effbc8">JNIStartService</a>&nbsp;]</B>
	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="CENTER">
		<B>[ not logged in ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="CENTER">
		<B>[ Web: <a href="/view/Imported/?PHPSESSID=765cb0c4a687514ef3ca462001effbc8">Imported</a> ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFCC66" VALIGN="CENTER">
		goto:&nbsp;<INPUT TYPE="TEXT" SIZE="10" NAME="topic"><!--<INPUT TYPE="IMAGE" SRC="/media/go.gif?PHPSESSID=765cb0c4a687514ef3ca462001effbc8" BORDER="0" VALUE="topic" ALT="goto">!-->&nbsp;<a href="/search.php?PHPSESSID=765cb0c4a687514ef3ca462001effbc8"><FONT SIZE="-1">options</FONT></a>
	</TD>
</TR>
</TABLE>

<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
	<TR>
	<TD ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="TOP">
		[&nbsp;get <a href="/info/Imported/JNIStartService?PHPSESSID=765cb0c4a687514ef3ca462001effbc8">info</a> on or <a href="/edit/Imported/JNIStartService?PHPSESSID=765cb0c4a687514ef3ca462001effbc8">edit</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="TOP">
		[&nbsp;<a href="/user.php?op=login&redirect=%2Fview%2F%2FJNIStartService&PHPSESSID=765cb0c4a687514ef3ca462001effbc8">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FJNIStartService&PHPSESSID=765cb0c4a687514ef3ca462001effbc8">new&nbsp;user</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="TOP">
		[&nbsp;list of <a href="/topics/Imported/?PHPSESSID=765cb0c4a687514ef3ca462001effbc8">topics</a>, <a href="/hubsnodes/Imported/?PHPSESSID=765cb0c4a687514ef3ca462001effbc8">hubs&nbsp;&amp;&nbsp;nodes</a>, or <a href="/changes/Imported/?PHPSESSID=765cb0c4a687514ef3ca462001effbc8">recent&nbsp;changes</a>&nbsp;]	</TD>
	</TR>
</TABLE>

<!-- From CommonHeader !-->
</TR></TD>
</TABLE>
</FORM>

<!-- start BODY page !-->
<P>
<FONT SIZE=-1><a href="/view.php?topic=JavaNativeInterface&PHPSESSID=765cb0c4a687514ef3ca462001effbc8">JavaNativeInterface</a><wikitopic JavaNativeInterface /wikitopic></FONT>
<HR SIZE="1" NOSHADOW>
<EM>Article contributed by <a href="/view.php?topic=GilbertHerschberger&PHPSESSID=765cb0c4a687514ef3ca462001effbc8">GilbertHerschberger</a><wikitopic GilbertHerschberger /wikitopic> (30 August 1999).</EM>
<H4>Introduction</H4>
<P>The bulk of a virtual machine seems to be a little too much for many Java programs. The virtual machine is <EM>expensive</EM> to load. It takes a lot of <a href="/view.php?topic=CPU&web=Imported&PHPSESSID=765cb0c4a687514ef3ca462001effbc8">CPU</a> <wikitopic CPU /wikitopic>cycles to start.</P>
<P><EM>Why load a new virtual machine when you don't have to?</EM></P>
<P>For many Java programs, it makes more sense to share a virtual machine. Your Java programs can share a virtual machine by using a virtual machine service, a multiple process virtual machine, and/or a multiple instance virtual machine.</P>
<H4>Virtual machine service</H4>
<P>A virtual machine service is much like the <CODE>java</CODE> tool in function. It is different in architecture.</P>
<P>The <CODE>java</CODE> tool is designed to start your application, nothing more. It is a generic tool. It uses the <a href="/view.php?topic=JavaNativeInterface&PHPSESSID=765cb0c4a687514ef3ca462001effbc8">JavaNativeInterface</a><wikitopic JavaNativeInterface /wikitopic> to create a virtual machine, load and run your application.</P>
<P>A virtual machine service is designed to load a virtual machine and wait. The virtual machine service is started as a daemon with the <CODE>josvmd</CODE> tool. When you use the <CODE>josvmd</CODE> tool, it creates a virtual machine. It does not load any application. Instead, it listens on a well-known port. As a service, the expensive part of loading a virtual machine is performed once.</P>
<P>A virtual machine service waits for a request. This service uses a telnet compatible protocol in plain text. A request is in the form of a command line. The command line is a message and ends with a carriage return (CR).</P>
<H4>Typical sequence</H4>
<P>Any requestor can open a connection to the virtual machine service. A requestor typically sends a single command line and disconnects.</P>
<PRE>
  StreamConsole console = new TelnetConsole( 1963 );
  console.println( "request-1" );
  console.close();
</PRE>
<H4>Multiple request</H4>
<P> The virtual machine service supports multiple requests per connection. Each request ends with a CR.</P>
<PRE>
  StreamConsole console = new TelnetConsole( 1963 );
  console.println( "request-1" );
  console.println( "request-2" );
  console.println( "request-3" );
  console.close();
</PRE>
<H4>Result code</H4>
<P>The virtual machine service returns the result code from a program to the requestor. The result code is returned when a process is finished. Typically, a requestor must wait with an open connection for the lifetime of a program.</P>
<H4>Background task</H4>
<P>To start a program without waiting, the amperstand (&amp;) is used. The command line must end with an amperstand:
<PRE>
  public void example() {
	 StreamConsole console = new TelnetConsole();
	 console.println( "request-1 &amp;" );
	 console.println( "request-2 &amp;" );
	 console.close();
  }
</PRE>
<H4>Starting an application</H4>
<P>Once the virtual machine service is running, it waits for a request. The <CODE>josstart</CODE> tool is equivalent to the <CODE>java</CODE> tool, except the <CODE>josstart</CODE> tool uses the existing virtual machine and its service.</P>
<P>The <CODE>josstart</CODE> tool is not written in Java. That would defeat the entire point of running a virtual machine service.</P>
<P>The <CODE>josstart</CODE> tool opens a connection to the virtual machine service. It writes the command line to the connection. It reads the result code from the connection. It returns the result code as its own result code.</P>
<P>The <CODE>josstart</CODE> tool should be used for all of the small Java programs that can share a virtual machine.</P>
<H4>Remote host</H4>
<P>The <CODE>josstart</CODE> tool can start a Java program on another machine. With a well-known host and port, it can send a request to a virtual machine service on another host.</P>
<H4>Standard in and out</H4>
<P>Redirection can be used across a connection, too. When a virtual machine service supports redirection, the output from a program is redirected across a request connection. When a program reads standard input, the virtual machine service reads from a request connection.</P>
<H4>Scalable</H4>
<P>When you picture a serverfarm-in-a-box with 1,000 processors running, each processor runs a virtual machine service. A entry point into the serverfarm can redirect an incoming request to any of its processors. You can tame the power of 1,000 processors or 10,000 processors with Java and a virtual machine service.</P>
<P>Plus, your virtual machine service can support bytecode transfer. When a <CODE>josstart</CODE> command uploads the bytecode to the virtual machine service, the virtual machine service executes the bytecode. The bytecode is expected to implement the <CODE>program.Program</CODE> interface.</P>
<H4>Graphics? AWT? Swing?</H4>
<P>Why should any virtual machine service support bit-mapped video graphics? While it might not make sense on a serverfarm, <CODE>josstart</CODE> runs on a desktop, too. It makes a lot of sense on a desktopm where there should only be one <nolink>JADE subsystem at a time.</P>
<P>When you want to run your <a href="/view.php?topic=JADE&PHPSESSID=765cb0c4a687514ef3ca462001effbc8">JADE</a><wikitopic JADE /wikitopic>-based application, the virtual machine service is responsible for <nolink>JADE.</P>
<P>The semantics of the static keyword are preserved for a subsystem, like <nolink>JADE. For example, you can start one <nolink>JADE-based application and then another, and then another. The <nolink>JADE subsystem is a static part of the virtual machine. It has not been shutdown at the end of each program. It does not have to be initialized at the beginning of each program.</P>
<H4>Start service</H4>
<P>Taking this one more step, you do not have to explicitely start the <CODE>josvmd</CODE> service. If you run the <CODE>josstart</CODE> tool and there is no virtual machine service running, <CODE>josstart</CODE> automatically runs <CODE>josvmd</CODE>.</P>
<P>With <nolink>JNI, a non-sharable version of the virtual machine service is important, too. A <CODE>java</CODE> tool for <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=765cb0c4a687514ef3ca462001effbc8">JOS</a> <wikitopic JOS /wikitopic>is more like the <CODE>java</CODE> tool from the JDK/JRE. It uses the <nolink>JNI to create a virtual machine service for an unused port. In order for a program to call a program, the mechanism needs to define a virtual machine service port even when it might not be used by an application.</P>
<P>JOS-related tools can be ported to Linux(R) and Windows(TM). By writing JOS-related tools with the <a href="/view.php?topic=JavaNativeInterface&PHPSESSID=765cb0c4a687514ef3ca462001effbc8">JavaNativeInterface</a><wikitopic JavaNativeInterface /wikitopic>, it is possible for us to run JOS-related services, written in Java, before launching an end-user Java application. <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=765cb0c4a687514ef3ca462001effbc8">JOS</a> <wikitopic JOS /wikitopic>does not have to run on a <a href="/view.php?topic=JOS&web=Imported&PHPSESSID=765cb0c4a687514ef3ca462001effbc8">JOS</a> <wikitopic JOS /wikitopic>kernel.</P><BR><BR></P><!--

<TABLE width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="737b9c">
<TR><TD ALIGN="CENTER">
<a href="/user.php?op=login&redirect=%2Fview%2F%2FJNIStartService&PHPSESSID=765cb0c4a687514ef3ca462001effbc8">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FJNIStartService&PHPSESSID=765cb0c4a687514ef3ca462001effbc8">new&nbsp;user</a><TR><TD>
</TABLE>

!-->
<!-- end BODY page !-->

<HR>

<DIV ALIGN="CENTER">
<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR>
	<TD ALIGN="CENTER" COLSPAN="2">
		Content of these pages are owned and copyrighted by the poster.
	</TD>
</TR>
<TR>
	<TD ALIGN="RIGHT" WIDTH="50%">
		Hosted by:
	</TD>
	<TD ALIGN="LEFT">
		<A HREF="http://sourceforge.net/"><IMG 
			SRC="http://sourceforge.net/sflogo.php?group_id=2376&type=1"
			BORDER=0 HSPACE=0 VSPACE=0></A>
	</TD>
</TR>
</TABLE>
</DIV>
</BODY>
</HTML>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 FINAL//EN">
<HTML>
  <HEAD>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
    <TITLE>JJOSAndConsole.Main @ jos.sf.net</TITLE>
  </HEAD>

<BODY BGCOLOR="#FFFFFF">

<!-- The FORM encloses the entire header, because it renders better that way. !-->
<FORM ACTION="/jump.php"><input type="hidden" name="PHPSESSID" value="dddb3268cd88e558db0278cf64800614" />

<!-- The JOS logo. !-->
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR VALIGN="TOP" ALIGN="LEFT">
	<TD><A HREF="http://cjos.sourceforge.net/archive/"><IMG 
		VSPACE="0" HSPACE="0" ALIGN="MIDDLE" BORDER="0"
		SRC="http://cjos.sourceforge.net/archive/media/jos_logo_mini.gif"></A></TD>
	<!-- The tab table. !-->
	<TD WIDTH="100%" ALIGN="RIGHT" BGCOLOR="#FFFFFF" VALIGN="BOTTOM"> 
		<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%" ALIGN="RIGHT">
			<TR VALIGN="MIDDLE" ALIGN="LEFT">

<TD BGCOLOR="White" WIDTH="60%">&nbsp;</TD>
<TD BGCOLOR="#FFFFCC"><A HREF="http://cjos.sourceforge.net/archive/">Home</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/info/">Info</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFFFCC" ALIGN="CENTER"><A HREF="http://cjos.sourceforge.net/archive/dev/">DevZone</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
<TD WIDTH="10%" BGCOLOR="#FFCC66" ALIGN="CENTER"><A
HREF="http://jos.sourceforge.net/">Wiki</A></TD>
<TD BGCOLOR="White">&nbsp;</TD>
			</TR>
			<TR>
				<TD BGCOLOR="#FFCC66" ALIGN="RIGHT" COLSPAN="9">
					<A HREF="/view/Users/?PHPSESSID=dddb3268cd88e558db0278cf64800614">UsersWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Main/?PHPSESSID=dddb3268cd88e558db0278cf64800614">MainWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Info/?PHPSESSID=dddb3268cd88e558db0278cf64800614">InfoWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/DevZone/?PHPSESSID=dddb3268cd88e558db0278cf64800614">DevZoneWeb</A>
					&nbsp;|&nbsp;
					<A HREF="/view/Support/?PHPSESSID=dddb3268cd88e558db0278cf64800614">SupportWeb</A>
				</TD>
			</TR>
		</TABLE>
	</TD>		
</TR>
<!-- The WikiHeader. !-->
<TR><TD COLSPAN="2">
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
<TR>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="CENTER">
		<B>[&nbsp;<a href="/info//JJOSAndConsole?PHPSESSID=dddb3268cd88e558db0278cf64800614">JJOSAndConsole</a>&nbsp;]</B>
	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="CENTER">
		<B>[ not logged in ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="CENTER">
		<B>[ Web: <a href="/view/Main/?PHPSESSID=dddb3268cd88e558db0278cf64800614">Main</a> ]</B>	</TD>
	<TD WIDTH="25%" ALIGN="CENTER" BGCOLOR="#FFCC66" VALIGN="CENTER">
		goto:&nbsp;<INPUT TYPE="TEXT" SIZE="10" NAME="topic"><!--<INPUT TYPE="IMAGE" SRC="/media/go.gif?PHPSESSID=dddb3268cd88e558db0278cf64800614" BORDER="0" VALUE="topic" ALT="goto">!-->&nbsp;<a href="/search.php?PHPSESSID=dddb3268cd88e558db0278cf64800614"><FONT SIZE="-1">options</FONT></a>
	</TD>
</TR>
</TABLE>

<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="3" WIDTH="100%">
	<TR>
	<TD ALIGN="CENTER" BGCOLOR="#FFFFCC" VALIGN="TOP">
		[&nbsp;get <a href="/info/Main/JJOSAndConsole?PHPSESSID=dddb3268cd88e558db0278cf64800614">info</a> on or <a href="/edit/Main/JJOSAndConsole?PHPSESSID=dddb3268cd88e558db0278cf64800614">edit</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFEE88" VALIGN="TOP">
		[&nbsp;<a href="/user.php?op=login&redirect=%2Fview%2F%2FJJOSAndConsole&PHPSESSID=dddb3268cd88e558db0278cf64800614">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FJJOSAndConsole&PHPSESSID=dddb3268cd88e558db0278cf64800614">new&nbsp;user</a>&nbsp;]	</TD>
	<TD ALIGN="CENTER" BGCOLOR="#FFDD77" VALIGN="TOP">
		[&nbsp;list of <a href="/topics/Main/?PHPSESSID=dddb3268cd88e558db0278cf64800614">topics</a>, <a href="/hubsnodes/Main/?PHPSESSID=dddb3268cd88e558db0278cf64800614">hubs&nbsp;&amp;&nbsp;nodes</a>, or <a href="/changes/Main/?PHPSESSID=dddb3268cd88e558db0278cf64800614">recent&nbsp;changes</a>&nbsp;]	</TD>
	</TR>
</TABLE>

<!-- From CommonHeader !-->
</TR></TD>
</TABLE>
</FORM>

<!-- start BODY page !-->
<P>
<a href="/view.php?topic=JJOSPages&PHPSESSID=dddb3268cd88e558db0278cf64800614">JJOSPages</a><wikitopic JJOSPages /wikitopic>
<HR>
<EM>Article contributed by <a href="/view.php?topic=GilbertHerschberger&PHPSESSID=dddb3268cd88e558db0278cf64800614">GilbertHerschberger</a><wikitopic GilbertHerschberger /wikitopic> (19 May 2001).</EM>
<H4>Introduction</H4>
Console-related functions should be used freely and immediately, with the
assumption that the console exists and is enabled. They should be used freely
because messages are an aid to trouble-shooting any problem within the code.
They should be used immediately because it is possible the console really
does exist before the kernel, such as running on a foreign operating system
or embedded device. They should be used immediately because a console might
be capable of queuing messages while it is disabled.
</P><P>
During the start-up sequence of an operating system, a kernel console should
be enabled as soon as possible. We should be able to see messages sent to the
console during the start-up sequence.
</P><P>
On the other hand, calls to console-related functions should not fail if the
console is disabled. A console may be temporarily disabled to hide part of
start-up sequence. A console may be permanently disabled for a machine
without a video display adapter. If a message is sent to the console when
it is disabled, the message can be discarded or queued.
<H4>Video buffer</H4>
A console should determine its own video buffer. The address of a video
buffer should not be passed to the <CODE>mc_getConsole()</CODE> function.
Rather, the custom implementation of this function should determine the
address of the video buffer on its own.
<H4>Memory management</H4>
Some of the console-related functions assume a pre-existing memory manager.
It is important for a memory manager to be installed before these functions
are enabled. A real memory manager may be the first component installed
during the start-up sequence. A virtual memory manager may be installed later.
</P><P>
Even if a console-related function does not use it directly, a memory manager
is often involved during the preparation of a message to be sent to the
console. When writing in the C/C++ programming language, a programmer can
safely assume a pre-existing memory manager most of the time. It is only in
the time slice between boot and the installation of a memory manager that a
programmer must be careful to use the C stack for memory allocation instead of
the usual program heap.
</P><P>
When a kernel starts, it is the only process and only thread of control running
on a processor. The kernel does not need to be thread safe when installing
a memory manager or other pre-thread components. Much of the start-up code
will never be invoked again without first rebooting the computer.
</P><P>
Memory management of a kernel should be separate from memory management of
a virtual machine. A virtual machine should be able to call upon the
memory manager of a kernel to allocate one object heap for each bytecode
process. It should be able to use the kernel memory manager to compose a
compless message before sending it to the console. It should be able to query
the memory manager to find out how much space exists (total) and how much of
that is available (free).
<H4>Message queue</H4>
A simple message queue uses a line-by-line approach. It is a first-in, first-out
(FIFO) queue. When a newline character is detected, everything in the line
buffer is copied to a message queue. The line buffer is allocated once and
reused. One character at a time is added to the line buffer. The newline
character itself is never queued. To empty the queue, the console's
<CODE>println()</CODE> function is invoked for each message in the queue.
</P><P>
The following C++ class represents a node in a singly-linked list of console
messages.
<PRE>
class ConsoleMessage {
  public:
    ConsoleMessage( const char *v );
    virtual ~ConsoleMessage();
    virtual const char *getPayload();
    virtual ConsoleMessage *getNext();
    virtual void setNext( ConsoleMessage *v );
  protected:

  private:
    const char *payload;
};
</PRE><BR><BR></P><!--

<TABLE width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="737b9c">
<TR><TD ALIGN="CENTER">
<a href="/user.php?op=login&redirect=%2Fview%2F%2FJJOSAndConsole&PHPSESSID=dddb3268cd88e558db0278cf64800614">login</a> or <a href="/user.php?op=newacct&redirect=%2Fview%2F%2FJJOSAndConsole&PHPSESSID=dddb3268cd88e558db0278cf64800614">new&nbsp;user</a><TR><TD>
</TABLE>

!-->
<!-- end BODY page !-->

<HR>

<DIV ALIGN="CENTER">
<TABLE BORDER="0" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR>
	<TD ALIGN="CENTER" COLSPAN="2">
		Content of these pages are owned and copyrighted by the poster.
	</TD>
</TR>
<TR>
	<TD ALIGN="RIGHT" WIDTH="50%">
		Hosted by:
	</TD>
	<TD ALIGN="LEFT">
		<A HREF="http://sourceforge.net/"><IMG 
			SRC="http://sourceforge.net/sflogo.php?group_id=2376&type=1"
			BORDER=0 HSPACE=0 VSPACE=0></A>
	</TD>
</TR>
</TABLE>
</DIV>
</BODY>
</HTML>
